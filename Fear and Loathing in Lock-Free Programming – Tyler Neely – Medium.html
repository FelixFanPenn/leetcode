<!DOCTYPE html>
<!-- saved from url=(0086)https://medium.com/@tylerneely/fear-and-loathing-in-lock-free-programming-7158b1cdd50c -->
<html xmlns:cc="http://creativecommons.org/ns#"><head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# medium-com: http://ogp.me/ns/fb/medium-com#"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=contain"><title>Fear and Loathing in Lock-Free Programming – Tyler Neely – Medium</title><link rel="canonical" href="https://medium.com/@tylerneely/fear-and-loathing-in-lock-free-programming-7158b1cdd50c"><meta name="title" content="Fear and Loathing in Lock-Free Programming – Tyler Neely – Medium"><meta name="referrer" content="always"><meta name="description" content="What follows is a whirlwind tour of an area of programming usually only whispered of and seldom explored, perhaps for good reason. Lock-free techniques allow multiple threads to work together in a…"><meta name="theme-color" content="#000000"><meta property="og:title" content="Fear and Loathing in Lock-Free Programming – Tyler Neely – Medium"><meta property="twitter:title" content="Fear and Loathing in Lock-Free Programming"><meta property="og:url" content="https://medium.com/@tylerneely/fear-and-loathing-in-lock-free-programming-7158b1cdd50c"><meta property="og:image" content="https://cdn-images-1.medium.com/max/1200/1*ImXIA0dmgvgTRjiSisY-HQ.jpeg"><meta property="fb:app_id" content="542599432471018"><meta property="og:description" content="What follows is a whirlwind tour of an area of programming usually only whispered of and seldom explored, perhaps for good reason…"><meta name="twitter:description" content="What follows is a whirlwind tour of an area of programming usually only whispered of and seldom explored, perhaps for good reason…"><meta name="twitter:image:src" content="https://cdn-images-1.medium.com/max/1200/1*ImXIA0dmgvgTRjiSisY-HQ.jpeg"><link rel="author" href="https://medium.com/@tylerneely"><meta name="author" content="Tyler Neely"><meta property="og:type" content="article"><meta name="twitter:card" content="summary_large_image"><meta property="article:publisher" content="https://www.facebook.com/medium"><meta property="article:author" content="Tyler Neely"><meta name="robots" content="index, follow"><meta property="article:published_time" content="2017-10-09T12:40:09.305Z"><meta name="twitter:creator" content="@sadisticsystems"><meta name="twitter:site" content="@Medium"><meta property="og:site_name" content="Medium"><meta name="twitter:label1" value="Reading time"><meta name="twitter:data1" value="16 min read"><meta name="twitter:app:name:iphone" content="Medium"><meta name="twitter:app:id:iphone" content="828256236"><meta name="twitter:app:url:iphone" content="medium://p/7158b1cdd50c"><meta property="al:ios:app_name" content="Medium"><meta property="al:ios:app_store_id" content="828256236"><meta property="al:android:package" content="com.medium.reader"><meta property="al:android:app_name" content="Medium"><meta property="al:ios:url" content="medium://p/7158b1cdd50c"><meta property="al:android:url" content="medium://p/7158b1cdd50c"><meta property="al:web:url" content="https://medium.com/@tylerneely/fear-and-loathing-in-lock-free-programming-7158b1cdd50c"><link rel="search" type="application/opensearchdescription+xml" title="Medium" href="https://medium.com/osd.xml"><link rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/7158b1cdd50c"><script type="text/javascript" defer="" src="./Fear and Loathing in Lock-Free Programming – Tyler Neely – Medium_files/client"></script><script async="" src="./Fear and Loathing in Lock-Free Programming – Tyler Neely – Medium_files/branch-latest.min.js"></script><script type="application/ld+json">{"@context":"http://schema.org","@type":"NewsArticle","image":{"@type":"ImageObject","width":800,"height":600,"url":"https://cdn-images-1.medium.com/max/1600/1*ImXIA0dmgvgTRjiSisY-HQ.jpeg"},"url":"https://medium.com/@tylerneely/fear-and-loathing-in-lock-free-programming-7158b1cdd50c","dateCreated":"2017-10-09T12:40:09.305Z","datePublished":"2017-10-09T12:40:09.305Z","dateModified":"2018-04-19T09:52:52.078Z","headline":"Fear and Loathing in Lock-Free Programming","name":"Fear and Loathing in Lock-Free Programming","articleId":"7158b1cdd50c","thumbnailUrl":"https://cdn-images-1.medium.com/max/1600/1*ImXIA0dmgvgTRjiSisY-HQ.jpeg","keywords":["Tag:Programming","Tag:Lock Free","Tag:Concurrency","Tag:Performance","Topic:Programming","LockedPostSource:0","Elevated:false","LayerCake:0"],"author":{"@type":"Person","name":"Tyler Neely","url":"https://medium.com/@tylerneely"},"creator":["Tyler Neely"],"publisher":{"@type":"Organization","name":"Medium","url":"https://medium.com/","logo":{"@type":"ImageObject","width":308,"height":60,"url":"https://cdn-images-1.medium.com/max/616/1*OMF3fSqH8t4xBJ9-6oZDZw.png"}},"mainEntityOfPage":"https://medium.com/@tylerneely/fear-and-loathing-in-lock-free-programming-7158b1cdd50c"}</script><meta name="parsely-link" content="https://medium.com/@tylerneely/fear-and-loathing-in-lock-free-programming-7158b1cdd50c"><link rel="stylesheet" type="text/css" class="js-glyph-" id="glyph-8" href="./Fear and Loathing in Lock-Free Programming – Tyler Neely – Medium_files/m2.css"><link rel="stylesheet" href="./Fear and Loathing in Lock-Free Programming – Tyler Neely – Medium_files/main-branding-base.sMRbh_65n82B91860QdvTg.css"><script>!function(n,e){var t,o,i,c=[],f={passive:!0,capture:!0},r=new Date,a="pointerup",u="pointercancel";function p(n,c){t||(t=c,o=n,i=new Date,w(e),s())}function s(){o>=0&&o<i-r&&(c.forEach(function(n){n(o,t)}),c=[])}function l(t){if(t.cancelable){var o=(t.timeStamp>1e12?new Date:performance.now())-t.timeStamp;"pointerdown"==t.type?function(t,o){function i(){p(t,o),r()}function c(){r()}function r(){e(a,i,f),e(u,c,f)}n(a,i,f),n(u,c,f)}(o,t):p(o,t)}}function w(n){["click","mousedown","keydown","touchstart","pointerdown"].forEach(function(e){n(e,l,f)})}w(n),self.perfMetrics=self.perfMetrics||{},self.perfMetrics.onFirstInputDelay=function(n){c.push(n),s()}}(addEventListener,removeEventListener);</script><script>if (window.top !== window.self) window.top.location = window.self.location.href;var OB_startTime = new Date().getTime(); var OB_loadErrors = []; function _onerror(e) { OB_loadErrors.push(e) }; if (document.addEventListener) document.addEventListener("error", _onerror, true); else if (document.attachEvent) document.attachEvent("onerror", _onerror); function _asyncScript(u) {var d = document, f = d.getElementsByTagName("script")[0], s = d.createElement("script"); s.type = "text/javascript"; s.async = true; s.src = u; f.parentNode.insertBefore(s, f);}function _asyncStyles(u) {var d = document, f = d.getElementsByTagName("script")[0], s = d.createElement("link"); s.rel = "stylesheet"; s.href = u; f.parentNode.insertBefore(s, f); return s}(new Image()).src = "/_/stat?event=pixel.load&origin=" + encodeURIComponent(location.origin);</script><script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date; ga("create", "UA-24232453-2", "auto", {"allowLinker": true, "legacyCookieDomain": window.location.hostname}); ga("send", "pageview");</script><script async="" src="./Fear and Loathing in Lock-Free Programming – Tyler Neely – Medium_files/analytics.js"></script><!--[if lt IE 9]><script charset="UTF-8" src="https://cdn-static-1.medium.com/_/fp/js/shiv.RI2ePTZ5gFmMgLzG5bEVAA.js"></script><![endif]--><link rel="icon" href="https://cdn-static-1.medium.com/_/fp/icons/favicon-rebrand-medium.3Y6xpZ-0FSdWDnPM3hSBIA.ico" class="js-favicon"><link rel="apple-touch-icon" sizes="152x152" href="https://cdn-images-1.medium.com/fit/c/304/304/1*8I-HPL0bfoIzGied-dzOvA.png"><link rel="apple-touch-icon" sizes="120x120" href="https://cdn-images-1.medium.com/fit/c/240/240/1*8I-HPL0bfoIzGied-dzOvA.png"><link rel="apple-touch-icon" sizes="76x76" href="https://cdn-images-1.medium.com/fit/c/152/152/1*8I-HPL0bfoIzGied-dzOvA.png"><link rel="apple-touch-icon" sizes="60x60" href="https://cdn-images-1.medium.com/fit/c/120/120/1*8I-HPL0bfoIzGied-dzOvA.png"><link rel="mask-icon" href="https://cdn-static-1.medium.com/_/fp/icons/monogram-mask.KPLCSFEZviQN0jQ7veN2RQ.svg" color="#171717"></head><body itemscope="" class="postShowScreen browser-chrome os-mac is-withMagicUnderlines v-glyph v-glyph--m2 is-js" data-action-scope="_actionscope_0"><script>document.body.className = document.body.className.replace(/(^|\s)is-noJs(\s|$)/, "$1is-js$2")</script><div class="site-main surface-container" id="container"><div class="butterBar butterBar--error" data-action-scope="_actionscope_1"></div><div class="surface" id="_obv.shell._surface_1557171315056" style="display: block; visibility: visible;"><div class="screenContent surface-content is-supplementalPostContentLoaded" data-used="true" data-action-scope="_actionscope_2"><canvas class="canvas-renderer" width="1384" height="667"></canvas><div class="container u-maxWidth740 u-xs-margin0 notesPositionContainer js-notesPositionContainer"><div class="notesMarkers" data-action-scope="_actionscope_4"><div class="paragraphControls js-paragraphControl js-paragraphControl-d2ac u-noUserSelect is-visible" style="top: 1022px;"><span class="paragraphControls-itemText"><button class="button button--chromeless" data-action="select-anchor" data-action-value="d2ac">Top highlight</button></span></div></div></div><div class="metabar u-clearfix u-boxShadow4px12pxBlackLightest u-fixed u-backgroundTransparentWhiteDarkest u-xs-sizeFullViewportWidth js-metabar"><div class="branch-journeys-top"></div><div class="js-metabarMiddle metabar-inner u-marginAuto u-maxWidth1032 u-flexCenter u-justifyContentSpaceBetween u-height65 u-xs-height56 u-paddingHorizontal20"><div class="metabar-block u-flex1 u-flexCenter"><div class="u-xs-hide js-metabarLogoLeft"><a href="https://medium.com/" data-log-event="home" class="siteNav-logo u-fillTransparentBlackDarker u-flex0 u-flexCenter u-paddingTop0"><span class="svgIcon svgIcon--logoMonogram svgIcon--45px is-flushLeft u-flex0 u-flexCenter u-paddingTop0"><svg class="svgIcon-use" width="45" height="45"><path d="M5 40V5h35v35H5zm8.56-12.627c0 .555-.027.687-.318 1.03l-2.457 2.985v.396h6.974v-.396l-2.456-2.985c-.291-.343-.344-.502-.344-1.03V18.42l6.127 13.364h.714l5.256-13.364v10.644c0 .29 0 .342-.185.528l-1.848 1.796v.396h9.19v-.396l-1.822-1.796c-.184-.186-.21-.238-.21-.528V15.937c0-.291.026-.344.21-.528l1.823-1.797v-.396h-6.471l-4.622 11.542-5.203-11.542h-6.79v.396l2.14 2.64c.239.292.291.37.291.768v10.353z"></path></svg></span><span class="u-textScreenReader">Homepage</span></a></div><div class="u-xs-show js-metabarLogoLeft"><a href="https://medium.com/" data-log-event="home" class="siteNav-logo u-fillTransparentBlackDarker u-flex0 u-flexCenter u-paddingTop0"><span class="svgIcon svgIcon--logoMonogram svgIcon--45px is-flushLeft u-flex0 u-flexCenter u-paddingTop0"><svg class="svgIcon-use" width="45" height="45"><path d="M5 40V5h35v35H5zm8.56-12.627c0 .555-.027.687-.318 1.03l-2.457 2.985v.396h6.974v-.396l-2.456-2.985c-.291-.343-.344-.502-.344-1.03V18.42l6.127 13.364h.714l5.256-13.364v10.644c0 .29 0 .342-.185.528l-1.848 1.796v.396h9.19v-.396l-1.822-1.796c-.184-.186-.21-.238-.21-.528V15.937c0-.291.026-.344.21-.528l1.823-1.797v-.396h-6.471l-4.622 11.542-5.203-11.542h-6.79v.396l2.14 2.64c.239.292.291.37.291.768v10.353z"></path></svg></span><span class="u-textScreenReader">Homepage</span></a></div></div><div class="metabar-block u-flex0"><div class="buttonSet buttonSet--wide"><a class="button button--chromeless u-baseColor--buttonNormal u-xs-hide js-upgradeMembershipAction" href="https://medium.com/membership?source=upgrade_membership---nav_full" data-scroll="native">Become a member</a><a class="button button--primary button--chromeless u-accentColor--buttonNormal is-inSiteNavBar u-xs-hide js-signInButton" href="https://medium.com/m/signin?redirect=https%3A%2F%2Fmedium.com%2F%40tylerneely%2Ffear-and-loathing-in-lock-free-programming-7158b1cdd50c&amp;source=--------------------------nav_reg&amp;operation=login" data-action="sign-in-prompt" data-redirect="https://medium.com/@tylerneely/fear-and-loathing-in-lock-free-programming-7158b1cdd50c" data-action-source="--------------------------nav_reg">Sign in</a><a class="button button--primary button--withChrome u-accentColor--buttonNormal is-inSiteNavBar js-signUpButton" href="https://medium.com/m/signin?redirect=https%3A%2F%2Fmedium.com%2F%40tylerneely%2Ffear-and-loathing-in-lock-free-programming-7158b1cdd50c&amp;source=--------------------------nav_reg&amp;operation=register" data-action="sign-up-prompt" data-redirect="https://medium.com/@tylerneely/fear-and-loathing-in-lock-free-programming-7158b1cdd50c" data-action-source="--------------------------nav_reg">Get started</a></div></div></div></div><div class="metabar metabar--spacer js-metabarSpacer u-height65 u-xs-height56"></div><main role="main"><article class=" u-minHeight100vhOffset65 u-overflowHidden postArticle postArticle--full u-marginBottom40" lang="en"><div class="postArticle-content js-postField js-notesSource js-trackPostScrolls" data-post-id="7158b1cdd50c" data-source="post_page" data-tracking-context="postPage" data-scroll="native"><section name="f7fe" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h1 name="0191" id="0191" class="graf graf--h3 graf--leading graf--title">Fear and Loathing in Lock-Free Programming</h1><div class="uiScale uiScale-ui--regular uiScale-caption--regular u-flexCenter u-marginVertical24 u-fontSize15 js-postMetaLockup"><div class="u-flex0"><a class="link u-baseColor--link avatar" href="https://medium.com/@tylerneely?source=post_header_lockup" data-action="show-user-card" data-action-source="post_header_lockup" data-action-value="5145b6327de1" data-action-type="hover" data-user-id="5145b6327de1" dir="auto"><img src="./Fear and Loathing in Lock-Free Programming – Tyler Neely – Medium_files/1_O4KHGpH9QQ0mYamqf_76yA.jpeg" class="avatar-image u-size50x50" alt="Go to the profile of Tyler Neely"></a></div><div class="u-flex1 u-paddingLeft15 u-overflowHidden"><div class="u-paddingBottom3"><a class="ds-link ds-link--styleSubtle ui-captionStrong u-inlineBlock link link--darken link--darker" href="https://medium.com/@tylerneely" data-action="show-user-card" data-action-value="5145b6327de1" data-action-type="hover" data-user-id="5145b6327de1" dir="auto">Tyler Neely</a><span class="followState js-followState" data-user-id="5145b6327de1"><button class="button button--smallest u-noUserSelect button--withChrome u-baseColor--buttonNormal button--withHover button--unblock js-unblockButton u-marginLeft10 u-xs-hide" data-action="sign-up-prompt" data-sign-in-action="toggle-block-user" data-requires-token="true" data-redirect="https://medium.com/@tylerneely/fear-and-loathing-in-lock-free-programming-7158b1cdd50c" data-action-source="post_header_lockup"><span class="button-label  button-defaultState">Blocked</span><span class="button-label button-hoverState">Unblock</span></button><button class="button button--primary button--smallest button--dark u-noUserSelect button--withChrome u-accentColor--buttonDark button--follow js-followButton u-marginLeft10 u-xs-hide" data-action="sign-up-prompt" data-sign-in-action="toggle-subscribe-user" data-requires-token="true" data-redirect="https://medium.com/_/subscribe/user/5145b6327de1" data-action-source="post_header_lockup-5145b6327de1-------------------------follow_byline"><span class="button-label  button-defaultState js-buttonLabel">Follow</span><span class="button-label button-activeState">Following</span></button></span></div><div class="ui-caption u-noWrapWithEllipsis js-testPostMetaInlineSupplemental"><time datetime="2017-10-09T12:40:09.305Z">Oct 9, 2017</time><span class="middotDivider u-fontSize12"></span><span class="readingTime" title="16 min read"></span></div></div></div><figure name="7eb4" id="7eb4" class="graf graf--figure graf-after--h3"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 525px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 75%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-image-id="1*ImXIA0dmgvgTRjiSisY-HQ.jpeg" data-width="800" data-height="600" data-action="zoom" data-action-value="1*ImXIA0dmgvgTRjiSisY-HQ.jpeg" data-scroll="native"><img src="./Fear and Loathing in Lock-Free Programming – Tyler Neely – Medium_files/1_ImXIA0dmgvgTRjiSisY-HQ.jpeg" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="56"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1600/1*ImXIA0dmgvgTRjiSisY-HQ.jpeg" src="./Fear and Loathing in Lock-Free Programming – Tyler Neely – Medium_files/1_ImXIA0dmgvgTRjiSisY-HQ(1).jpeg"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1600/1*ImXIA0dmgvgTRjiSisY-HQ.jpeg"></noscript></div></div></figure><p name="d2ac" id="d2ac" class="graf graf--p graf-after--figure">What follows is a whirlwind tour of an area of programming usually only whispered of and seldom explored, perhaps for good reason. Lock-free techniques allow multiple threads to work together in a non-blocking way, often achieving incredible performance. As the name suggests, locks are not used. <span class="markup--quote markup--p-quote is-other" name="anon_3919a781bb1c" data-creator-ids="anon">If the idea of a multithreaded program without mutexes makes you uncomfortable, you are quite sane.</span></p><p name="0cce" id="0cce" class="graf graf--p graf-after--p">Yet lock-free systems are pervasive. Some memory allocators rely on a lock-free radix tree at their core, such as jemalloc. If you have used a queue or channel to communicate between threads, there’s an excellent chance the underlying structure was lock-free. If you have used a language with atomic reference counters, there are lock-free techniques employed throughout the lifetime of objects that use them. Even <a href="http://www.seastar-project.org/" data-href="http://www.seastar-project.org/" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">high-performance databases</a> that avoid the overhead of concurrent structures in their data path <a href="https://github.com/scylladb/seastar/blob/c62bbf9ca7b8a09941586e40645177fcf1bffd72/core/reactor.hh#L295" data-href="https://github.com/scylladb/seastar/blob/c62bbf9ca7b8a09941586e40645177fcf1bffd72/core/reactor.hh#L295" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">still usually rely on a lock-free queue of some sort</a> to communicate across threads.</p><p name="fd8c" id="fd8c" class="graf graf--p graf-after--p">Most respectable engineers know to avoid lock-free techniques at all costs. Just like threading, distributed systems or any of the myriad human productivity sinks that are better sidestepped with a refactor or more powerful hardware. If you can use one thread, you should.</p><p name="7312" id="7312" class="graf graf--p graf-after--p">Single-threaded systems are infinitely easier to reason about, will have fewer bugs, and usually have better per-thread performance anyway due to not needing to block on a mutex or disrupt CPU progress with memory barriers. When you must use concurrency, you can sometimes get comparable or better performance than lock-free techniques by using fine-grained mutexes.</p><p name="cf43" id="cf43" class="graf graf--p graf-after--p">As someone who finds bugs in systems for fun and profit (occasionally successfully!) <strong class="markup--strong markup--p-strong">let me be clear</strong>:</p><figure name="d4ca" id="d4ca" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 1050px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 150%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-image-id="1*MbItv9J5KMGqnpMlUmgQZA.jpeg" data-width="1000" data-height="1500" data-action="zoom" data-action-value="1*MbItv9J5KMGqnpMlUmgQZA.jpeg" data-scroll="native"><img src="./Fear and Loathing in Lock-Free Programming – Tyler Neely – Medium_files/1_MbItv9J5KMGqnpMlUmgQZA.jpeg" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="50" height="75"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1600/1*MbItv9J5KMGqnpMlUmgQZA.jpeg" src="./Fear and Loathing in Lock-Free Programming – Tyler Neely – Medium_files/1_MbItv9J5KMGqnpMlUmgQZA(1).jpeg"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1600/1*MbItv9J5KMGqnpMlUmgQZA.jpeg"></noscript></div></div><figcaption class="imageCaption">Say no to lock-free algorithms! Say yes to&nbsp;pizza!</figcaption></figure><p name="86f2" id="86f2" class="graf graf--p graf--hasDropCapModel graf--hasDropCap graf-after--figure"><span class="graf-dropCap">A</span>rtisanal lock-free algorithms are symptomatic of a long chain of bad decisions. They are almost impossible to correctly write. As far as I can tell, there are only <a href="http://www.1024cores.net/" data-href="http://www.1024cores.net/" class="markup--anchor markup--p-anchor" rel="noopener nofollow" target="_blank">two</a> <a href="https://www.youtube.com/watch?v=c1gO9aB9nbs" data-href="https://www.youtube.com/watch?v=c1gO9aB9nbs" class="markup--anchor markup--p-anchor" rel="noopener nofollow" target="_blank">people</a> who actually know how to write them. These algorithms are extremely difficult to reason about, and you will be forever haunted by the real possibility that you missed some critical assumption.</p><p name="b5dc" id="b5dc" class="graf graf--p graf-after--p">Lock-free algorithms often require knowledge of <a href="https://www.learntla.com/introduction/example/" data-href="https://www.learntla.com/introduction/example/" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">obscure tooling</a> to verify, and usually violate <a href="https://mechanical-sympathy.blogspot.de/2011/09/single-writer-principle.html" data-href="https://mechanical-sympathy.blogspot.de/2011/09/single-writer-principle.html" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">the single-writer principle</a>. If you’re lucky enough to have found a bug you created, it could be quite challenging to reproduce it. Sometimes in mailing lists you see stuff like “I ran it for 38 hours on a test cluster and it didn’t blow up, but I just thought of this theoretical edge case I haven’t been able to reproduce yet and I think may be possible.” (I’ll cover the issues of exhaustive and deterministic testing in a future post featuring using ptrace and some tricks I found in a shady exploit crafter’s toolbox to tease out bugs!)</p><p name="5c34" id="5c34" class="graf graf--p graf-after--p">So, without further ado, let’s ignore our better judgement and light ourselves on fire!</p><h3 name="dfb2" id="dfb2" class="graf graf--h3 graf-after--p">Lock-Free 101</h3><p name="c0ac" id="c0ac" class="graf graf--p graf-after--h3">In lock-free programming, we don’t use mutexes. Too safe, they say. Too luxurious an abstraction for the bleeding edge. Some folks go so far as to <strong class="markup--strong markup--p-strong">intentionally</strong> trigger <a href="https://www.youtube.com/watch?v=3LcNHxBJw2Q" data-href="https://www.youtube.com/watch?v=3LcNHxBJw2Q" class="markup--anchor markup--p-anchor" rel="noopener nofollow" target="_blank">race conditions</a> or <a href="http://www.artima.com/lejava/articles/azul_pauseless_gc.html" data-href="http://www.artima.com/lejava/articles/azul_pauseless_gc.html" class="markup--anchor markup--p-anchor" rel="noopener nofollow" target="_blank">dangling pointers</a> just to get high on performance. The depravity in this world runs deep…</p><h4 name="8145" id="8145" class="graf graf--h4 graf-after--p">Roadmap</h4><p name="faab" id="faab" class="graf graf--p graf-after--h4">Atomic operations will be our gateway drug. We will advance through spinlocks, stacks and transactions. A typical tale of overindulgence before crashing hard, being dealt a harsh lesson in the ABA problem and finally ending up in a 8-step responsible implementation program.</p><p name="7fee" id="7fee" class="graf graf--p graf-after--p">Please note that some of my examples come from the world of distributed systems, which I am more familiar with, although the (utterly depraved) mindset is generally similar.</p><h4 name="47d0" id="47d0" class="graf graf--h4 graf-after--p">Atomic Operations</h4><p name="1ddf" id="1ddf" class="graf graf--p graf-after--h4">Atomicity, for the purposes of this article, can be interpreted to mean indivisible, uninterruptible, and either 100% successful or 100% unsuccessful. It is impossible to witness a half-complete atomic operation. Examples of things that are atomic are database transactions (<a href="https://github.com/ept/hermitage" data-href="https://github.com/ept/hermitage" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">but not always as you expect</a>), <a href="https://rcrowley.org/2010/01/06/things-unix-can-do-atomically.html" data-href="https://rcrowley.org/2010/01/06/things-unix-can-do-atomically.html" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">the </a><code class="markup--code markup--p-code"><a href="https://rcrowley.org/2010/01/06/things-unix-can-do-atomically.html" data-href="https://rcrowley.org/2010/01/06/things-unix-can-do-atomically.html" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">mv</a></code><a href="https://rcrowley.org/2010/01/06/things-unix-can-do-atomically.html" data-href="https://rcrowley.org/2010/01/06/things-unix-can-do-atomically.html" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank"> command</a> found on most unix-like systems, breaking a glass window (it’s either broken or not, never something in-between), etc…</p><p name="8f86" id="8f86" class="graf graf--p graf-after--p">Several of the most popular CPU architectures have instructions that let you atomically set memory to a new value conditionally if you know the current value. This is called “test and set” (TAS), “compare and swap”, or “compare and set” (CAS). The hardware makes sure that only one thread “wins” if several threads attempt a CAS at the same time. All others are unsuccessful. The return value varies across implementations, but a good implementation clearly indicates success or failure.</p><p name="64a5" id="64a5" class="graf graf--p graf-after--p"><code class="markup--code markup--p-code">CAS(variable, old, new)</code> is the shorthand I will use. If <code class="markup--code markup--p-code">variable </code>is set to <code class="markup--code markup--p-code">0</code> then <code class="markup--code markup--p-code">CAS(variable, 0, 1)</code> would succeed, as long as another thread didn’t change the value while we weren’t looking. Then <code class="markup--code markup--p-code">CAS(variable, 1, 0)</code> would set it back. But <code class="markup--code markup--p-code">CAS(variable, "hot garbage", 0)</code> would not work unless one of our thread friends has given <code class="markup--code markup--p-code">variable</code>a surprise hot-garbage makeover&nbsp;;) If several threads try to do <code class="markup--code markup--p-code">CAS(variable, 0, 1)</code> at the same time when the value was set to <code class="markup--code markup--p-code">0</code>, only one of them will succeed.</p><p name="6a96" id="6a96" class="graf graf--p graf-after--p">The amount of data that CAS can operate on is usually limited to the “word size” of the system it’s running on, which is usually the same as the length of a memory address. F̶o̶r̶ ̶x̶8̶6̶_̶6̶4̶,̶ ̶y̶o̶u̶’̶r̶e̶ ̶s̶t̶u̶c̶k̶ ̶w̶i̶t̶h̶ ̶a̶t̶ ̶m̶o̶s̶t̶ ̶6̶4̶ ̶b̶i̶t̶s̶ ̶o̶f̶ ̶c̶o̶m̶p̶a̶r̶a̶t̶i̶v̶e̶ ̶p̶o̶w̶e̶r̶. (edit: x86_64 actually <a href="http://www.felixcloutier.com/x86/CMPXCHG8B:CMPXCHG16B.html" data-href="http://www.felixcloutier.com/x86/CMPXCHG8B:CMPXCHG16B.html" class="markup--anchor markup--p-anchor" rel="noopener nofollow" target="_blank">has a 128-bit CAS</a>, although it’s not available from languages like Go, Java, or Rust. Thanks <a href="https://lobste.rs/u/robgssp" data-href="https://lobste.rs/u/robgssp" class="markup--anchor markup--p-anchor" rel="noopener nofollow" target="_blank">robgssp</a>!) 32-bit architectures often have a double-word “DCAS” that can work on 64 bits. But one word is usually sufficient for use with pointers, counters, bit-packed headers, and all kinds of interesting stuff.</p><p name="8264" id="8264" class="graf graf--p graf-after--p">One sees some really creative uses of space in the lock-free world, it reminds me of the clever tricks people do in the <a href="https://en.wikipedia.org/wiki/Demoscene" data-href="https://en.wikipedia.org/wiki/Demoscene" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">Demoscene</a> to squeeze every last drop of functionality out of a single bit. But this often imposes limits on portability. I’ll touch on some creative ways to use the few bits CAS can compare in the <a href="https://medium.com/@tylerneely/fear-and-loathing-in-lock-free-programming-7158b1cdd50c#808e" data-href="#808e" class="markup--anchor markup--p-anchor">Mitigating ABA</a> section below.</p><p name="6fa8" id="6fa8" class="graf graf--p graf-after--p">And yet, CAS is an extremely powerful primitive! More than enough rope to hang ourselves with! Let’s build a teetering tower of abstractions that could collapse at any second with the slightest misplaced assumption!</p><h4 name="9681" id="9681" class="graf graf--h4 graf-after--p">A Simple&nbsp;Spinlock</h4><p name="34d9" id="34d9" class="graf graf--p graf-after--h4">We can gaze into our past lives of locked leisure by implementing a spinlock in just a few lines. This is not a lock-free algorithm because threads will block until the lock is acquired, but it will illustrate the idea of threads coordinating by using atomic operations. We will spin in a loop until we can successfully change a lock variable from unlocked to locked. Only one thread will be granted exclusive access at a time! <em class="markup--em markup--p-em">Assuming we didn’t accidentally create a spy…</em></p><figure name="c117" id="c117" class="graf graf--figure graf--iframe graf-after--p"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 135%;"></div><div class="progressiveMedia js-progressiveMedia is-canvasLoaded is-imageLoaded" data-scroll="native"><img src="./Fear and Loathing in Lock-Free Programming – Tyler Neely – Medium_files/resize" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="75"></canvas><div class="iframeContainer"><iframe width="700" height="250" data-src="/media/858189f7e7eefc1a3a87d3ea69eecd07?postId=7158b1cdd50c" data-media-id="858189f7e7eefc1a3a87d3ea69eecd07" data-thumbnail="https://i.embed.ly/1/image?url=https%3A%2F%2Favatars0.githubusercontent.com%2Fu%2F1505488%3Fv%3D4%26s%3D400&amp;key=a19fcc184b9711e1b4764040d3dc5c07" class="progressiveMedia-iframe js-progressiveMedia-iframe" allowfullscreen="" frameborder="0" src="./Fear and Loathing in Lock-Free Programming – Tyler Neely – Medium_files/858189f7e7eefc1a3a87d3ea69eecd07.html"></iframe></div><noscript class="js-progressiveMedia-inner"><div class="iframeContainer"><IFRAME width="700" height="250" src="/media/858189f7e7eefc1a3a87d3ea69eecd07?postId=7158b1cdd50c" data-media-id="858189f7e7eefc1a3a87d3ea69eecd07" data-thumbnail="https://i.embed.ly/1/image?url=https%3A%2F%2Favatars0.githubusercontent.com%2Fu%2F1505488%3Fv%3D4%26s%3D400&amp;key=a19fcc184b9711e1b4764040d3dc5c07" allowfullscreen frameborder="0"></IFRAME></div></noscript></div></div></figure><p name="179e" id="179e" class="graf graf--p graf-after--figure">Even though a spinlock is burning power in a tight loop until it succeeds, it actually is sometimes preferred over a traditional mutex. Traditional mutexes put a thread to sleep when they block, increasing the minimum latency for acquiring them from another thread. Modern mutexes are often <a href="http://man7.org/linux/man-pages/man7/futex.7.html" data-href="http://man7.org/linux/man-pages/man7/futex.7.html" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">a hybrid approach</a> between a spinlock and a traditional mutex. Hybrid mutexes will attempt to acquire the lock quickly in userspace using atomic operations, without giving away their kernel-scheduled appointment on the CPU core. If the gambit didn’t pan out, the hybrid mutex will put the thread to sleep with a blocking syscall.</p><p name="8168" id="8168" class="graf graf--p graf-after--p">Many real-world implementations of spinlocks for x86 <a href="https://geidav.wordpress.com/2016/03/23/test-and-set-spinlocks/" data-href="https://geidav.wordpress.com/2016/03/23/test-and-set-spinlocks/" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">will issue a </a><code class="markup--code markup--p-code"><a href="https://geidav.wordpress.com/2016/03/23/test-and-set-spinlocks/" data-href="https://geidav.wordpress.com/2016/03/23/test-and-set-spinlocks/" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">PAUSE</a></code><a href="https://geidav.wordpress.com/2016/03/23/test-and-set-spinlocks/" data-href="https://geidav.wordpress.com/2016/03/23/test-and-set-spinlocks/" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank"> instruction while spinnin</a>g, which improves their efficiency dramatically. In addition to spinlocks avoiding the kernel scheduling overhead of going to sleep and waking up again, we also avoid CPU frequency scaling slowdowns that can happen while blocked on a mutex, so when we enter our critical section we don’t need to pay a start-up tax.</p><p name="c9c2" id="c9c2" class="graf graf--p graf-after--p">There are still some cases when you would prefer a straight-up spinlock, like if you know the expected time to acquire the lock is less expensive to you than the overhead of a modern hybrid mutex, or if you want a piece of code to be extremely responsive at the cost of some other system resource like power. But as the expected time to acquire the lock goes up, the balance shifts in favor of the mutex (mutexes in most popular threaded languages use the hybrid approach today).</p><h4 name="c752" id="c752" class="graf graf--h4 graf-after--p">A Treiber&nbsp;Stack</h4><p name="1895" id="1895" class="graf graf--p graf-after--h4">A Treiber stack will be our first true lock-free structure! It looks a lot like a linked list, with a head that points to the tip and nodes that point to the next node. We can push things into a lock-free stack like this:</p><ol class="postList"><li name="9948" id="9948" class="graf graf--li graf-after--p">Create a node (effectively the same as a linked-list node)</li><li name="c5da" id="c5da" class="graf graf--li graf-after--li">Read the current <code class="markup--code markup--li-code">stack.head</code> and set our <code class="markup--code markup--li-code">node.next</code> to it.</li><li name="2069" id="2069" class="graf graf--li graf-after--li">CAS the stack’s head from the head to our new node. If it worked, we’re done! If not, GOTO 2.</li></ol><p name="49d6" id="49d6" class="graf graf--p graf-after--li">Popping the stack is similar:</p><ol class="postList"><li name="b13a" id="b13a" class="graf graf--li graf-after--p">Read the current <code class="markup--code markup--li-code">stack.head</code>. If it’s not set, either retry or return nothing depending on if you have blocking or non-blocking semantics. The example below is non-blocking, and returns nothing.</li><li name="ae44" id="ae44" class="graf graf--li graf-after--li">If head is set, we try to pop it. Try to CAS the stack’s <code class="markup--code markup--li-code">head</code>to its <code class="markup--code markup--li-code">head.next</code>value. If it worked, return the now-severed head! Otherwise GOTO 1.</li></ol><figure name="6fb5" id="6fb5" class="graf graf--figure graf--iframe graf-after--li"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 35.699999999999996%;"></div><div class="progressiveMedia js-progressiveMedia is-canvasLoaded" data-scroll="native"><img src="./Fear and Loathing in Lock-Free Programming – Tyler Neely – Medium_files/resize" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="75"></canvas><div class="iframeContainer"><iframe width="700" height="250" data-src="/media/48ed7f1625d6ba77b21c13b43991c2e2?postId=7158b1cdd50c" data-media-id="48ed7f1625d6ba77b21c13b43991c2e2" data-thumbnail="https://i.embed.ly/1/image?url=https%3A%2F%2Favatars0.githubusercontent.com%2Fu%2F1505488%3Fv%3D4%26s%3D400&amp;key=a19fcc184b9711e1b4764040d3dc5c07" class="progressiveMedia-iframe js-progressiveMedia-iframe" allowfullscreen="" frameborder="0" src="./Fear and Loathing in Lock-Free Programming – Tyler Neely – Medium_files/saved_resource.html"></iframe></div><noscript class="js-progressiveMedia-inner"><div class="iframeContainer"><IFRAME width="700" height="250" src="/media/48ed7f1625d6ba77b21c13b43991c2e2?postId=7158b1cdd50c" data-media-id="48ed7f1625d6ba77b21c13b43991c2e2" data-thumbnail="https://i.embed.ly/1/image?url=https%3A%2F%2Favatars0.githubusercontent.com%2Fu%2F1505488%3Fv%3D4%26s%3D400&amp;key=a19fcc184b9711e1b4764040d3dc5c07" allowfullscreen frameborder="0"></IFRAME></div></noscript></div></div></figure><h4 name="9aae" id="9aae" class="graf graf--h4 graf-after--figure">Spin Spin&nbsp;Spin</h4><p name="fd40" id="fd40" class="graf graf--p graf-after--h4">If another thread either pushed or popped a node after we read the head value but before we performed our CAS, then our CAS will fail because the current value is no longer what we read before. We’ve been had! But we can just spin until we succeed or crash from the bug we accidentally wrote.</p><figure name="d0e0" id="d0e0" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 350px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 50%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded" data-image-id="1*LY2ohYsNa9nOV1Clko3zJA.png" data-width="2000" data-height="1000" data-action="zoom" data-action-value="1*LY2ohYsNa9nOV1Clko3zJA.png" data-scroll="native"><img src="./Fear and Loathing in Lock-Free Programming – Tyler Neely – Medium_files/1_LY2ohYsNa9nOV1Clko3zJA.png" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="37"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1600/1*LY2ohYsNa9nOV1Clko3zJA.png"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1600/1*LY2ohYsNa9nOV1Clko3zJA.png"></noscript></div></div><figcaption class="imageCaption">Similar to an aircraft holding pattern before landing, lock-free algorithms can spin in a loop until they are able to complete.</figcaption></figure><p name="35db" id="35db" class="graf graf--p graf-after--figure">This is a common theme in lock-free algorithms: spin until successful. This means that if a system has high contention (threads competing for the same resource), or spends lots of time doing things that look like spinlocks, a lock-free algorithm could be far less efficient with CPU resources than a mutex that puts blocked threads to sleep. If lots of threads are looping and throwing away work that they do, another approach may work better.</p><p name="8dda" id="8dda" class="graf graf--p graf-after--p">Maybe this is a good place to stop. Let’s give up and return to our cozy mutex-protected hometown, more experienced, and appreciative of its simple beauty.</p><h4 name="cc6d" id="cc6d" class="graf graf--h4 graf-after--p">No More&nbsp;Waiting</h4><p name="00eb" id="00eb" class="graf graf--p graf-after--h4">But our life has only recently taken a turn for the worst, and it would be a shame not to see this one through to rock bottom. <strong class="markup--strong markup--p-strong">Wait-free algorithms</strong>, a subset of lock-free algorithms, guarantee <em class="markup--em markup--p-em">bounded time execution</em>. If your algorithm involves atomic variables and a bounded number of steps, you‘ve got a wait-free algorithm on your hands!</p><p name="80cc" id="80cc" class="graf graf--p graf-after--p">A simple one is incrementing and decrementing an <a href="http://www.1024cores.net/home/lock-free-algorithms/introduction" data-href="http://www.1024cores.net/home/lock-free-algorithms/introduction" class="markup--anchor markup--p-anchor" rel="noopener nofollow" target="_blank">atomic reference counter</a>. This is what Python, Swift, and sometimes Rust use for keeping track of objects shared by multiple threads that need to be destroyed exactly once when all threads are done. This is a simple form of garbage collection!</p><p name="5fe9" id="5fe9" class="graf graf--p graf-after--p">The use of a constant number of instructions (1 in the case of incrementing or decrementing an atomic reference counter) is actually an example of a particularly strong type of wait-freedom known as “wait-free population oblivious” where the number of steps we take in our code is not dependent on the number of threads participating. Other wait-free algorithms sometimes work by trying to complete the work of a bounded number of other threads, and that bound could grow or shrink as the number of participating threads changes.</p><h4 name="d034" id="d034" class="graf graf--h4 graf-after--p">The Value of Reliable&nbsp;Latency</h4><p name="f41f" id="f41f" class="graf graf--p graf-after--h4">More complex wait-free algorithms are often a bit slower than lock-free counterparts when there’s no contention, but under high load they can weather the storm with predictable latency, making them an ideal choice for use in real-time systems.</p><p name="c0c7" id="c0c7" class="graf graf--p graf-after--p">Reliable latency is particularly important for building high-performance systems, even when it means higher average latency. If there is a rare, super slow event, it can cause backpressure to whiplash through large swaths of the system and in practice you’ll get blasts of failures, like connection errors as the TCP backlog quickly fills up. People who have managed redis at high scales are often too familiar with the devastating effects of a single very slow command on their overall system’s reliability, because it stops all other commands from being handled until the slow one is complete. With concurrent algorithms, it’s often a similar story.</p><p name="5651" id="5651" class="graf graf--p graf-after--p">In the last few years, folks have found a nice balance between usually-fast lock-free and reliable wait-free algorithms by <a href="http://www.cs.technion.ac.il/~erez/Papers/wf-methodology-ppopp12.pdf" data-href="http://www.cs.technion.ac.il/~erez/Papers/wf-methodology-ppopp12.pdf" class="markup--anchor markup--p-anchor" rel="noopener nofollow" target="_blank">attempting the lock-free version at first, and falling back to the wait-free version if it doesn’t pan out</a>. This reminds me of the compromise found in modern hybrid mutexes to improve the flexibility of the implementation.</p><h4 name="8dfa" id="8dfa" class="graf graf--h4 graf-after--p">Lock-Free Transactions on Multiple Items in a&nbsp;Tree</h4><p name="e932" id="e932" class="graf graf--p graf-after--h4">A technique sometimes used in databases and filesystems is <a href="https://en.wikipedia.org/wiki/Shadow_paging" data-href="https://en.wikipedia.org/wiki/Shadow_paging" class="markup--anchor markup--p-anchor" rel="noopener nofollow" target="_blank"><strong class="markup--strong markup--p-strong">shadow paging</strong></a>. Sometimes we want to atomically update multiple items stored in a tree structure. The basic idea is:</p><ol class="postList"><li name="6a5e" id="6a5e" class="graf graf--li graf-after--p">read the pointer to the root</li><li name="ff18" id="ff18" class="graf graf--li graf-after--li">copy the things we want to change into new tree nodes, then go up the tree creating new (copied) nodes that reference the previous copied and changed level, going up the tree until we reach the root. All of this is done without changing the original tree.</li><li name="1569" id="1569" class="graf graf--li graf-after--li">Finally, we CAS the root to point to our changed pages.</li><li name="3f26" id="3f26" class="graf graf--li graf-after--li">if the CAS worked, our multi-item transaction was successful. if not, we either retry or propagate an error to the next higher level of our system.</li></ol><p name="189c" id="189c" class="graf graf--p graf-after--li">This copy-on-write technique is quite useful in some lock-free systems, but it can involve excessive copying. It’s fairly rare that this technique is a better choice than using fine-grained <a href="https://en.wikipedia.org/wiki/Readers%E2%80%93writer_lock" data-href="https://en.wikipedia.org/wiki/Readers%E2%80%93writer_lock" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">reader-writer locks</a> on multiple items in a tree. Still, a good trick to have in our spellbook for transactions on a small number of shared items.</p><p name="700d" id="700d" class="graf graf--p graf-after--p">There are a <a href="https://github.com/awslabs/dynamodb-transactions/blob/master/DESIGN.md" data-href="https://github.com/awslabs/dynamodb-transactions/blob/master/DESIGN.md" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">number</a> of interesting lock-free transaction techniques that work on <a href="https://static.googleusercontent.com/media/research.google.com/en//pubs/archive/36726.pdf" data-href="https://static.googleusercontent.com/media/research.google.com/en//pubs/archive/36726.pdf" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">larger datasets</a>, but they are a little more complicated. If you’re curious I suggest starting with <a href="http://rystsov.info/2012/09/01/cas.html" data-href="http://rystsov.info/2012/09/01/cas.html" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">this one</a>. Note that these are actually algorithms from the distributed systems world, which is similar to lock-free in many ways, differing mostly in terms of latency and reliability. If it works in a distributed system, it will work on a single system, but may totally be overkill.</p><h3 name="9fb7" id="9fb7" class="graf graf--h3 graf-after--p">Common Problems in Lock-Free Programs</h3><h4 name="6269" id="6269" class="graf graf--h4 graf-after--h3">The ABA&nbsp;Problem</h4><p name="8dae" id="8dae" class="graf graf--p graf-after--h4"><code class="markup--code markup--p-code">5 == 5 — 1 + 1</code></p><p name="0f4e" id="0f4e" class="graf graf--p graf-after--p">One may assume “if our CAS succeeded, nothing has happened since we read the old value”. This is only true for <a href="https://en.wikipedia.org/wiki/Monotonic_function" data-href="https://en.wikipedia.org/wiki/Monotonic_function" class="markup--anchor markup--p-anchor" rel="noopener nofollow" target="_blank"><strong class="markup--strong markup--p-strong">monotonic</strong></a> values like a counter that you only increment. But if you can increment AND decrement the counter, all hell breaks loose. If a non-monotonic value was 17 one minute ago and it’s 17 now, there may have been a bunch of random increments and decrements in the interlude. Or maybe a single operation that caused the value to wrap.</p><p name="2b5b" id="2b5b" class="graf graf--p graf-after--p">If you’re using a 64 bit counter, and you’re incrementing it once every second for every human on earth, in less than 100 years your counter will reach the maximum 64 bit number and wrap back to 0 when the next addition occurs. If you’re using a 32 bit number, you have less than one second of sanity. Don’t spend it all in one place!</p><p name="5b2f" id="5b2f" class="graf graf--p graf-after--p">This is problematic to the extent that we <em class="markup--em markup--p-em">conflate equality with a lack of change</em>. In the next section I’ll show you a gnarly scar I got from making this mistake.</p><h4 name="07df" id="07df" class="graf graf--h4 graf-after--p">ABA and&nbsp;Pointers</h4><p name="414e" id="414e" class="graf graf--p graf-after--h4">Very often, we use CAS operations on pointers. If we can rely on a strong GC system, we don’t need to worry about dangling pointers, and it can be simpler to build more complicated lock-free structures in Java or Go compared to C++ or Rust because of this.</p><p name="5108" id="5108" class="graf graf--p graf-after--p">Pointers are not monotonic!!! Our memory allocators often will put a new memory family in the same memory house when the old one moves away to memory heaven (or memory hell if they were bad and spent their lives writing lock-free algorithms).</p><p name="0d6d" id="0d6d" class="graf graf--p graf-after--p">This really happened to me:</p><ol class="postList"><li name="88fd" id="88fd" class="graf graf--li graf-after--p">I put a 48 byte structure into a lock-free stack that represented the history of a shared piece of state</li><li name="eb01" id="eb01" class="graf graf--li graf-after--li">A thread <strong class="markup--strong markup--li-strong">read</strong> the <code class="markup--code markup--li-code">stack.head</code> for the “history stack”</li><li name="fb3d" id="fb3d" class="graf graf--li graf-after--li">I deleted the structure and set the history stack’s <code class="markup--code markup--li-code">stack.head</code> to null. I <strong class="markup--strong markup--li-strong">freed</strong> all of the objects that were in history, including the object from step #1</li><li name="0628" id="0628" class="graf graf--li graf-after--li">I created a <strong class="markup--strong markup--li-strong">new history</strong> stack for the object, and allocated a new 48 byte structure. The memory allocator chose the same offset as the original object in step #1, because it was a good fit.</li><li name="19cf" id="19cf" class="graf graf--li graf-after--li">the thread from #2 looked at the old history stack and decided it should attempt to augment that history</li><li name="7308" id="7308" class="graf graf--li graf-after--li">the thread from #2 created a new update whose correctness was dependent on the history being unchanged</li><li name="e285" id="e285" class="graf graf--li graf-after--li">the thread from #2 did a CAS operation on the new stack, which represented significant changes. <strong class="markup--strong markup--li-strong">The CAS worked </strong>because the address was the same as when the read occurred in step #2. My tests did not catch this bug.</li><li name="6e8c" id="6e8c" class="graf graf--li graf-after--li">I went to <strong class="markup--strong markup--li-strong">memory hell</strong> for a long time until I understood the nature of my memory sins. It was messed up.</li></ol><p name="9267" id="9267" class="graf graf--p graf-after--li">This was actually two bugs: ABA and a dangling pointer that was left referring to invalid state. I assumed my CAS protected me from caring about it as long as I never dereferenced it, but I was dead wrong. If you’re curious, I was trying to <a href="https://github.com/spacejam/sled" data-href="https://github.com/spacejam/sled" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">implement</a> a similar system to the one shown on <a href="http://cs.brown.edu/courses/cs227/archives/2015/slides/week2/2-sam-BWTree.pdf" data-href="http://cs.brown.edu/courses/cs227/archives/2015/slides/week2/2-sam-BWTree.pdf" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">slide 11</a> from this presentation on Bw-Trees.</p><h3 name="dd22" id="dd22" class="graf graf--h3 graf-after--p">Common Safeguards</h3><h4 name="808e" id="808e" class="graf graf--h4 graf-after--h3">Mitigating ABA</h4><p name="0613" id="0613" class="graf graf--p graf-after--h4">There are a number of techniques for avoiding ABA!</p><ol class="postList"><li name="342e" id="342e" class="graf graf--li graf-after--p">Don’t write lock-free algorithms. It’s really a no-brainer. Don’t do it.</li><li name="68c5" id="68c5" class="graf graf--li graf-after--li">Add some extra stuff to the data that we put in atomic variables. Use 16-bits to store a quasi-monotonic counter that you bump by 1 each time you modify the shared state. How many bits of state do you really need? 64-bit linux actually uses 48 bits for addresses (256 TB of address space, but this is reconfigurable if you are <strong class="markup--strong markup--li-strong">baller AF</strong>), so you have 16 bits free with pointers anyway. If a structure takes up 2⁵ bytes each, and it’s allocated at aligned addresses, then you have 5 bits of free state in the “low-bits” to use for even more tag data. Just don’t forget to zero those bits out before you dereference the actual pointer!</li></ol><h4 name="0092" id="0092" class="graf graf--h4 graf-after--li">Mitigating Dangling Pointers and Use After&nbsp;Free</h4><p name="fe05" id="fe05" class="graf graf--p graf-after--h4">In addition to ABA, we have new challenges in managing our memory, now that multiple threads may be reading and mutating our shared state concurrently.</p><p name="0d7e" id="0d7e" class="graf graf--p graf-after--p">When we remove an item from a lock-free stack, for example, there may be threads that read the node just before we detached it! Those threads may still be operating on the now-unreachable state. So after we remove the node from the stack, we must wait until we know that all threads are done reading it before using the memory for something else.</p><p name="e277" id="e277" class="graf graf--p graf-after--p">This is a tricky problem, but luckily there are some good ways to reduce the bleeding.</p><ol class="postList"><li name="d38f" id="d38f" class="graf graf--li graf-after--p">Use a language with GC. This eliminates these bugs by design. Plenty of good choices out there. <a href="http://www.elise.com/quotes/heinlein_-_specialization_is_for_insects" data-href="http://www.elise.com/quotes/heinlein_-_specialization_is_for_insects" class="markup--anchor markup--li-anchor" rel="nofollow noopener" target="_blank">Specialization is for insects</a>! Go learn Java, you C++ hipsters! Rust’s guaranteed object destruction without GC doesn’t cover your ass in the lock-free world (but check out the first links in #2 or #3 for nice solutions).</li><li name="1347" id="1347" class="graf graf--li graf-after--li"><a href="https://aturon.github.io/blog/2015/08/27/epoch/" data-href="https://aturon.github.io/blog/2015/08/27/epoch/" class="markup--anchor markup--li-anchor" rel="noopener nofollow" target="_blank">Epoch Reclamation</a> has threads check-in to an “epoch” before they access shared state. When they stop working on shared state, they check-out of that epoch. When state is made unreachable, and you want to delete it, you have to wait until any thread that COULD have seen it has moved on. For each object we want to free, we add it to the <em class="markup--em markup--li-em">current</em> epoch’s garbage bag (this could be a later epoch than the one we initially checked into). Only after all threads have checked out of epochs before or equal to the one for a particular garbage bag can we actually free the data. This is how I fixed the bug I hit in the <a href="https://medium.com/@tylerneely/fear-and-loathing-in-lock-free-programming-7158b1cdd50c#0d6d" data-href="#0d6d" class="markup--anchor markup--li-anchor">ABA and Pointers</a> section. This is used extensively in the <a href="https://lwn.net/Articles/262464/" data-href="https://lwn.net/Articles/262464/" class="markup--anchor markup--li-anchor" rel="nofollow noopener" target="_blank">linux kernel’s RCU system</a>.</li><li name="3f91" id="3f91" class="graf graf--li graf-after--li"><a href="http://ticki.github.io/blog/fearless-concurrency-with-hazard-pointers/" data-href="http://ticki.github.io/blog/fearless-concurrency-with-hazard-pointers/" class="markup--anchor markup--li-anchor" rel="noopener nofollow" target="_blank">Hazard Pointers</a> are similar to epoch reclamation but they operate on a more fine-grained level. This can be good for keeping latency per reclamation lower, but it will drop the throughput of the system.</li></ol><h3 name="6c93" id="6c93" class="graf graf--h3 graf-after--li">Making a Lock-Free System For&nbsp;Real</h3><p name="1dd6" id="1dd6" class="graf graf--p graf-after--h3">So, you want to use this stuff in production. The reliability consultant in me delights. Go forth. Build a bonfire. But seriously, this takes a real investment. Like distributed algorithms, there are tons of subtleties here that are easy to miss, even by experts. Here is a responsible path to take if you choose to do so:</p><ol class="postList"><li name="1866" id="1866" class="graf graf--li graf-after--p">Use a popular, well-tested existing library for as much as possible. Ideally one known to be running at very high scales at one of the infrastructure / financial giants in correctness-critical paths, not just some low-risk internal subsystem.</li><li name="8ef4" id="8ef4" class="graf graf--li graf-after--li">If you must implement something on your own, scour the literature for known solutions. Opt for the ones that are a little older with high citation counts. New algorithms described in papers in this field are sometimes found to contain subtle bugs.</li><li name="5c56" id="5c56" class="graf graf--li graf-after--li">Understand by modeling before implementing. Write an <a href="http://iris-project.org/" data-href="http://iris-project.org/" class="markup--anchor markup--li-anchor" rel="nofollow noopener" target="_blank">Iris</a>, SPIN, TLA+, etc… model describing the algorithm to make sure you really understand what’s going on. You will usually save a lot of time by modeling it before jumping into implementation. Check out <a href="https://www.learntla.com/introduction/example/" data-href="https://www.learntla.com/introduction/example/" class="markup--anchor markup--li-anchor" rel="noopener nofollow" target="_blank">this guide</a> for getting started with TLA+! It’s weird and fun.</li><li name="5b8f" id="5b8f" class="graf graf--li graf-after--li">Follow the <a href="http://wiki.c2.com/?CleanroomSoftwareEngineering" data-href="http://wiki.c2.com/?CleanroomSoftwareEngineering" class="markup--anchor markup--li-anchor" rel="nofollow noopener" target="_blank">cleanroom methodology</a> while implementing it.</li><li name="fbe0" id="fbe0" class="graf graf--li graf-after--li">Find a way to deterministically and exhaustively evaluate all interesting thread interleavings of your implementation. Lots of bugs will jump out if you can do this! Just running a test workload for a few weeks on a small test cluster is not representative of what will happen on diverse hardware running diverse workloads and causing threads to be scheduled in diverse ways. This is the holy grail! Start your implementation from the beginning with this goal in mind, and build things into it that make testing in this way easier. (and stay tuned for a future post on this subject)</li><li name="5554" id="5554" class="graf graf--li graf-after--li">Use the <a href="https://github.com/google/sanitizers/wiki" data-href="https://github.com/google/sanitizers/wiki" class="markup--anchor markup--li-anchor" rel="nofollow noopener" target="_blank">LLVM sanitizers</a> extensively while exercising interleavings in the code, if your programming language supports them or similar tooling. They will slow down your program a little bit, but will detect all sorts of bugs that may not break your tests. They can find race conditions, memory leaks, use-after-free bugs, buffer overflows, all sorts of juicy stuff. When Hanno compiled a standard linux system to run the sanitizers on his entire system, <a href="https://www.youtube.com/watch?v=npWY4hMTBhI" data-href="https://www.youtube.com/watch?v=npWY4hMTBhI" class="markup--anchor markup--li-anchor" rel="nofollow noopener" target="_blank">he found and fixed an astounding number of bugs</a> in several programs you may rely on every day.</li><li name="3981" id="3981" class="graf graf--li graf-after--li">Remember that by learning about specific bug classes, <a href="http://lesswrong.com/lw/he/knowing_about_biases_can_hurt_people/" data-href="http://lesswrong.com/lw/he/knowing_about_biases_can_hurt_people/" class="markup--anchor markup--li-anchor" rel="nofollow noopener" target="_blank">you may actually become MORE vulnerable to falling victim to them</a>! We have a tendency to be overconfident about our ability to deal with problems we’ve learned about.</li><li name="16c5" id="16c5" class="graf graf--li graf-after--li">Don’t write lock-free algorithms. You will die.</li></ol><p name="5ab7" id="5ab7" class="graf graf--p graf-after--li graf--trailing">Thanks for reading! This is my first blog post, and I’d appreciate any feedback that would improve the experience for future articles! I’d like to give special thanks to those who defended readers against some of my egregious and irresponsible use of language, in (possibly buggy) alphabetical order: Alex Laties, Casey C, <a href="https://twitter.com/daiyitastic" data-href="https://twitter.com/daiyitastic" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">daiyi</a>, Gabe Conradi, Matthias Nehlsen, Peter Kolloch, Philipp Muens, Sargun Dhillon, Sassan F, and Steve Salevan, thank you so much!</p></div></div></section></div><footer class="u-paddingTop10"><div class="container u-maxWidth740"><div class="row"><div class="col u-size12of12"><div class="postMetaInline postMetaInline--acknowledgments u-paddingTop5 u-paddingBottom20 js-postMetaAcknowledgments"><span data-tooltip="The following people helped the author by providing feedback before the story was published.">Thanks to</span> <span><a class="link u-baseColor--link" href="https://medium.com/@sargun?source=post_page" data-action="show-user-card" data-action-source="post_page" data-action-value="f602b6172157" data-action-type="hover" data-user-id="f602b6172157" dir="auto">Sargun Dhillon</a> and </span><span><a class="link u-baseColor--link" href="https://medium.com/@squeed?source=post_page" data-action="show-user-card" data-action-source="post_page" data-action-value="95ce17501c5e" data-action-type="hover" data-user-id="95ce17501c5e" dir="auto">˙Ↄ ʎǝsɐↃ</a></span>. </div></div></div><div class="row"><div class="col u-size12of12 js-postTags"><div class="u-paddingBottom10"><ul class="tags tags--postTags tags--borderless"><li><a class="link u-baseColor--link" href="https://medium.com/tag/programming?source=post" data-action-source="post">Programming</a></li><li><a class="link u-baseColor--link" href="https://medium.com/tag/lock-free?source=post" data-action-source="post">Lock Free</a></li><li><a class="link u-baseColor--link" href="https://medium.com/tag/concurrency?source=post" data-action-source="post">Concurrency</a></li><li><a class="link u-baseColor--link" href="https://medium.com/tag/performance?source=post" data-action-source="post">Performance</a></li></ul></div></div></div><div class="postActions js-postActionsFooter "><div class="u-flexCenter"><div class="u-flex1"><div class="multirecommend js-actionMultirecommend u-flexCenter" data-post-id="7158b1cdd50c" data-is-icon-29px="true" data-is-circle="true" data-has-recommend-list="true" data-source="post_actions_footer-----7158b1cdd50c---------------------clap_footer" data-clap-string-singular="clap" data-clap-string-plural="claps"><div class="u-relative u-foreground"><button class="button button--large button--circle button--withChrome u-baseColor--buttonNormal button--withIcon button--withSvgIcon clapButton js-actionMultirecommendButton clapButton--darker clapButton--largePill u-relative u-foreground u-xs-paddingLeft13 u-width60 u-height60 u-accentColor--textNormal u-accentColor--buttonNormal clap-onboarding" data-action="sign-up-prompt" data-sign-in-action="multivote" data-requires-token="true" data-redirect="https://medium.com/_/vote/p/7158b1cdd50c" data-action-source="post_actions_footer-----7158b1cdd50c---------------------clap_footer" aria-label="Clap"><span class="button-defaultState"><span class="svgIcon svgIcon--clap svgIcon--33px u-relative u-topNegative2 u-xs-top0"><svg class="svgIcon-use" width="33" height="33"><path d="M28.86 17.342l-3.64-6.402c-.292-.433-.712-.729-1.163-.8a1.124 1.124 0 0 0-.889.213c-.63.488-.742 1.181-.33 2.061l1.222 2.587 1.4 2.46c2.234 4.085 1.511 8.007-2.145 11.663-.26.26-.526.49-.797.707 1.42-.084 2.881-.683 4.292-2.094 3.822-3.823 3.565-7.876 2.05-10.395zm-6.252 11.075c3.352-3.35 3.998-6.775 1.978-10.469l-3.378-5.945c-.292-.432-.712-.728-1.163-.8a1.122 1.122 0 0 0-.89.213c-.63.49-.742 1.182-.33 2.061l1.72 3.638a.502.502 0 0 1-.806.568l-8.91-8.91a1.335 1.335 0 0 0-1.887 1.886l5.292 5.292a.5.5 0 0 1-.707.707l-5.292-5.292-1.492-1.492c-.503-.503-1.382-.505-1.887 0a1.337 1.337 0 0 0 0 1.886l1.493 1.492 5.292 5.292a.499.499 0 0 1-.353.854.5.5 0 0 1-.354-.147L5.642 13.96a1.338 1.338 0 0 0-1.887 0 1.338 1.338 0 0 0 0 1.887l2.23 2.228 3.322 3.324a.499.499 0 0 1-.353.853.502.502 0 0 1-.354-.146l-3.323-3.324a1.333 1.333 0 0 0-1.886 0 1.325 1.325 0 0 0-.39.943c0 .356.138.691.39.943l6.396 6.397c3.528 3.53 8.86 5.313 12.821 1.353zM12.73 9.26l5.68 5.68-.49-1.037c-.518-1.107-.426-2.13.224-2.89l-3.303-3.304a1.337 1.337 0 0 0-1.886 0 1.326 1.326 0 0 0-.39.944c0 .217.067.42.165.607zm14.787 19.184c-1.599 1.6-3.417 2.392-5.353 2.392-.349 0-.7-.03-1.058-.082a7.922 7.922 0 0 1-3.667.887c-3.049 0-6.115-1.626-8.359-3.87l-6.396-6.397A2.315 2.315 0 0 1 2 19.724a2.327 2.327 0 0 1 1.923-2.296l-.875-.875a2.339 2.339 0 0 1 0-3.3 2.33 2.33 0 0 1 1.24-.647l-.139-.139c-.91-.91-.91-2.39 0-3.3.884-.884 2.421-.882 3.301 0l.138.14a2.335 2.335 0 0 1 3.948-1.24l.093.092c.091-.423.291-.828.62-1.157a2.336 2.336 0 0 1 3.3 0l3.384 3.386a2.167 2.167 0 0 1 1.271-.173c.534.086 1.03.354 1.441.765.11-.549.415-1.034.911-1.418a2.12 2.12 0 0 1 1.661-.41c.727.117 1.385.565 1.853 1.262l3.652 6.423c1.704 2.832 2.025 7.377-2.205 11.607zM13.217.484l-1.917.882 2.37 2.837-.454-3.719zm8.487.877l-1.928-.86-.44 3.697 2.368-2.837zM16.5 3.293L15.478-.005h2.044L16.5 3.293z" fill-rule="evenodd"></path></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--clapFilled svgIcon--33px u-relative u-topNegative2 u-xs-top0"><svg class="svgIcon-use" width="33" height="33"><g fill-rule="evenodd"><path d="M29.58 17.1l-3.854-6.78c-.365-.543-.876-.899-1.431-.989a1.491 1.491 0 0 0-1.16.281c-.42.327-.65.736-.7 1.207v.001l3.623 6.367c2.46 4.498 1.67 8.802-2.333 12.807-.265.265-.536.505-.81.728 1.973-.222 3.474-1.286 4.45-2.263 4.166-4.165 3.875-8.6 2.215-11.36zm-4.831.82l-3.581-6.3c-.296-.439-.725-.742-1.183-.815a1.105 1.105 0 0 0-.89.213c-.647.502-.755 1.188-.33 2.098l1.825 3.858a.601.601 0 0 1-.197.747.596.596 0 0 1-.77-.067L10.178 8.21c-.508-.506-1.393-.506-1.901 0a1.335 1.335 0 0 0-.393.95c0 .36.139.698.393.95v.001l5.61 5.61a.599.599 0 1 1-.848.847l-5.606-5.606c-.001 0-.002 0-.003-.002L5.848 9.375a1.349 1.349 0 0 0-1.902 0 1.348 1.348 0 0 0 0 1.901l1.582 1.582 5.61 5.61a.6.6 0 0 1-.848.848l-5.61-5.61c-.51-.508-1.393-.508-1.9 0a1.332 1.332 0 0 0-.394.95c0 .36.139.697.393.952l2.363 2.362c.002.001.002.002.002.003l3.52 3.52a.6.6 0 0 1-.848.847l-3.522-3.523h-.001a1.336 1.336 0 0 0-.95-.393 1.345 1.345 0 0 0-.949 2.295l6.779 6.78c3.715 3.713 9.327 5.598 13.49 1.434 3.527-3.528 4.21-7.13 2.086-11.015zM11.817 7.727c.06-.328.213-.64.466-.893.64-.64 1.755-.64 2.396 0l3.232 3.232c-.82.783-1.09 1.833-.764 2.992l-5.33-5.33z"></path><path d="M13.285.48l-1.916.881 2.37 2.837z"></path><path d="M21.719 1.361L19.79.501l-.44 3.697z"></path><path d="M16.502 3.298L15.481 0h2.043z"></path></g></svg></span></span></button><div class="clapUndo u-width60 u-round u-height32 u-absolute u-borderBox u-paddingRight5 u-transition--transform200Springu-backgroundGrayLighter js-clapUndo" style="top: 14px; padding: 2px;"><button class="button button--chromeless u-baseColor--buttonNormal button--withIcon button--withSvgIcon u-floatRight" data-action="multivote-undo" data-action-value="7158b1cdd50c"><span class="svgIcon svgIcon--removeThin svgIcon--29px"><svg class="svgIcon-use" width="29" height="29"><path d="M20.13 8.11l-5.61 5.61-5.609-5.61-.801.801 5.61 5.61-5.61 5.61.801.8 5.61-5.609 5.61 5.61.8-.801-5.609-5.61 5.61-5.61" fill-rule="evenodd"></path></svg></span></button></div></div><span class="u-relative u-background js-actionMultirecommendCount u-marginLeft16"><button class="button button--chromeless u-baseColor--buttonNormal js-multirecommendCountButton u-textColorDarker" data-action="show-recommends" data-action-value="7158b1cdd50c">906 claps</button><span class="u-xs-hide"></span></span></div></div><div class="buttonSet u-flex0"><a class="button button--dark button--chromeless u-baseColor--buttonDark button--withIcon button--withSvgIcon button--dark button--chromeless u-xs-hide u-marginRight12" href="https://medium.com/p/7158b1cdd50c/share/twitter" title="Share on Twitter" aria-label="Share on Twitter" target="_blank" data-action-source="post_actions_footer"><span class="button-defaultState"><span class="svgIcon svgIcon--twitterFilled svgIcon--29px"><svg class="svgIcon-use" width="29" height="29"><path d="M22.053 7.54a4.474 4.474 0 0 0-3.31-1.455 4.526 4.526 0 0 0-4.526 4.524c0 .35.04.7.082 1.05a12.9 12.9 0 0 1-9.3-4.77c-.39.69-.61 1.46-.65 2.26.03 1.6.83 2.99 2.02 3.79-.72-.02-1.41-.22-2.02-.57-.01.02-.01.04 0 .08-.01 2.17 1.55 4 3.63 4.44-.39.08-.79.13-1.21.16-.28-.03-.57-.05-.81-.08.54 1.77 2.21 3.08 4.2 3.15a9.564 9.564 0 0 1-5.66 1.94c-.34-.03-.7-.06-1.05-.08 2 1.27 4.38 2.02 6.94 2.02 8.31 0 12.86-6.9 12.84-12.85.02-.24.01-.43 0-.65.89-.62 1.65-1.42 2.26-2.34-.82.38-1.69.62-2.59.72a4.37 4.37 0 0 0 1.94-2.51c-.84.53-1.81.9-2.83 1.13z"></path></svg></span></span></a><a class="button button--dark button--chromeless u-baseColor--buttonDark button--withIcon button--withSvgIcon button--dark button--chromeless u-xs-hide u-marginRight12" href="https://medium.com/p/7158b1cdd50c/share/facebook" title="Share on Facebook" aria-label="Share on Facebook" target="_blank" data-action-source="post_actions_footer"><span class="button-defaultState"><span class="svgIcon svgIcon--facebookSquare svgIcon--29px"><svg class="svgIcon-use" width="29" height="29"><path d="M23.209 5H5.792A.792.792 0 0 0 5 5.791V23.21c0 .437.354.791.792.791h9.303v-7.125H12.72v-2.968h2.375v-2.375c0-2.455 1.553-3.662 3.741-3.662 1.049 0 1.95.078 2.213.112v2.565h-1.517c-1.192 0-1.469.567-1.469 1.397v1.963h2.969l-.594 2.968h-2.375L18.11 24h5.099a.791.791 0 0 0 .791-.791V5.79a.791.791 0 0 0-.791-.79"></path></svg></span></span></a><button class="button button--large button--dark button--chromeless u-baseColor--buttonDark button--withIcon button--withSvgIcon u-xs-show u-marginRight10" title="Share this story on Twitter or Facebook" aria-label="Share this story on Twitter or Facebook" data-action="show-share-popover" data-action-source="post_actions_footer"><span class="svgIcon svgIcon--share svgIcon--29px"><svg class="svgIcon-use" width="29" height="29"><path d="M20.385 8H19a.5.5 0 1 0 .011 1h1.39c.43 0 .84.168 1.14.473.31.305.48.71.48 1.142v10.77c0 .43-.17.837-.47 1.142-.3.305-.71.473-1.14.473H8.62c-.43 0-.84-.168-1.144-.473a1.603 1.603 0 0 1-.473-1.142v-10.77c0-.43.17-.837.48-1.142A1.599 1.599 0 0 1 8.62 9H10a.502.502 0 0 0 0-1H8.615c-.67 0-1.338.255-1.85.766-.51.51-.765 1.18-.765 1.85v10.77c0 .668.255 1.337.766 1.848.51.51 1.18.766 1.85.766h11.77c.668 0 1.337-.255 1.848-.766.51-.51.766-1.18.766-1.85v-10.77c0-.668-.255-1.337-.766-1.848A2.61 2.61 0 0 0 20.384 8zm-8.67-2.508L14 3.207v8.362c0 .27.224.5.5.5s.5-.23.5-.5V3.2l2.285 2.285a.49.49 0 0 0 .704-.001.511.511 0 0 0 0-.708l-3.14-3.14a.504.504 0 0 0-.71 0L11 4.776a.501.501 0 0 0 .71.706" fill-rule="evenodd"></path></svg></span></button><button class="button button--large button--dark button--chromeless is-touchIconBlackPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon" data-action="scroll-to-responses" data-action-source="post_actions_footer"><span class="svgIcon svgIcon--response svgIcon--29px"><svg class="svgIcon-use" width="29" height="29"><path d="M21.27 20.058c1.89-1.826 2.754-4.17 2.754-6.674C24.024 8.21 19.67 4 14.1 4 8.53 4 4 8.21 4 13.384c0 5.175 4.53 9.385 10.1 9.385 1.007 0 2-.14 2.95-.41.285.25.592.49.918.7 1.306.87 2.716 1.31 4.19 1.31.276-.01.494-.14.6-.36a.625.625 0 0 0-.052-.65c-.61-.84-1.042-1.71-1.282-2.58a5.417 5.417 0 0 1-.154-.75zm-3.85 1.324l-.083-.28-.388.12a9.72 9.72 0 0 1-2.85.424c-4.96 0-8.99-3.706-8.99-8.262 0-4.556 4.03-8.263 8.99-8.263 4.95 0 8.77 3.71 8.77 8.27 0 2.25-.75 4.35-2.5 5.92l-.24.21v.32c0 .07 0 .19.02.37.03.29.1.6.19.92.19.7.49 1.4.89 2.08-.93-.14-1.83-.49-2.67-1.06-.34-.22-.88-.48-1.16-.74z"></path></svg></span></button><button class="button button--chromeless u-baseColor--buttonNormal u-marginRight12" data-action="scroll-to-responses">11</button><button class="button button--large button--dark button--chromeless is-touchIconFadeInPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon button--bookmark js-bookmarkButton" title="Bookmark this story to read later" aria-label="Bookmark this story to read later" data-action="sign-up-prompt" data-sign-in-action="add-to-bookmarks" data-requires-token="true" data-redirect="https://medium.com/_/bookmark/p/7158b1cdd50c" data-action-source="post_actions_footer"><span class="button-defaultState"><span class="svgIcon svgIcon--bookmark svgIcon--29px u-marginRight4"><svg class="svgIcon-use" width="29" height="29"><path d="M19.385 4h-9.77A2.623 2.623 0 0 0 7 6.615V23.01a1.022 1.022 0 0 0 1.595.847l5.905-4.004 5.905 4.004A1.022 1.022 0 0 0 22 23.011V6.62A2.625 2.625 0 0 0 19.385 4zM21 23l-5.91-3.955-.148-.107a.751.751 0 0 0-.884 0l-.147.107L8 23V6.615C8 5.725 8.725 5 9.615 5h9.77C20.275 5 21 5.725 21 6.615V23z" fill-rule="evenodd"></path></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--bookmarkFilled svgIcon--29px u-marginRight4"><svg class="svgIcon-use" width="29" height="29"><path d="M19.385 4h-9.77A2.623 2.623 0 0 0 7 6.615V23.01a1.022 1.022 0 0 0 1.595.847l5.905-4.004 5.905 4.004A1.022 1.022 0 0 0 22 23.011V6.62A2.625 2.625 0 0 0 19.385 4z" fill-rule="evenodd"></path></svg></span></span></button><button class="button button--large button--dark button--chromeless is-touchIconBlackPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon js-moreActionsButton" title="More actions" aria-label="More actions" data-action="more-actions"><span class="svgIcon svgIcon--more svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="-480.5 272.5 21 21"><path d="M-463 284.6c.9 0 1.6-.7 1.6-1.6s-.7-1.6-1.6-1.6-1.6.7-1.6 1.6.7 1.6 1.6 1.6zm0 .9c-1.4 0-2.5-1.1-2.5-2.5s1.1-2.5 2.5-2.5 2.5 1.1 2.5 2.5-1.1 2.5-2.5 2.5zm-7-.9c.9 0 1.6-.7 1.6-1.6s-.7-1.6-1.6-1.6-1.6.7-1.6 1.6.7 1.6 1.6 1.6zm0 .9c-1.4 0-2.5-1.1-2.5-2.5s1.1-2.5 2.5-2.5 2.5 1.1 2.5 2.5-1.1 2.5-2.5 2.5zm-7-.9c.9 0 1.6-.7 1.6-1.6s-.7-1.6-1.6-1.6-1.6.7-1.6 1.6.7 1.6 1.6 1.6zm0 .9c-1.4 0-2.5-1.1-2.5-2.5s1.1-2.5 2.5-2.5 2.5 1.1 2.5 2.5-1.1 2.5-2.5 2.5z"></path></svg></span></button></div></div></div></div><div class="u-maxWidth740 u-paddingTop20 u-marginTop20 u-borderTopLightest container u-paddingBottom20 u-xs-paddingBottom10 js-postAttributionFooterContainer"><div class="row js-postFooterInfo"><div class="col u-size12of12"><li class="uiScale uiScale-ui--small uiScale-caption--regular u-block u-paddingBottom18 js-cardUser"><div class="u-marginLeft20 u-floatRight"><span class="followState js-followState" data-user-id="5145b6327de1"><button class="button button--small u-noUserSelect button--withChrome u-baseColor--buttonNormal button--withHover button--unblock js-unblockButton" data-action="sign-up-prompt" data-sign-in-action="toggle-block-user" data-requires-token="true" data-redirect="https://medium.com/@tylerneely/fear-and-loathing-in-lock-free-programming-7158b1cdd50c" data-action-source="footer_card"><span class="button-label  button-defaultState">Blocked</span><span class="button-label button-hoverState">Unblock</span></button><button class="button button--primary button--small u-noUserSelect button--withChrome u-accentColor--buttonNormal button--follow js-followButton" data-action="sign-up-prompt" data-sign-in-action="toggle-subscribe-user" data-requires-token="true" data-redirect="https://medium.com/_/subscribe/user/5145b6327de1" data-action-source="footer_card-5145b6327de1-------------------------follow_footer"><span class="button-label  button-defaultState js-buttonLabel">Follow</span><span class="button-label button-activeState">Following</span></button></span></div><div class="u-tableCell"><a class="link u-baseColor--link avatar" href="https://medium.com/@tylerneely?source=footer_card" title="Go to the profile of Tyler Neely" aria-label="Go to the profile of Tyler Neely" data-action-source="footer_card" data-user-id="5145b6327de1" dir="auto"><img src="./Fear and Loathing in Lock-Free Programming – Tyler Neely – Medium_files/1_O4KHGpH9QQ0mYamqf_76yA(1).jpeg" class="avatar-image avatar-image--small" alt="Go to the profile of Tyler Neely"></a></div><div class="u-tableCell u-verticalAlignMiddle u-breakWord u-paddingLeft15"><h3 class="ui-h3 u-fontSize18 u-lineHeightTighter u-marginBottom4"><a class="link link--primary u-accentColor--hoverTextNormal" href="https://medium.com/@tylerneely" property="cc:attributionName" title="Go to the profile of Tyler Neely" aria-label="Go to the profile of Tyler Neely" rel="author cc:attributionUrl" data-user-id="5145b6327de1" dir="auto">Tyler Neely</a></h3><p class="ui-body u-fontSize14 u-lineHeightBaseSans u-textColorDark u-marginBottom4">webmaster <a rel="nofollow" href="http://tylerneely.com/">http://tylerneely.com</a></p></div></li></div></div></div><div class="js-postFooterPlacements" data-post-id="7158b1cdd50c" data-scroll="native"><div class="streamItem streamItem--placementCardGrid js-streamItem"><div class="u-clearfix u-backgroundGrayLightest"><div class="row u-marginAuto u-maxWidth1032 u-paddingTop30 u-paddingBottom40"><div class="col u-padding8 u-xs-size12of12 u-size4of12"><div class="uiScale uiScale-ui--small uiScale-caption--regular u-height280 u-width100pct u-backgroundWhite u-borderCardBorder u-boxShadow u-borderBox u-borderRadius4 js-trackPostPresentation" data-post-id="1c2471c2d139" data-source="placement_card_footer_grid---------0-60" data-tracking-context="placement" data-scroll="native"><a class="link link--noUnderline u-baseColor--link" href="https://medium.com/pinterest-engineering/a-pinterest-engineering-guide-to-technical-interviews-1c2471c2d139?source=placement_card_footer_grid---------0-60" data-action-source="placement_card_footer_grid---------0-60"><div class="u-backgroundCover u-backgroundColorGrayLight u-height100 u-width100pct u-borderBottomLight u-borderRadiusTop4" style="background-image: url(&quot;https://cdn-images-1.medium.com/fit/c/800/240/1*VfU3a9D7YjvSrxWBKBI9yg.jpeg&quot;); background-position: 50% 50% !important;"></div></a><div class="u-padding15 u-borderBox u-flexColumn u-height180"><a class="link link--noUnderline u-baseColor--link u-flex1" href="https://medium.com/pinterest-engineering/a-pinterest-engineering-guide-to-technical-interviews-1c2471c2d139?source=placement_card_footer_grid---------0-60" data-action-source="placement_card_footer_grid---------0-60"><div class="uiScale uiScale-ui--regular uiScale-caption--small u-textColorNormal u-marginBottom7">Related reads</div><div class="ui-h3 ui-clamp2 u-textColorDarkest u-contentSansBold u-fontSize24 u-maxHeight2LineHeightTighter u-lineClamp2 u-textOverflowEllipsis u-letterSpacingTight u-paddingBottom2">A Pinterest Engineering guide to technical interviews</div></a><div class="u-paddingBottom10 u-flex0 u-flexCenter"><div class="u-flex1 u-minWidth0 u-marginRight10"><div class="u-flexCenter"><div class="postMetaInline-avatar u-flex0"><a class="link u-baseColor--link avatar" href="https://medium.com/@Pinterest_Engineering" data-action="show-user-card" data-action-value="ef81ef829bcb" data-action-type="hover" data-user-id="ef81ef829bcb" dir="auto"><img src="./Fear and Loathing in Lock-Free Programming – Tyler Neely – Medium_files/1_FNWs-r9nA_QNtBbYvUkAtg.png" class="avatar-image u-size36x36 u-xs-size32x32" alt="Go to the profile of Pinterest Engineering"></a></div><div class="postMetaInline postMetaInline-authorLockup ui-captionStrong u-flex1 u-noWrapWithEllipsis"><a class="ds-link ds-link--styleSubtle link link--darken link--darker" href="https://medium.com/@Pinterest_Engineering?source=placement_card_footer_grid---------0-60" data-action="show-user-card" data-action-source="placement_card_footer_grid---------0-60" data-action-value="ef81ef829bcb" data-action-type="hover" data-user-id="ef81ef829bcb" dir="auto">Pinterest Engineering</a><div class="ui-caption u-fontSize12 u-baseColor--textNormal u-textColorNormal js-postMetaInlineSupplemental"><a class="link link--darken" href="https://medium.com/pinterest-engineering/a-pinterest-engineering-guide-to-technical-interviews-1c2471c2d139?source=placement_card_footer_grid---------0-60" data-action="open-post" data-action-value="https://medium.com/pinterest-engineering/a-pinterest-engineering-guide-to-technical-interviews-1c2471c2d139?source=placement_card_footer_grid---------0-60" data-action-source="preview-listing"><time datetime="2018-09-14T18:33:57.201Z">Sep 14, 2018</time></a><span class="middotDivider u-fontSize12"></span><span class="readingTime" title="8 min read"></span></div></div></div></div><div class="u-flex0 u-flexCenter"><div class="buttonSet"><div class="multirecommend js-actionMultirecommend u-flexCenter" data-post-id="1c2471c2d139" data-is-label-padded="true" data-source="placement_card_footer_grid-----1c2471c2d139----0-60----------------clap_preview"><div class="u-relative u-foreground"><button class="button button--primary button--chromeless u-accentColor--buttonNormal button--withIcon button--withSvgIcon clapButton js-actionMultirecommendButton clapButton--darker" data-action="sign-up-prompt" data-sign-in-action="multivote" data-requires-token="true" data-redirect="https://medium.com/_/vote/p/1c2471c2d139" data-action-source="placement_card_footer_grid-----1c2471c2d139----0-60----------------clap_preview" aria-label="Clap"><span class="button-defaultState"><span class="svgIcon svgIcon--clap svgIcon--25px"><svg class="svgIcon-use" width="25" height="25"><g fill-rule="evenodd"><path d="M11.739 0l.761 2.966L13.261 0z"></path><path d="M14.815 3.776l1.84-2.551-1.43-.471z"></path><path d="M8.378 1.224l1.84 2.551L9.81.753z"></path><path d="M20.382 21.622c-1.04 1.04-2.115 1.507-3.166 1.608.168-.14.332-.29.492-.45 2.885-2.886 3.456-5.982 1.69-9.211l-1.101-1.937-.955-2.02c-.315-.676-.235-1.185.245-1.556a.836.836 0 0 1 .66-.16c.342.056.66.28.879.605l2.856 5.023c1.179 1.962 1.379 5.119-1.6 8.098m-13.29-.528l-5.02-5.02a1 1 0 0 1 .707-1.701c.255 0 .512.098.707.292l2.607 2.607a.442.442 0 0 0 .624-.624L4.11 14.04l-1.75-1.75a.998.998 0 1 1 1.41-1.413l4.154 4.156a.44.44 0 0 0 .624 0 .44.44 0 0 0 0-.624l-4.152-4.153-1.172-1.171a.998.998 0 0 1 0-1.41 1.018 1.018 0 0 1 1.41 0l1.172 1.17 4.153 4.152a.437.437 0 0 0 .624 0 .442.442 0 0 0 0-.624L6.43 8.222a.988.988 0 0 1-.291-.705.99.99 0 0 1 .29-.706 1 1 0 0 1 1.412 0l6.992 6.993a.443.443 0 0 0 .71-.501l-1.35-2.856c-.315-.676-.235-1.185.246-1.557a.85.85 0 0 1 .66-.16c.342.056.659.28.879.606L18.628 14c1.573 2.876 1.067 5.545-1.544 8.156-1.396 1.397-3.144 1.966-5.063 1.652-1.713-.286-3.463-1.248-4.928-2.714zM10.99 5.976l2.562 2.562c-.497.607-.563 1.414-.155 2.284l.265.562-4.257-4.257a.98.98 0 0 1-.117-.445c0-.267.104-.517.292-.706a1.023 1.023 0 0 1 1.41 0zm8.887 2.06c-.375-.557-.902-.916-1.486-1.011a1.738 1.738 0 0 0-1.342.332c-.376.29-.61.656-.712 1.065a2.1 2.1 0 0 0-1.095-.562 1.776 1.776 0 0 0-.992.128l-2.636-2.636a1.883 1.883 0 0 0-2.658 0 1.862 1.862 0 0 0-.478.847 1.886 1.886 0 0 0-2.671-.012 1.867 1.867 0 0 0-.503.909c-.754-.754-1.992-.754-2.703-.044a1.881 1.881 0 0 0 0 2.658c-.288.12-.605.288-.864.547a1.884 1.884 0 0 0 0 2.659l.624.622a1.879 1.879 0 0 0-.91 3.16l5.019 5.02c1.595 1.594 3.515 2.645 5.408 2.959a7.16 7.16 0 0 0 1.173.098c1.026 0 1.997-.24 2.892-.7.279.04.555.065.828.065 1.53 0 2.969-.628 4.236-1.894 3.338-3.338 3.083-6.928 1.738-9.166l-2.868-5.043z"></path></g></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--clapFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25"><g fill-rule="evenodd"><path d="M11.738 0l.762 2.966L13.262 0z"></path><path d="M16.634 1.224l-1.432-.47-.408 3.022z"></path><path d="M9.79.754l-1.431.47 1.84 2.552z"></path><path d="M22.472 13.307l-3.023-5.32c-.287-.426-.689-.705-1.123-.776a1.16 1.16 0 0 0-.911.221c-.297.231-.474.515-.535.84.017.022.036.04.053.063l2.843 5.001c1.95 3.564 1.328 6.973-1.843 10.144a8.46 8.46 0 0 1-.549.501c1.205-.156 2.328-.737 3.351-1.76 3.268-3.268 3.041-6.749 1.737-8.914"></path><path d="M12.58 9.887c-.156-.83.096-1.569.692-2.142L10.78 5.252c-.5-.504-1.378-.504-1.879 0-.178.18-.273.4-.329.63l4.008 4.005z"></path><path d="M15.812 9.04c-.218-.323-.539-.55-.88-.606a.814.814 0 0 0-.644.153c-.176.137-.713.553-.24 1.566l1.43 3.025a.539.539 0 1 1-.868.612L7.2 6.378a.986.986 0 1 0-1.395 1.395l4.401 4.403a.538.538 0 1 1-.762.762L5.046 8.54 3.802 7.295a.99.99 0 0 0-1.396 0 .981.981 0 0 0 0 1.394L3.647 9.93l4.402 4.403a.537.537 0 0 1 0 .761.535.535 0 0 1-.762 0L2.89 10.696a.992.992 0 0 0-1.399-.003.983.983 0 0 0 0 1.395l1.855 1.854 2.763 2.765a.538.538 0 0 1-.76.761l-2.765-2.764a.982.982 0 0 0-1.395 0 .989.989 0 0 0 0 1.395l5.32 5.32c3.371 3.372 6.64 4.977 10.49 1.126C19.74 19.8 20.271 17 18.62 13.982L15.812 9.04z"></path></g></svg></span></span></button></div><span class="u-relative u-background js-actionMultirecommendCount u-marginLeft5"><button class="button button--chromeless u-baseColor--buttonNormal js-multirecommendCountButton u-disablePointerEvents u-marginLeft4" data-action="show-recommends" data-action-value="1c2471c2d139">893</button></span></div></div><div class="u-height20 u-borderRightLighter u-inlineBlock u-relative u-marginRight10 u-marginLeft12"></div><div class="buttonSet"><button class="button button--chromeless is-touchIconFadeInPulse u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--bookmark js-bookmarkButton" title="Bookmark this story to read later" aria-label="Bookmark this story to read later" data-action="sign-up-prompt" data-sign-in-action="add-to-bookmarks" data-requires-token="true" data-redirect="https://medium.com/_/bookmark/p/1c2471c2d139" data-action-source="placement_card_footer_grid-----1c2471c2d139----0-60----------------bookmark_preview"><span class="button-defaultState"><span class="svgIcon svgIcon--bookmark svgIcon--25px"><svg class="svgIcon-use" width="25" height="25"><path d="M19 6c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v14.66h.012c.01.103.045.204.12.285a.5.5 0 0 0 .706.03L12.5 16.85l5.662 4.126a.508.508 0 0 0 .708-.03.5.5 0 0 0 .118-.285H19V6zm-6.838 9.97L7 19.636V6c0-.55.45-1 1-1h9c.55 0 1 .45 1 1v13.637l-5.162-3.668a.49.49 0 0 0-.676 0z" fill-rule="evenodd"></path></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--bookmarkFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25"><path d="M19 6c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v14.66h.012c.01.103.045.204.12.285a.5.5 0 0 0 .706.03L12.5 16.85l5.662 4.126c.205.183.52.17.708-.03a.5.5 0 0 0 .118-.285H19V6z"></path></svg></span></span></button></div></div></div></div></div></div><div class="col u-padding8 u-xs-size12of12 u-size4of12"><div class="uiScale uiScale-ui--small uiScale-caption--regular u-height280 u-width100pct u-backgroundWhite u-borderCardBorder u-boxShadow u-borderBox u-borderRadius4 js-trackPostPresentation" data-post-id="fe038d59fff2" data-source="placement_card_footer_grid---------1-60" data-tracking-context="placement" data-scroll="native"><a class="link link--noUnderline u-baseColor--link" href="https://blog.ably.io/how-to-implement-consistent-hashing-efficiently-fe038d59fff2?source=placement_card_footer_grid---------1-60" data-action-source="placement_card_footer_grid---------1-60"><div class="u-backgroundCover u-backgroundColorGrayLight u-height100 u-width100pct u-borderBottomLight u-borderRadiusTop4" style="background-image: url(&quot;https://cdn-images-1.medium.com/fit/c/800/240/1*59Mn6sT0Wu7qQJmX1FOhtw.png&quot;); background-position: 50% 50% !important;"></div></a><div class="u-padding15 u-borderBox u-flexColumn u-height180"><a class="link link--noUnderline u-baseColor--link u-flex1" href="https://blog.ably.io/how-to-implement-consistent-hashing-efficiently-fe038d59fff2?source=placement_card_footer_grid---------1-60" data-action-source="placement_card_footer_grid---------1-60"><div class="uiScale uiScale-ui--regular uiScale-caption--small u-textColorNormal u-marginBottom7">Related reads</div><div class="ui-h3 ui-clamp2 u-textColorDarkest u-contentSansBold u-fontSize24 u-maxHeight2LineHeightTighter u-lineClamp2 u-textOverflowEllipsis u-letterSpacingTight u-paddingBottom2">How we implemented consistent hashing efficiently</div></a><div class="u-paddingBottom10 u-flex0 u-flexCenter"><div class="u-flex1 u-minWidth0 u-marginRight10"><div class="u-flexCenter"><div class="postMetaInline-avatar u-flex0"><a class="link u-baseColor--link avatar" href="https://blog.ably.io/@n.srushtika" data-action="show-user-card" data-action-value="c257080c3843" data-action-type="hover" data-user-id="c257080c3843" data-collection-slug="ably-simply-better-realtime" dir="auto"><img src="./Fear and Loathing in Lock-Free Programming – Tyler Neely – Medium_files/1__mV9ia0k7MiWxILUAzg69Q.jpeg" class="avatar-image u-size36x36 u-xs-size32x32" alt="Go to the profile of Srushtika Neelakantam"></a></div><div class="postMetaInline postMetaInline-authorLockup ui-captionStrong u-flex1 u-noWrapWithEllipsis"><a class="ds-link ds-link--styleSubtle link link--darken link--darker" href="https://blog.ably.io/@n.srushtika?source=placement_card_footer_grid---------1-60" data-action="show-user-card" data-action-source="placement_card_footer_grid---------1-60" data-action-value="c257080c3843" data-action-type="hover" data-user-id="c257080c3843" data-collection-slug="ably-simply-better-realtime" dir="auto">Srushtika Neelakantam</a><div class="ui-caption u-fontSize12 u-baseColor--textNormal u-textColorNormal js-postMetaInlineSupplemental"><a class="link link--darken" href="https://blog.ably.io/how-to-implement-consistent-hashing-efficiently-fe038d59fff2?source=placement_card_footer_grid---------1-60" data-action="open-post" data-action-value="https://blog.ably.io/how-to-implement-consistent-hashing-efficiently-fe038d59fff2?source=placement_card_footer_grid---------1-60" data-action-source="preview-listing"><time datetime="2018-06-19T08:31:35.921Z">Jun 19, 2018</time></a><span class="middotDivider u-fontSize12"></span><span class="readingTime" title="12 min read"></span></div></div></div></div><div class="u-flex0 u-flexCenter"><div class="buttonSet"><div class="multirecommend js-actionMultirecommend u-flexCenter" data-post-id="fe038d59fff2" data-is-label-padded="true" data-source="placement_card_footer_grid-----fe038d59fff2----1-60----------------clap_preview"><div class="u-relative u-foreground"><button class="button button--primary button--chromeless u-accentColor--buttonNormal button--withIcon button--withSvgIcon clapButton js-actionMultirecommendButton clapButton--darker" data-action="sign-up-prompt" data-sign-in-action="multivote" data-requires-token="true" data-redirect="https://medium.com/_/vote/p/fe038d59fff2" data-action-source="placement_card_footer_grid-----fe038d59fff2----1-60----------------clap_preview" aria-label="Clap"><span class="button-defaultState"><span class="svgIcon svgIcon--clap svgIcon--25px"><svg class="svgIcon-use" width="25" height="25"><g fill-rule="evenodd"><path d="M11.739 0l.761 2.966L13.261 0z"></path><path d="M14.815 3.776l1.84-2.551-1.43-.471z"></path><path d="M8.378 1.224l1.84 2.551L9.81.753z"></path><path d="M20.382 21.622c-1.04 1.04-2.115 1.507-3.166 1.608.168-.14.332-.29.492-.45 2.885-2.886 3.456-5.982 1.69-9.211l-1.101-1.937-.955-2.02c-.315-.676-.235-1.185.245-1.556a.836.836 0 0 1 .66-.16c.342.056.66.28.879.605l2.856 5.023c1.179 1.962 1.379 5.119-1.6 8.098m-13.29-.528l-5.02-5.02a1 1 0 0 1 .707-1.701c.255 0 .512.098.707.292l2.607 2.607a.442.442 0 0 0 .624-.624L4.11 14.04l-1.75-1.75a.998.998 0 1 1 1.41-1.413l4.154 4.156a.44.44 0 0 0 .624 0 .44.44 0 0 0 0-.624l-4.152-4.153-1.172-1.171a.998.998 0 0 1 0-1.41 1.018 1.018 0 0 1 1.41 0l1.172 1.17 4.153 4.152a.437.437 0 0 0 .624 0 .442.442 0 0 0 0-.624L6.43 8.222a.988.988 0 0 1-.291-.705.99.99 0 0 1 .29-.706 1 1 0 0 1 1.412 0l6.992 6.993a.443.443 0 0 0 .71-.501l-1.35-2.856c-.315-.676-.235-1.185.246-1.557a.85.85 0 0 1 .66-.16c.342.056.659.28.879.606L18.628 14c1.573 2.876 1.067 5.545-1.544 8.156-1.396 1.397-3.144 1.966-5.063 1.652-1.713-.286-3.463-1.248-4.928-2.714zM10.99 5.976l2.562 2.562c-.497.607-.563 1.414-.155 2.284l.265.562-4.257-4.257a.98.98 0 0 1-.117-.445c0-.267.104-.517.292-.706a1.023 1.023 0 0 1 1.41 0zm8.887 2.06c-.375-.557-.902-.916-1.486-1.011a1.738 1.738 0 0 0-1.342.332c-.376.29-.61.656-.712 1.065a2.1 2.1 0 0 0-1.095-.562 1.776 1.776 0 0 0-.992.128l-2.636-2.636a1.883 1.883 0 0 0-2.658 0 1.862 1.862 0 0 0-.478.847 1.886 1.886 0 0 0-2.671-.012 1.867 1.867 0 0 0-.503.909c-.754-.754-1.992-.754-2.703-.044a1.881 1.881 0 0 0 0 2.658c-.288.12-.605.288-.864.547a1.884 1.884 0 0 0 0 2.659l.624.622a1.879 1.879 0 0 0-.91 3.16l5.019 5.02c1.595 1.594 3.515 2.645 5.408 2.959a7.16 7.16 0 0 0 1.173.098c1.026 0 1.997-.24 2.892-.7.279.04.555.065.828.065 1.53 0 2.969-.628 4.236-1.894 3.338-3.338 3.083-6.928 1.738-9.166l-2.868-5.043z"></path></g></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--clapFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25"><g fill-rule="evenodd"><path d="M11.738 0l.762 2.966L13.262 0z"></path><path d="M16.634 1.224l-1.432-.47-.408 3.022z"></path><path d="M9.79.754l-1.431.47 1.84 2.552z"></path><path d="M22.472 13.307l-3.023-5.32c-.287-.426-.689-.705-1.123-.776a1.16 1.16 0 0 0-.911.221c-.297.231-.474.515-.535.84.017.022.036.04.053.063l2.843 5.001c1.95 3.564 1.328 6.973-1.843 10.144a8.46 8.46 0 0 1-.549.501c1.205-.156 2.328-.737 3.351-1.76 3.268-3.268 3.041-6.749 1.737-8.914"></path><path d="M12.58 9.887c-.156-.83.096-1.569.692-2.142L10.78 5.252c-.5-.504-1.378-.504-1.879 0-.178.18-.273.4-.329.63l4.008 4.005z"></path><path d="M15.812 9.04c-.218-.323-.539-.55-.88-.606a.814.814 0 0 0-.644.153c-.176.137-.713.553-.24 1.566l1.43 3.025a.539.539 0 1 1-.868.612L7.2 6.378a.986.986 0 1 0-1.395 1.395l4.401 4.403a.538.538 0 1 1-.762.762L5.046 8.54 3.802 7.295a.99.99 0 0 0-1.396 0 .981.981 0 0 0 0 1.394L3.647 9.93l4.402 4.403a.537.537 0 0 1 0 .761.535.535 0 0 1-.762 0L2.89 10.696a.992.992 0 0 0-1.399-.003.983.983 0 0 0 0 1.395l1.855 1.854 2.763 2.765a.538.538 0 0 1-.76.761l-2.765-2.764a.982.982 0 0 0-1.395 0 .989.989 0 0 0 0 1.395l5.32 5.32c3.371 3.372 6.64 4.977 10.49 1.126C19.74 19.8 20.271 17 18.62 13.982L15.812 9.04z"></path></g></svg></span></span></button></div><span class="u-relative u-background js-actionMultirecommendCount u-marginLeft5"><button class="button button--chromeless u-baseColor--buttonNormal js-multirecommendCountButton u-disablePointerEvents u-marginLeft4" data-action="show-recommends" data-action-value="fe038d59fff2">533</button></span></div></div><div class="u-height20 u-borderRightLighter u-inlineBlock u-relative u-marginRight10 u-marginLeft12"></div><div class="buttonSet"><button class="button button--chromeless is-touchIconFadeInPulse u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--bookmark js-bookmarkButton" title="Bookmark this story to read later" aria-label="Bookmark this story to read later" data-action="sign-up-prompt" data-sign-in-action="add-to-bookmarks" data-requires-token="true" data-redirect="https://medium.com/_/bookmark/p/fe038d59fff2" data-action-source="placement_card_footer_grid-----fe038d59fff2----1-60----------------bookmark_preview"><span class="button-defaultState"><span class="svgIcon svgIcon--bookmark svgIcon--25px"><svg class="svgIcon-use" width="25" height="25"><path d="M19 6c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v14.66h.012c.01.103.045.204.12.285a.5.5 0 0 0 .706.03L12.5 16.85l5.662 4.126a.508.508 0 0 0 .708-.03.5.5 0 0 0 .118-.285H19V6zm-6.838 9.97L7 19.636V6c0-.55.45-1 1-1h9c.55 0 1 .45 1 1v13.637l-5.162-3.668a.49.49 0 0 0-.676 0z" fill-rule="evenodd"></path></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--bookmarkFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25"><path d="M19 6c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v14.66h.012c.01.103.045.204.12.285a.5.5 0 0 0 .706.03L12.5 16.85l5.662 4.126c.205.183.52.17.708-.03a.5.5 0 0 0 .118-.285H19V6z"></path></svg></span></span></button></div></div></div></div></div></div><div class="col u-padding8 u-xs-size12of12 u-size4of12"><div class="uiScale uiScale-ui--small uiScale-caption--regular u-height280 u-width100pct u-backgroundWhite u-borderCardBorder u-boxShadow u-borderBox u-borderRadius4 js-trackPostPresentation" data-post-id="67c3ce17417b" data-source="placement_card_footer_grid---------2-60" data-tracking-context="placement" data-scroll="native"><a class="link link--noUnderline u-baseColor--link" href="https://medium.com/techlog/chord-building-a-dht-distributed-hash-table-in-golang-67c3ce17417b?source=placement_card_footer_grid---------2-60" data-action-source="placement_card_footer_grid---------2-60"><div class="u-backgroundCover u-backgroundColorGrayLight u-height100 u-width100pct u-borderBottomLight u-borderRadiusTop4" style="background-image: url(&quot;https://cdn-images-1.medium.com/fit/c/800/240/0*XV4B_fIkmiIU7Gbp.png&quot;); background-position: 50% 50% !important;"></div></a><div class="u-padding15 u-borderBox u-flexColumn u-height180"><a class="link link--noUnderline u-baseColor--link u-flex1" href="https://medium.com/techlog/chord-building-a-dht-distributed-hash-table-in-golang-67c3ce17417b?source=placement_card_footer_grid---------2-60" data-action-source="placement_card_footer_grid---------2-60"><div class="uiScale uiScale-ui--regular uiScale-caption--small u-textColorNormal u-marginBottom7">Related reads</div><div class="ui-h3 ui-clamp2 u-textColorDarkest u-contentSansBold u-fontSize24 u-maxHeight2LineHeightTighter u-lineClamp2 u-textOverflowEllipsis u-letterSpacingTight u-paddingBottom2">Chord: Building a DHT (Distributed Hash Table) in Golang</div></a><div class="u-paddingBottom10 u-flex0 u-flexCenter"><div class="u-flex1 u-minWidth0 u-marginRight10"><div class="u-flexCenter"><div class="postMetaInline-avatar u-flex0"><a class="link u-baseColor--link avatar" href="https://medium.com/@arriqaaq" data-action="show-user-card" data-action-value="c10865a85ff7" data-action-type="hover" data-user-id="c10865a85ff7" dir="auto"><div class="u-relative u-inlineBlock u-flex0"><img src="./Fear and Loathing in Lock-Free Programming – Tyler Neely – Medium_files/0_HGAfdfyDuINjMw1u.jpg" class="avatar-image u-size36x36 u-xs-size32x32" alt="Go to the profile of Farhan Ali Khan"><div class="avatar-halo u-absolute u-textColorGreenNormal svgIcon" style="width: calc(100% + 10px); height: calc(100% + 10px); top:-5px; left:-5px"><svg viewBox="0 0 40 40" xmlns="http://www.w3.org/2000/svg"><path d="M3.44615311,11.6601601 C6.57294867,5.47967718 12.9131553,1.5 19.9642857,1.5 C27.0154162,1.5 33.3556228,5.47967718 36.4824183,11.6601601 L37.3747245,11.2087295 C34.0793076,4.69494641 27.3961457,0.5 19.9642857,0.5 C12.5324257,0.5 5.84926381,4.69494641 2.55384689,11.2087295 L3.44615311,11.6601601 Z"></path><path d="M36.4824183,28.2564276 C33.3556228,34.4369105 27.0154162,38.4165876 19.9642857,38.4165876 C12.9131553,38.4165876 6.57294867,34.4369105 3.44615311,28.2564276 L2.55384689,28.7078582 C5.84926381,35.2216412 12.5324257,39.4165876 19.9642857,39.4165876 C27.3961457,39.4165876 34.0793076,35.2216412 37.3747245,28.7078582 L36.4824183,28.2564276 Z"></path></svg></div></div></a></div><div class="postMetaInline postMetaInline-authorLockup ui-captionStrong u-flex1 u-noWrapWithEllipsis"><a class="ds-link ds-link--styleSubtle link link--darken link--darker" href="https://medium.com/@arriqaaq?source=placement_card_footer_grid---------2-60" data-action="show-user-card" data-action-source="placement_card_footer_grid---------2-60" data-action-value="c10865a85ff7" data-action-type="hover" data-user-id="c10865a85ff7" dir="auto">Farhan Ali Khan</a><div class="ui-caption u-fontSize12 u-baseColor--textNormal u-textColorNormal js-postMetaInlineSupplemental"><a class="link link--darken" href="https://medium.com/techlog/chord-building-a-dht-distributed-hash-table-in-golang-67c3ce17417b?source=placement_card_footer_grid---------2-60" data-action="open-post" data-action-value="https://medium.com/techlog/chord-building-a-dht-distributed-hash-table-in-golang-67c3ce17417b?source=placement_card_footer_grid---------2-60" data-action-source="preview-listing"><time datetime="2018-09-11T10:33:27.173Z">Sep 11, 2018</time></a><span class="middotDivider u-fontSize12"></span><span class="readingTime" title="5 min read"></span></div></div></div></div><div class="u-flex0 u-flexCenter"><div class="buttonSet"><div class="multirecommend js-actionMultirecommend u-flexCenter" data-post-id="67c3ce17417b" data-is-label-padded="true" data-source="placement_card_footer_grid-----67c3ce17417b----2-60----------------clap_preview"><div class="u-relative u-foreground"><button class="button button--primary button--chromeless u-accentColor--buttonNormal button--withIcon button--withSvgIcon clapButton js-actionMultirecommendButton clapButton--darker" data-action="sign-up-prompt" data-sign-in-action="multivote" data-requires-token="true" data-redirect="https://medium.com/_/vote/p/67c3ce17417b" data-action-source="placement_card_footer_grid-----67c3ce17417b----2-60----------------clap_preview" aria-label="Clap"><span class="button-defaultState"><span class="svgIcon svgIcon--clap svgIcon--25px"><svg class="svgIcon-use" width="25" height="25"><g fill-rule="evenodd"><path d="M11.739 0l.761 2.966L13.261 0z"></path><path d="M14.815 3.776l1.84-2.551-1.43-.471z"></path><path d="M8.378 1.224l1.84 2.551L9.81.753z"></path><path d="M20.382 21.622c-1.04 1.04-2.115 1.507-3.166 1.608.168-.14.332-.29.492-.45 2.885-2.886 3.456-5.982 1.69-9.211l-1.101-1.937-.955-2.02c-.315-.676-.235-1.185.245-1.556a.836.836 0 0 1 .66-.16c.342.056.66.28.879.605l2.856 5.023c1.179 1.962 1.379 5.119-1.6 8.098m-13.29-.528l-5.02-5.02a1 1 0 0 1 .707-1.701c.255 0 .512.098.707.292l2.607 2.607a.442.442 0 0 0 .624-.624L4.11 14.04l-1.75-1.75a.998.998 0 1 1 1.41-1.413l4.154 4.156a.44.44 0 0 0 .624 0 .44.44 0 0 0 0-.624l-4.152-4.153-1.172-1.171a.998.998 0 0 1 0-1.41 1.018 1.018 0 0 1 1.41 0l1.172 1.17 4.153 4.152a.437.437 0 0 0 .624 0 .442.442 0 0 0 0-.624L6.43 8.222a.988.988 0 0 1-.291-.705.99.99 0 0 1 .29-.706 1 1 0 0 1 1.412 0l6.992 6.993a.443.443 0 0 0 .71-.501l-1.35-2.856c-.315-.676-.235-1.185.246-1.557a.85.85 0 0 1 .66-.16c.342.056.659.28.879.606L18.628 14c1.573 2.876 1.067 5.545-1.544 8.156-1.396 1.397-3.144 1.966-5.063 1.652-1.713-.286-3.463-1.248-4.928-2.714zM10.99 5.976l2.562 2.562c-.497.607-.563 1.414-.155 2.284l.265.562-4.257-4.257a.98.98 0 0 1-.117-.445c0-.267.104-.517.292-.706a1.023 1.023 0 0 1 1.41 0zm8.887 2.06c-.375-.557-.902-.916-1.486-1.011a1.738 1.738 0 0 0-1.342.332c-.376.29-.61.656-.712 1.065a2.1 2.1 0 0 0-1.095-.562 1.776 1.776 0 0 0-.992.128l-2.636-2.636a1.883 1.883 0 0 0-2.658 0 1.862 1.862 0 0 0-.478.847 1.886 1.886 0 0 0-2.671-.012 1.867 1.867 0 0 0-.503.909c-.754-.754-1.992-.754-2.703-.044a1.881 1.881 0 0 0 0 2.658c-.288.12-.605.288-.864.547a1.884 1.884 0 0 0 0 2.659l.624.622a1.879 1.879 0 0 0-.91 3.16l5.019 5.02c1.595 1.594 3.515 2.645 5.408 2.959a7.16 7.16 0 0 0 1.173.098c1.026 0 1.997-.24 2.892-.7.279.04.555.065.828.065 1.53 0 2.969-.628 4.236-1.894 3.338-3.338 3.083-6.928 1.738-9.166l-2.868-5.043z"></path></g></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--clapFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25"><g fill-rule="evenodd"><path d="M11.738 0l.762 2.966L13.262 0z"></path><path d="M16.634 1.224l-1.432-.47-.408 3.022z"></path><path d="M9.79.754l-1.431.47 1.84 2.552z"></path><path d="M22.472 13.307l-3.023-5.32c-.287-.426-.689-.705-1.123-.776a1.16 1.16 0 0 0-.911.221c-.297.231-.474.515-.535.84.017.022.036.04.053.063l2.843 5.001c1.95 3.564 1.328 6.973-1.843 10.144a8.46 8.46 0 0 1-.549.501c1.205-.156 2.328-.737 3.351-1.76 3.268-3.268 3.041-6.749 1.737-8.914"></path><path d="M12.58 9.887c-.156-.83.096-1.569.692-2.142L10.78 5.252c-.5-.504-1.378-.504-1.879 0-.178.18-.273.4-.329.63l4.008 4.005z"></path><path d="M15.812 9.04c-.218-.323-.539-.55-.88-.606a.814.814 0 0 0-.644.153c-.176.137-.713.553-.24 1.566l1.43 3.025a.539.539 0 1 1-.868.612L7.2 6.378a.986.986 0 1 0-1.395 1.395l4.401 4.403a.538.538 0 1 1-.762.762L5.046 8.54 3.802 7.295a.99.99 0 0 0-1.396 0 .981.981 0 0 0 0 1.394L3.647 9.93l4.402 4.403a.537.537 0 0 1 0 .761.535.535 0 0 1-.762 0L2.89 10.696a.992.992 0 0 0-1.399-.003.983.983 0 0 0 0 1.395l1.855 1.854 2.763 2.765a.538.538 0 0 1-.76.761l-2.765-2.764a.982.982 0 0 0-1.395 0 .989.989 0 0 0 0 1.395l5.32 5.32c3.371 3.372 6.64 4.977 10.49 1.126C19.74 19.8 20.271 17 18.62 13.982L15.812 9.04z"></path></g></svg></span></span></button></div><span class="u-relative u-background js-actionMultirecommendCount u-marginLeft5"><button class="button button--chromeless u-baseColor--buttonNormal js-multirecommendCountButton u-disablePointerEvents u-marginLeft4" data-action="show-recommends" data-action-value="67c3ce17417b">494</button></span></div></div><div class="u-height20 u-borderRightLighter u-inlineBlock u-relative u-marginRight10 u-marginLeft12"></div><div class="buttonSet"><button class="button button--chromeless is-touchIconFadeInPulse u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--bookmark js-bookmarkButton" title="Bookmark this story to read later" aria-label="Bookmark this story to read later" data-action="sign-up-prompt" data-sign-in-action="add-to-bookmarks" data-requires-token="true" data-redirect="https://medium.com/_/bookmark/p/67c3ce17417b" data-action-source="placement_card_footer_grid-----67c3ce17417b----2-60----------------bookmark_preview"><span class="button-defaultState"><span class="svgIcon svgIcon--bookmark svgIcon--25px"><svg class="svgIcon-use" width="25" height="25"><path d="M19 6c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v14.66h.012c.01.103.045.204.12.285a.5.5 0 0 0 .706.03L12.5 16.85l5.662 4.126a.508.508 0 0 0 .708-.03.5.5 0 0 0 .118-.285H19V6zm-6.838 9.97L7 19.636V6c0-.55.45-1 1-1h9c.55 0 1 .45 1 1v13.637l-5.162-3.668a.49.49 0 0 0-.676 0z" fill-rule="evenodd"></path></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--bookmarkFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25"><path d="M19 6c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v14.66h.012c.01.103.045.204.12.285a.5.5 0 0 0 .706.03L12.5 16.85l5.662 4.126c.205.183.52.17.708-.03a.5.5 0 0 0 .118-.285H19V6z"></path></svg></span></span></button></div></div></div></div></div></div></div></div></div></div><div class="u-padding0 u-clearfix u-backgroundGrayLightest u-print-hide supplementalPostContent js-responsesWrapper" data-action-scope="_actionscope_5"><div class="container u-maxWidth740"><div class="responsesStreamWrapper u-maxWidth640 js-responsesStreamWrapper"><div class="container responsesStream-title u-paddingTop15"><div class="row"><header class="heading"><div class="u-clearfix"><div class="heading-content u-floatLeft"><span class="heading-title heading-title--semibold">Responses</span></div></div></header></div></div><div class="responsesStream-editor cardChromeless u-marginBottom20 u-paddingLeft20 u-paddingRight20 js-responsesStreamEditor"><div class="u-paddingTop30 u-paddingBottom30 u-paddingLeft0 u-paddingRight0 u-borderBottomLightest js-responsesLoggedOutPrompt"><button class="button button--chromeless is-touchIconBlackPulse u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--withIconAndLabel button--loggedOutPrompt" data-action="sign-up-prompt" data-redirect="https://medium.com/@tylerneely/fear-and-loathing-in-lock-free-programming-7158b1cdd50c#--respond" data-skip-onboarding="true" data-action-source="logged_out_response_prompt--------------------------respond_box"><span class="svgIcon svgIcon--response svgIcon--29px"><svg class="svgIcon-use" width="29" height="29"><path d="M21.27 20.058c1.89-1.826 2.754-4.17 2.754-6.674C24.024 8.21 19.67 4 14.1 4 8.53 4 4 8.21 4 13.384c0 5.175 4.53 9.385 10.1 9.385 1.007 0 2-.14 2.95-.41.285.25.592.49.918.7 1.306.87 2.716 1.31 4.19 1.31.276-.01.494-.14.6-.36a.625.625 0 0 0-.052-.65c-.61-.84-1.042-1.71-1.282-2.58a5.417 5.417 0 0 1-.154-.75zm-3.85 1.324l-.083-.28-.388.12a9.72 9.72 0 0 1-2.85.424c-4.96 0-8.99-3.706-8.99-8.262 0-4.556 4.03-8.263 8.99-8.263 4.95 0 8.77 3.71 8.77 8.27 0 2.25-.75 4.35-2.5 5.92l-.24.21v.32c0 .07 0 .19.02.37.03.29.1.6.19.92.19.7.49 1.4.89 2.08-.93-.14-1.83-.49-2.67-1.06-.34-.22-.88-.48-1.16-.74z"></path></svg></span><span class="button-label  js-buttonLabel">Write a response…</span></button></div></div><div class="responsesStream js-responsesStream"><div class="streamItem streamItem--conversation js-streamItem" data-action-scope="_actionscope_6"><div class="streamItemConversation"><div class="u-marginLeft20"><div class="streamItemConversation-divider"></div><header class="heading heading--light heading--simple"><div class="u-clearfix"><div class="heading-content u-floatLeft"><span class="heading-title">Conversation between <a class="link link--accent u-accentColor--textNormal u-baseColor--link" href="https://medium.com/@al45tair" data-action="show-user-card" data-action-value="3598d64ae8e1" data-action-type="hover" data-user-id="3598d64ae8e1" dir="auto">Alastair Houghton</a> and <a class="link link--accent u-accentColor--textNormal u-baseColor--link" href="https://medium.com/@tylerneely" data-action="show-user-card" data-action-value="5145b6327de1" data-action-type="hover" data-user-id="5145b6327de1" dir="auto">Tyler Neely</a>.</span></div></div></header></div><div class="streamItemConversation-inner cardChromeless"><div class="streamItemConversationItem streamItemConversationItem--preview"><div class="postArticle js-postArticle js-trackPostPresentation js-trackPostScrolls postArticle--short" data-post-id="4ff144cd3978" data-source="responses---------0---------------------" data-action-scope="_actionscope_7" data-scroll="native"><div class="u-clearfix u-marginBottom15 u-paddingTop5"><div class="postMetaInline u-floatLeft"><div class="u-flexCenter"><div class="postMetaInline-avatar u-flex0"><a class="link u-baseColor--link avatar" href="https://medium.com/@al45tair" data-action="show-user-card" data-action-value="3598d64ae8e1" data-action-type="hover" data-user-id="3598d64ae8e1" dir="auto"><img src="./Fear and Loathing in Lock-Free Programming – Tyler Neely – Medium_files/0_MJ3HgkbA7LL7Dlew.jpg" class="avatar-image u-size36x36 u-xs-size32x32" alt="Go to the profile of Alastair Houghton"></a></div><div class="postMetaInline postMetaInline-authorLockup ui-captionStrong u-flex1 u-noWrapWithEllipsis"><a class="ds-link ds-link--styleSubtle link link--darken link--accent u-accentColor--textNormal u-accentColor--textDarken" href="https://medium.com/@al45tair?source=responses---------0---------------------" data-action="show-user-card" data-action-source="responses---------0---------------------" data-action-value="3598d64ae8e1" data-action-type="hover" data-user-id="3598d64ae8e1" dir="auto">Alastair Houghton</a><div class="ui-caption u-fontSize12 u-baseColor--textNormal u-textColorNormal js-postMetaInlineSupplemental"><a class="link link--darken" href="https://medium.com/@al45tair/there-is-a-hugely-important-aspect-of-lock-free-programming-that-isnt-mentioned-in-this-article-4ff144cd3978?source=responses---------0---------------------" data-action="open-post" data-action-value="https://medium.com/@al45tair/there-is-a-hugely-important-aspect-of-lock-free-programming-that-isnt-mentioned-in-this-article-4ff144cd3978?source=responses---------0---------------------" data-action-source="preview-listing"><time datetime="2017-10-10T07:51:17.734Z">Oct 10, 2017</time></a><span class="middotDivider u-fontSize12"></span><span class="readingTime" title="2 min read"></span></div></div></div></div></div><div class="js-inlineExpandBody"><a class="" href="https://medium.com/@al45tair/there-is-a-hugely-important-aspect-of-lock-free-programming-that-isnt-mentioned-in-this-article-4ff144cd3978?source=responses---------0---------------------" data-action="expand-inline"><div class="postArticle-content js-postField"><section class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><p name="0d3a" id="0d3a" class="graf graf--p graf--leading graf--trailing">There is a <strong class="markup--strong markup--p-strong">hugely</strong> important aspect of lock-free programming that isn’t mentioned in this article, namely the <em class="markup--em markup--p-em">memory model</em> that you’re using. Lock-free algorithms that function perfectly well in one programming language on one microprocessor family may very well fail catastrophically if implemented, otherwise correctly, in another programming language…</p></div></div></section></div></a></div><div class="postArticle-readMore"><button class="button button--smaller button--link u-baseColor--buttonNormal" data-action="expand-inline">Read more…</button></div><div class="u-clearfix u-paddingTop10"><div class="u-floatLeft"><div class="multirecommend js-actionMultirecommend u-flexCenter" data-post-id="4ff144cd3978" data-is-flush-left="true" data-source="listing-----4ff144cd3978---------------------clap_preview"><div class="u-relative u-foreground"><button class="button button--primary button--chromeless u-accentColor--buttonNormal button--withIcon button--withSvgIcon clapButton js-actionMultirecommendButton clapButton--darker" data-action="sign-up-prompt" data-sign-in-action="multivote" data-requires-token="true" data-redirect="https://medium.com/_/vote/p/4ff144cd3978" data-action-source="listing-----4ff144cd3978---------------------clap_preview" aria-label="Clap"><span class="button-defaultState"><span class="svgIcon svgIcon--clap svgIcon--25px is-flushLeft"><svg class="svgIcon-use" width="25" height="25"><g fill-rule="evenodd"><path d="M11.739 0l.761 2.966L13.261 0z"></path><path d="M14.815 3.776l1.84-2.551-1.43-.471z"></path><path d="M8.378 1.224l1.84 2.551L9.81.753z"></path><path d="M20.382 21.622c-1.04 1.04-2.115 1.507-3.166 1.608.168-.14.332-.29.492-.45 2.885-2.886 3.456-5.982 1.69-9.211l-1.101-1.937-.955-2.02c-.315-.676-.235-1.185.245-1.556a.836.836 0 0 1 .66-.16c.342.056.66.28.879.605l2.856 5.023c1.179 1.962 1.379 5.119-1.6 8.098m-13.29-.528l-5.02-5.02a1 1 0 0 1 .707-1.701c.255 0 .512.098.707.292l2.607 2.607a.442.442 0 0 0 .624-.624L4.11 14.04l-1.75-1.75a.998.998 0 1 1 1.41-1.413l4.154 4.156a.44.44 0 0 0 .624 0 .44.44 0 0 0 0-.624l-4.152-4.153-1.172-1.171a.998.998 0 0 1 0-1.41 1.018 1.018 0 0 1 1.41 0l1.172 1.17 4.153 4.152a.437.437 0 0 0 .624 0 .442.442 0 0 0 0-.624L6.43 8.222a.988.988 0 0 1-.291-.705.99.99 0 0 1 .29-.706 1 1 0 0 1 1.412 0l6.992 6.993a.443.443 0 0 0 .71-.501l-1.35-2.856c-.315-.676-.235-1.185.246-1.557a.85.85 0 0 1 .66-.16c.342.056.659.28.879.606L18.628 14c1.573 2.876 1.067 5.545-1.544 8.156-1.396 1.397-3.144 1.966-5.063 1.652-1.713-.286-3.463-1.248-4.928-2.714zM10.99 5.976l2.562 2.562c-.497.607-.563 1.414-.155 2.284l.265.562-4.257-4.257a.98.98 0 0 1-.117-.445c0-.267.104-.517.292-.706a1.023 1.023 0 0 1 1.41 0zm8.887 2.06c-.375-.557-.902-.916-1.486-1.011a1.738 1.738 0 0 0-1.342.332c-.376.29-.61.656-.712 1.065a2.1 2.1 0 0 0-1.095-.562 1.776 1.776 0 0 0-.992.128l-2.636-2.636a1.883 1.883 0 0 0-2.658 0 1.862 1.862 0 0 0-.478.847 1.886 1.886 0 0 0-2.671-.012 1.867 1.867 0 0 0-.503.909c-.754-.754-1.992-.754-2.703-.044a1.881 1.881 0 0 0 0 2.658c-.288.12-.605.288-.864.547a1.884 1.884 0 0 0 0 2.659l.624.622a1.879 1.879 0 0 0-.91 3.16l5.019 5.02c1.595 1.594 3.515 2.645 5.408 2.959a7.16 7.16 0 0 0 1.173.098c1.026 0 1.997-.24 2.892-.7.279.04.555.065.828.065 1.53 0 2.969-.628 4.236-1.894 3.338-3.338 3.083-6.928 1.738-9.166l-2.868-5.043z"></path></g></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--clapFilled svgIcon--25px is-flushLeft"><svg class="svgIcon-use" width="25" height="25"><g fill-rule="evenodd"><path d="M11.738 0l.762 2.966L13.262 0z"></path><path d="M16.634 1.224l-1.432-.47-.408 3.022z"></path><path d="M9.79.754l-1.431.47 1.84 2.552z"></path><path d="M22.472 13.307l-3.023-5.32c-.287-.426-.689-.705-1.123-.776a1.16 1.16 0 0 0-.911.221c-.297.231-.474.515-.535.84.017.022.036.04.053.063l2.843 5.001c1.95 3.564 1.328 6.973-1.843 10.144a8.46 8.46 0 0 1-.549.501c1.205-.156 2.328-.737 3.351-1.76 3.268-3.268 3.041-6.749 1.737-8.914"></path><path d="M12.58 9.887c-.156-.83.096-1.569.692-2.142L10.78 5.252c-.5-.504-1.378-.504-1.879 0-.178.18-.273.4-.329.63l4.008 4.005z"></path><path d="M15.812 9.04c-.218-.323-.539-.55-.88-.606a.814.814 0 0 0-.644.153c-.176.137-.713.553-.24 1.566l1.43 3.025a.539.539 0 1 1-.868.612L7.2 6.378a.986.986 0 1 0-1.395 1.395l4.401 4.403a.538.538 0 1 1-.762.762L5.046 8.54 3.802 7.295a.99.99 0 0 0-1.396 0 .981.981 0 0 0 0 1.394L3.647 9.93l4.402 4.403a.537.537 0 0 1 0 .761.535.535 0 0 1-.762 0L2.89 10.696a.992.992 0 0 0-1.399-.003.983.983 0 0 0 0 1.395l1.855 1.854 2.763 2.765a.538.538 0 0 1-.76.761l-2.765-2.764a.982.982 0 0 0-1.395 0 .989.989 0 0 0 0 1.395l5.32 5.32c3.371 3.372 6.64 4.977 10.49 1.126C19.74 19.8 20.271 17 18.62 13.982L15.812 9.04z"></path></g></svg></span></span></button></div><span class="u-relative u-background js-actionMultirecommendCount u-marginLeft5"><button class="button button--chromeless u-baseColor--buttonNormal js-multirecommendCountButton u-disablePointerEvents" data-action="show-recommends" data-action-value="4ff144cd3978">13</button></span></div></div><div class="buttonSet u-floatRight"><a class="button button--chromeless u-baseColor--buttonNormal" href="https://medium.com/@al45tair/there-is-a-hugely-important-aspect-of-lock-free-programming-that-isnt-mentioned-in-this-article-4ff144cd3978?source=responses---------0---------------------#--responses" data-action-source="responses---------0---------------------">1 response</a><button class="button button--chromeless is-touchIconFadeInPulse u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--bookmark js-bookmarkButton" title="Bookmark this story to read later" aria-label="Bookmark this story to read later" data-action="sign-up-prompt" data-sign-in-action="add-to-bookmarks" data-requires-token="true" data-redirect="https://medium.com/_/bookmark/p/4ff144cd3978" data-action-source="listing-----4ff144cd3978---------------------bookmark_preview"><span class="button-defaultState"><span class="svgIcon svgIcon--bookmark svgIcon--25px is-flushRight"><svg class="svgIcon-use" width="25" height="25"><path d="M19 6c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v14.66h.012c.01.103.045.204.12.285a.5.5 0 0 0 .706.03L12.5 16.85l5.662 4.126a.508.508 0 0 0 .708-.03.5.5 0 0 0 .118-.285H19V6zm-6.838 9.97L7 19.636V6c0-.55.45-1 1-1h9c.55 0 1 .45 1 1v13.637l-5.162-3.668a.49.49 0 0 0-.676 0z" fill-rule="evenodd"></path></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--bookmarkFilled svgIcon--25px is-flushRight"><svg class="svgIcon-use" width="25" height="25"><path d="M19 6c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v14.66h.012c.01.103.045.204.12.285a.5.5 0 0 0 .706.03L12.5 16.85l5.662 4.126c.205.183.52.17.708-.03a.5.5 0 0 0 .118-.285H19V6z"></path></svg></span></span></button></div></div></div></div><div class="streamItemConversationItem streamItemConversationItem--preview"><div class="postArticle js-postArticle js-trackPostPresentation js-trackPostScrolls postArticle--short" data-post-id="ba94f419aed8" data-source="responses---------0---------------------" data-action-scope="_actionscope_8" data-scroll="native"><div class="u-clearfix u-marginBottom15 u-paddingTop5"><div class="postMetaInline u-floatLeft"><div class="u-flexCenter"><div class="postMetaInline-avatar u-flex0"><a class="link u-baseColor--link avatar" href="https://medium.com/@tylerneely" data-action="show-user-card" data-action-value="5145b6327de1" data-action-type="hover" data-user-id="5145b6327de1" dir="auto"><img src="./Fear and Loathing in Lock-Free Programming – Tyler Neely – Medium_files/1_O4KHGpH9QQ0mYamqf_76yA(2).jpeg" class="avatar-image u-size36x36 u-xs-size32x32" alt="Go to the profile of Tyler Neely"></a></div><div class="postMetaInline postMetaInline-authorLockup ui-captionStrong u-flex1 u-noWrapWithEllipsis"><a class="ds-link ds-link--styleSubtle link link--darken link--accent u-accentColor--textNormal u-accentColor--textDarken" href="https://medium.com/@tylerneely?source=responses---------0---------------------" data-action="show-user-card" data-action-source="responses---------0---------------------" data-action-value="5145b6327de1" data-action-type="hover" data-user-id="5145b6327de1" dir="auto">Tyler Neely</a><div class="ui-caption u-fontSize12 u-baseColor--textNormal u-textColorNormal js-postMetaInlineSupplemental"><a class="link link--darken" href="https://medium.com/@tylerneely/thanks-for-bringing-this-up-ba94f419aed8?source=responses---------0---------------------" data-action="open-post" data-action-value="https://medium.com/@tylerneely/thanks-for-bringing-this-up-ba94f419aed8?source=responses---------0---------------------" data-action-source="preview-listing"><time datetime="2017-10-11T15:12:22.716Z">Oct 11, 2017</time></a></div></div></div></div></div><div><a class="" href="https://medium.com/@tylerneely/thanks-for-bringing-this-up-ba94f419aed8?source=responses---------0---------------------"><div class="postArticle-content js-postField"><section class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><p name="c534" id="c534" class="graf graf--p graf--leading graf--trailing">Thanks for bringing this up! I originally set out to write about correctness testing of concurrent systems, including using ARM machines as useful testbeds due to their weaker memory model, but then I had like 4 blog posts in one, and I decided to split it up. Stay tuned for more&nbsp;:)</p></div></div></section></div></a></div><div class="u-clearfix u-paddingTop10"><div class="u-floatLeft"><div class="multirecommend js-actionMultirecommend u-flexCenter" data-post-id="ba94f419aed8" data-is-flush-left="true" data-source="listing-----ba94f419aed8---------------------clap_preview"><div class="u-relative u-foreground"><button class="button button--primary button--chromeless u-accentColor--buttonNormal button--withIcon button--withSvgIcon clapButton js-actionMultirecommendButton clapButton--darker" data-action="sign-up-prompt" data-sign-in-action="multivote" data-requires-token="true" data-redirect="https://medium.com/_/vote/p/ba94f419aed8" data-action-source="listing-----ba94f419aed8---------------------clap_preview" aria-label="Clap"><span class="button-defaultState"><span class="svgIcon svgIcon--clap svgIcon--25px is-flushLeft"><svg class="svgIcon-use" width="25" height="25"><g fill-rule="evenodd"><path d="M11.739 0l.761 2.966L13.261 0z"></path><path d="M14.815 3.776l1.84-2.551-1.43-.471z"></path><path d="M8.378 1.224l1.84 2.551L9.81.753z"></path><path d="M20.382 21.622c-1.04 1.04-2.115 1.507-3.166 1.608.168-.14.332-.29.492-.45 2.885-2.886 3.456-5.982 1.69-9.211l-1.101-1.937-.955-2.02c-.315-.676-.235-1.185.245-1.556a.836.836 0 0 1 .66-.16c.342.056.66.28.879.605l2.856 5.023c1.179 1.962 1.379 5.119-1.6 8.098m-13.29-.528l-5.02-5.02a1 1 0 0 1 .707-1.701c.255 0 .512.098.707.292l2.607 2.607a.442.442 0 0 0 .624-.624L4.11 14.04l-1.75-1.75a.998.998 0 1 1 1.41-1.413l4.154 4.156a.44.44 0 0 0 .624 0 .44.44 0 0 0 0-.624l-4.152-4.153-1.172-1.171a.998.998 0 0 1 0-1.41 1.018 1.018 0 0 1 1.41 0l1.172 1.17 4.153 4.152a.437.437 0 0 0 .624 0 .442.442 0 0 0 0-.624L6.43 8.222a.988.988 0 0 1-.291-.705.99.99 0 0 1 .29-.706 1 1 0 0 1 1.412 0l6.992 6.993a.443.443 0 0 0 .71-.501l-1.35-2.856c-.315-.676-.235-1.185.246-1.557a.85.85 0 0 1 .66-.16c.342.056.659.28.879.606L18.628 14c1.573 2.876 1.067 5.545-1.544 8.156-1.396 1.397-3.144 1.966-5.063 1.652-1.713-.286-3.463-1.248-4.928-2.714zM10.99 5.976l2.562 2.562c-.497.607-.563 1.414-.155 2.284l.265.562-4.257-4.257a.98.98 0 0 1-.117-.445c0-.267.104-.517.292-.706a1.023 1.023 0 0 1 1.41 0zm8.887 2.06c-.375-.557-.902-.916-1.486-1.011a1.738 1.738 0 0 0-1.342.332c-.376.29-.61.656-.712 1.065a2.1 2.1 0 0 0-1.095-.562 1.776 1.776 0 0 0-.992.128l-2.636-2.636a1.883 1.883 0 0 0-2.658 0 1.862 1.862 0 0 0-.478.847 1.886 1.886 0 0 0-2.671-.012 1.867 1.867 0 0 0-.503.909c-.754-.754-1.992-.754-2.703-.044a1.881 1.881 0 0 0 0 2.658c-.288.12-.605.288-.864.547a1.884 1.884 0 0 0 0 2.659l.624.622a1.879 1.879 0 0 0-.91 3.16l5.019 5.02c1.595 1.594 3.515 2.645 5.408 2.959a7.16 7.16 0 0 0 1.173.098c1.026 0 1.997-.24 2.892-.7.279.04.555.065.828.065 1.53 0 2.969-.628 4.236-1.894 3.338-3.338 3.083-6.928 1.738-9.166l-2.868-5.043z"></path></g></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--clapFilled svgIcon--25px is-flushLeft"><svg class="svgIcon-use" width="25" height="25"><g fill-rule="evenodd"><path d="M11.738 0l.762 2.966L13.262 0z"></path><path d="M16.634 1.224l-1.432-.47-.408 3.022z"></path><path d="M9.79.754l-1.431.47 1.84 2.552z"></path><path d="M22.472 13.307l-3.023-5.32c-.287-.426-.689-.705-1.123-.776a1.16 1.16 0 0 0-.911.221c-.297.231-.474.515-.535.84.017.022.036.04.053.063l2.843 5.001c1.95 3.564 1.328 6.973-1.843 10.144a8.46 8.46 0 0 1-.549.501c1.205-.156 2.328-.737 3.351-1.76 3.268-3.268 3.041-6.749 1.737-8.914"></path><path d="M12.58 9.887c-.156-.83.096-1.569.692-2.142L10.78 5.252c-.5-.504-1.378-.504-1.879 0-.178.18-.273.4-.329.63l4.008 4.005z"></path><path d="M15.812 9.04c-.218-.323-.539-.55-.88-.606a.814.814 0 0 0-.644.153c-.176.137-.713.553-.24 1.566l1.43 3.025a.539.539 0 1 1-.868.612L7.2 6.378a.986.986 0 1 0-1.395 1.395l4.401 4.403a.538.538 0 1 1-.762.762L5.046 8.54 3.802 7.295a.99.99 0 0 0-1.396 0 .981.981 0 0 0 0 1.394L3.647 9.93l4.402 4.403a.537.537 0 0 1 0 .761.535.535 0 0 1-.762 0L2.89 10.696a.992.992 0 0 0-1.399-.003.983.983 0 0 0 0 1.395l1.855 1.854 2.763 2.765a.538.538 0 0 1-.76.761l-2.765-2.764a.982.982 0 0 0-1.395 0 .989.989 0 0 0 0 1.395l5.32 5.32c3.371 3.372 6.64 4.977 10.49 1.126C19.74 19.8 20.271 17 18.62 13.982L15.812 9.04z"></path></g></svg></span></span></button></div><span class="u-relative u-background js-actionMultirecommendCount u-marginLeft5"><button class="button button--chromeless u-baseColor--buttonNormal js-multirecommendCountButton u-disablePointerEvents" data-action="show-recommends" data-action-value="ba94f419aed8">1</button></span></div></div><div class="buttonSet u-floatRight"><button class="button button--chromeless is-touchIconFadeInPulse u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--bookmark js-bookmarkButton" title="Bookmark this story to read later" aria-label="Bookmark this story to read later" data-action="sign-up-prompt" data-sign-in-action="add-to-bookmarks" data-requires-token="true" data-redirect="https://medium.com/_/bookmark/p/ba94f419aed8" data-action-source="listing-----ba94f419aed8---------------------bookmark_preview"><span class="button-defaultState"><span class="svgIcon svgIcon--bookmark svgIcon--25px is-flushRight"><svg class="svgIcon-use" width="25" height="25"><path d="M19 6c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v14.66h.012c.01.103.045.204.12.285a.5.5 0 0 0 .706.03L12.5 16.85l5.662 4.126a.508.508 0 0 0 .708-.03.5.5 0 0 0 .118-.285H19V6zm-6.838 9.97L7 19.636V6c0-.55.45-1 1-1h9c.55 0 1 .45 1 1v13.637l-5.162-3.668a.49.49 0 0 0-.676 0z" fill-rule="evenodd"></path></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--bookmarkFilled svgIcon--25px is-flushRight"><svg class="svgIcon-use" width="25" height="25"><path d="M19 6c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v14.66h.012c.01.103.045.204.12.285a.5.5 0 0 0 .706.03L12.5 16.85l5.662 4.126c.205.183.52.17.708-.03a.5.5 0 0 0 .118-.285H19V6z"></path></svg></span></span></button></div></div></div></div></div></div></div><div class="streamItem streamItem--postPreview js-streamItem" data-action-scope="_actionscope_9"><div class="cardChromeless u-marginTop20 u-paddingTop10 u-paddingBottom15 u-paddingLeft20 u-paddingRight20"><div class="postArticle postArticle--short js-postArticle js-trackPostPresentation js-trackPostScrolls" data-post-id="450760f8841d" data-source="responses---------1-31--------------------" data-action-scope="_actionscope_10" data-scroll="native"><div class="u-marginBottom10"><div class="postMetaInline">Applause from <a class="link link--darken u-accentColor--textDarken u-baseColor--link" href="https://medium.com/@tylerneely" data-action="show-user-card" data-action-value="5145b6327de1" data-action-type="hover" data-user-id="5145b6327de1" dir="auto">Tyler Neely</a> (author)</div></div><div class="u-clearfix u-marginBottom15 u-paddingTop5"><div class="postMetaInline u-floatLeft"><div class="u-flexCenter"><div class="postMetaInline-avatar u-flex0"><a class="link u-baseColor--link avatar" href="https://medium.com/@haumacher" data-action="show-user-card" data-action-value="449cab613796" data-action-type="hover" data-user-id="449cab613796" dir="auto"><img src="./Fear and Loathing in Lock-Free Programming – Tyler Neely – Medium_files/0_RCYgenuaG18abhi-" class="avatar-image u-size36x36 u-xs-size32x32" alt="Go to the profile of Bernhard Haumacher"></a></div><div class="postMetaInline postMetaInline-authorLockup ui-captionStrong u-flex1 u-noWrapWithEllipsis"><a class="ds-link ds-link--styleSubtle link link--darken link--accent u-accentColor--textNormal u-accentColor--textDarken" href="https://medium.com/@haumacher?source=responses---------1-31--------------------" data-action="show-user-card" data-action-source="responses---------1-31--------------------" data-action-value="449cab613796" data-action-type="hover" data-user-id="449cab613796" dir="auto">Bernhard Haumacher</a><div class="ui-caption u-fontSize12 u-baseColor--textNormal u-textColorNormal js-postMetaInlineSupplemental"><a class="link link--darken" href="https://medium.com/@haumacher/absolutely-fun-to-read-learning-new-vocabulary-and-new-things-not-to-try-at-home-450760f8841d?source=responses---------1-31--------------------" data-action="open-post" data-action-value="https://medium.com/@haumacher/absolutely-fun-to-read-learning-new-vocabulary-and-new-things-not-to-try-at-home-450760f8841d?source=responses---------1-31--------------------" data-action-source="preview-listing"><time datetime="2017-10-11T07:33:04.456Z">Oct 11, 2017</time></a></div></div></div></div></div><div><a class="" href="https://medium.com/@haumacher/absolutely-fun-to-read-learning-new-vocabulary-and-new-things-not-to-try-at-home-450760f8841d?source=responses---------1-31--------------------" data-action-source="responses---------1-31--------------------"><div class="postArticle-content js-postField"><section class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><p name="653c" id="653c" class="graf graf--p graf--leading graf--trailing">Absolutely fun to read — learning new vocabulary and new things not to try at home!</p></div></div></section></div></a></div><div class="u-clearfix u-paddingTop10"><div class="u-floatLeft"><div class="multirecommend js-actionMultirecommend u-flexCenter" data-post-id="450760f8841d" data-is-flush-left="true" data-source="listing-----450760f8841d---------------------clap_preview"><div class="u-relative u-foreground"><button class="button button--primary button--chromeless u-accentColor--buttonNormal button--withIcon button--withSvgIcon clapButton js-actionMultirecommendButton clapButton--darker" data-action="sign-up-prompt" data-sign-in-action="multivote" data-requires-token="true" data-redirect="https://medium.com/_/vote/p/450760f8841d" data-action-source="listing-----450760f8841d---------------------clap_preview" aria-label="Clap"><span class="button-defaultState"><span class="svgIcon svgIcon--clap svgIcon--25px is-flushLeft"><svg class="svgIcon-use" width="25" height="25"><g fill-rule="evenodd"><path d="M11.739 0l.761 2.966L13.261 0z"></path><path d="M14.815 3.776l1.84-2.551-1.43-.471z"></path><path d="M8.378 1.224l1.84 2.551L9.81.753z"></path><path d="M20.382 21.622c-1.04 1.04-2.115 1.507-3.166 1.608.168-.14.332-.29.492-.45 2.885-2.886 3.456-5.982 1.69-9.211l-1.101-1.937-.955-2.02c-.315-.676-.235-1.185.245-1.556a.836.836 0 0 1 .66-.16c.342.056.66.28.879.605l2.856 5.023c1.179 1.962 1.379 5.119-1.6 8.098m-13.29-.528l-5.02-5.02a1 1 0 0 1 .707-1.701c.255 0 .512.098.707.292l2.607 2.607a.442.442 0 0 0 .624-.624L4.11 14.04l-1.75-1.75a.998.998 0 1 1 1.41-1.413l4.154 4.156a.44.44 0 0 0 .624 0 .44.44 0 0 0 0-.624l-4.152-4.153-1.172-1.171a.998.998 0 0 1 0-1.41 1.018 1.018 0 0 1 1.41 0l1.172 1.17 4.153 4.152a.437.437 0 0 0 .624 0 .442.442 0 0 0 0-.624L6.43 8.222a.988.988 0 0 1-.291-.705.99.99 0 0 1 .29-.706 1 1 0 0 1 1.412 0l6.992 6.993a.443.443 0 0 0 .71-.501l-1.35-2.856c-.315-.676-.235-1.185.246-1.557a.85.85 0 0 1 .66-.16c.342.056.659.28.879.606L18.628 14c1.573 2.876 1.067 5.545-1.544 8.156-1.396 1.397-3.144 1.966-5.063 1.652-1.713-.286-3.463-1.248-4.928-2.714zM10.99 5.976l2.562 2.562c-.497.607-.563 1.414-.155 2.284l.265.562-4.257-4.257a.98.98 0 0 1-.117-.445c0-.267.104-.517.292-.706a1.023 1.023 0 0 1 1.41 0zm8.887 2.06c-.375-.557-.902-.916-1.486-1.011a1.738 1.738 0 0 0-1.342.332c-.376.29-.61.656-.712 1.065a2.1 2.1 0 0 0-1.095-.562 1.776 1.776 0 0 0-.992.128l-2.636-2.636a1.883 1.883 0 0 0-2.658 0 1.862 1.862 0 0 0-.478.847 1.886 1.886 0 0 0-2.671-.012 1.867 1.867 0 0 0-.503.909c-.754-.754-1.992-.754-2.703-.044a1.881 1.881 0 0 0 0 2.658c-.288.12-.605.288-.864.547a1.884 1.884 0 0 0 0 2.659l.624.622a1.879 1.879 0 0 0-.91 3.16l5.019 5.02c1.595 1.594 3.515 2.645 5.408 2.959a7.16 7.16 0 0 0 1.173.098c1.026 0 1.997-.24 2.892-.7.279.04.555.065.828.065 1.53 0 2.969-.628 4.236-1.894 3.338-3.338 3.083-6.928 1.738-9.166l-2.868-5.043z"></path></g></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--clapFilled svgIcon--25px is-flushLeft"><svg class="svgIcon-use" width="25" height="25"><g fill-rule="evenodd"><path d="M11.738 0l.762 2.966L13.262 0z"></path><path d="M16.634 1.224l-1.432-.47-.408 3.022z"></path><path d="M9.79.754l-1.431.47 1.84 2.552z"></path><path d="M22.472 13.307l-3.023-5.32c-.287-.426-.689-.705-1.123-.776a1.16 1.16 0 0 0-.911.221c-.297.231-.474.515-.535.84.017.022.036.04.053.063l2.843 5.001c1.95 3.564 1.328 6.973-1.843 10.144a8.46 8.46 0 0 1-.549.501c1.205-.156 2.328-.737 3.351-1.76 3.268-3.268 3.041-6.749 1.737-8.914"></path><path d="M12.58 9.887c-.156-.83.096-1.569.692-2.142L10.78 5.252c-.5-.504-1.378-.504-1.879 0-.178.18-.273.4-.329.63l4.008 4.005z"></path><path d="M15.812 9.04c-.218-.323-.539-.55-.88-.606a.814.814 0 0 0-.644.153c-.176.137-.713.553-.24 1.566l1.43 3.025a.539.539 0 1 1-.868.612L7.2 6.378a.986.986 0 1 0-1.395 1.395l4.401 4.403a.538.538 0 1 1-.762.762L5.046 8.54 3.802 7.295a.99.99 0 0 0-1.396 0 .981.981 0 0 0 0 1.394L3.647 9.93l4.402 4.403a.537.537 0 0 1 0 .761.535.535 0 0 1-.762 0L2.89 10.696a.992.992 0 0 0-1.399-.003.983.983 0 0 0 0 1.395l1.855 1.854 2.763 2.765a.538.538 0 0 1-.76.761l-2.765-2.764a.982.982 0 0 0-1.395 0 .989.989 0 0 0 0 1.395l5.32 5.32c3.371 3.372 6.64 4.977 10.49 1.126C19.74 19.8 20.271 17 18.62 13.982L15.812 9.04z"></path></g></svg></span></span></button></div><span class="u-relative u-background js-actionMultirecommendCount u-marginLeft5"><button class="button button--chromeless u-baseColor--buttonNormal js-multirecommendCountButton u-disablePointerEvents" data-action="show-recommends" data-action-value="450760f8841d">4</button></span></div></div><div class="buttonSet u-floatRight"><button class="button button--chromeless is-touchIconFadeInPulse u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--bookmark js-bookmarkButton" title="Bookmark this story to read later" aria-label="Bookmark this story to read later" data-action="sign-up-prompt" data-sign-in-action="add-to-bookmarks" data-requires-token="true" data-redirect="https://medium.com/_/bookmark/p/450760f8841d" data-action-source="listing-----450760f8841d---------------------bookmark_preview"><span class="button-defaultState"><span class="svgIcon svgIcon--bookmark svgIcon--25px is-flushRight"><svg class="svgIcon-use" width="25" height="25"><path d="M19 6c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v14.66h.012c.01.103.045.204.12.285a.5.5 0 0 0 .706.03L12.5 16.85l5.662 4.126a.508.508 0 0 0 .708-.03.5.5 0 0 0 .118-.285H19V6zm-6.838 9.97L7 19.636V6c0-.55.45-1 1-1h9c.55 0 1 .45 1 1v13.637l-5.162-3.668a.49.49 0 0 0-.676 0z" fill-rule="evenodd"></path></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--bookmarkFilled svgIcon--25px is-flushRight"><svg class="svgIcon-use" width="25" height="25"><path d="M19 6c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v14.66h.012c.01.103.045.204.12.285a.5.5 0 0 0 .706.03L12.5 16.85l5.662 4.126c.205.183.52.17.708-.03a.5.5 0 0 0 .118-.285H19V6z"></path></svg></span></span></button></div></div></div></div></div><div class="streamItem streamItem--postPreview js-streamItem" data-action-scope="_actionscope_11"><div class="cardChromeless u-marginTop20 u-paddingTop10 u-paddingBottom15 u-paddingLeft20 u-paddingRight20"><div class="postArticle postArticle--short js-postArticle js-trackPostPresentation js-trackPostScrolls" data-post-id="cf4d612af0eb" data-source="responses---------2-31--------------------" data-action-scope="_actionscope_12" data-scroll="native"><div class="u-marginBottom10"><div class="postMetaInline">Applause from <a class="link link--darken u-accentColor--textDarken u-baseColor--link" href="https://medium.com/@tylerneely" data-action="show-user-card" data-action-value="5145b6327de1" data-action-type="hover" data-user-id="5145b6327de1" dir="auto">Tyler Neely</a> (author)</div></div><div class="u-clearfix u-marginBottom15 u-paddingTop5"><div class="postMetaInline u-floatLeft"><div class="u-flexCenter"><div class="postMetaInline-avatar u-flex0"><a class="link u-baseColor--link avatar" href="https://medium.com/@interlink.sg7" data-action="show-user-card" data-action-value="6bb6ef6bcf90" data-action-type="hover" data-user-id="6bb6ef6bcf90" dir="auto"><img src="./Fear and Loathing in Lock-Free Programming – Tyler Neely – Medium_files/0_5jk-6Cp9Pj7tuSrP" class="avatar-image u-size36x36 u-xs-size32x32" alt="Go to the profile of Simon Gwerder"></a></div><div class="postMetaInline postMetaInline-authorLockup ui-captionStrong u-flex1 u-noWrapWithEllipsis"><a class="ds-link ds-link--styleSubtle link link--darken link--accent u-accentColor--textNormal u-accentColor--textDarken" href="https://medium.com/@interlink.sg7?source=responses---------2-31--------------------" data-action="show-user-card" data-action-source="responses---------2-31--------------------" data-action-value="6bb6ef6bcf90" data-action-type="hover" data-user-id="6bb6ef6bcf90" dir="auto">Simon Gwerder</a><div class="ui-caption u-fontSize12 u-baseColor--textNormal u-textColorNormal js-postMetaInlineSupplemental"><a class="link link--darken" href="https://medium.com/@interlink.sg7/a-little-detail-for-the-spin-example-cf4d612af0eb?source=responses---------2-31--------------------" data-action="open-post" data-action-value="https://medium.com/@interlink.sg7/a-little-detail-for-the-spin-example-cf4d612af0eb?source=responses---------2-31--------------------" data-action-source="preview-listing"><time datetime="2017-10-09T14:02:18.623Z">Oct 9, 2017</time></a></div></div></div></div></div><div><a class="" href="https://medium.com/@interlink.sg7/a-little-detail-for-the-spin-example-cf4d612af0eb?source=responses---------2-31--------------------" data-action-source="responses---------2-31--------------------"><div class="postArticle-content js-postField"><section class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><p name="f897" id="f897" class="graf graf--p graf--leading graf--trailing">A little detail for the spin example. In Java 9 there’s a new Spin-Wait Hint annotation. See: JEP 285: Spin-Wait Hints. <span class="markup--anchor markup--p-anchor" data-action="open-inner-link" data-action-value="http://openjdk.java.net/jeps/285">http://openjdk.java.net/jeps/285</span></p></div></div></section></div></a></div><div class="u-clearfix u-paddingTop10"><div class="u-floatLeft"><div class="multirecommend js-actionMultirecommend u-flexCenter" data-post-id="cf4d612af0eb" data-is-flush-left="true" data-source="listing-----cf4d612af0eb---------------------clap_preview"><div class="u-relative u-foreground"><button class="button button--primary button--chromeless u-accentColor--buttonNormal button--withIcon button--withSvgIcon clapButton js-actionMultirecommendButton clapButton--darker" data-action="sign-up-prompt" data-sign-in-action="multivote" data-requires-token="true" data-redirect="https://medium.com/_/vote/p/cf4d612af0eb" data-action-source="listing-----cf4d612af0eb---------------------clap_preview" aria-label="Clap"><span class="button-defaultState"><span class="svgIcon svgIcon--clap svgIcon--25px is-flushLeft"><svg class="svgIcon-use" width="25" height="25"><g fill-rule="evenodd"><path d="M11.739 0l.761 2.966L13.261 0z"></path><path d="M14.815 3.776l1.84-2.551-1.43-.471z"></path><path d="M8.378 1.224l1.84 2.551L9.81.753z"></path><path d="M20.382 21.622c-1.04 1.04-2.115 1.507-3.166 1.608.168-.14.332-.29.492-.45 2.885-2.886 3.456-5.982 1.69-9.211l-1.101-1.937-.955-2.02c-.315-.676-.235-1.185.245-1.556a.836.836 0 0 1 .66-.16c.342.056.66.28.879.605l2.856 5.023c1.179 1.962 1.379 5.119-1.6 8.098m-13.29-.528l-5.02-5.02a1 1 0 0 1 .707-1.701c.255 0 .512.098.707.292l2.607 2.607a.442.442 0 0 0 .624-.624L4.11 14.04l-1.75-1.75a.998.998 0 1 1 1.41-1.413l4.154 4.156a.44.44 0 0 0 .624 0 .44.44 0 0 0 0-.624l-4.152-4.153-1.172-1.171a.998.998 0 0 1 0-1.41 1.018 1.018 0 0 1 1.41 0l1.172 1.17 4.153 4.152a.437.437 0 0 0 .624 0 .442.442 0 0 0 0-.624L6.43 8.222a.988.988 0 0 1-.291-.705.99.99 0 0 1 .29-.706 1 1 0 0 1 1.412 0l6.992 6.993a.443.443 0 0 0 .71-.501l-1.35-2.856c-.315-.676-.235-1.185.246-1.557a.85.85 0 0 1 .66-.16c.342.056.659.28.879.606L18.628 14c1.573 2.876 1.067 5.545-1.544 8.156-1.396 1.397-3.144 1.966-5.063 1.652-1.713-.286-3.463-1.248-4.928-2.714zM10.99 5.976l2.562 2.562c-.497.607-.563 1.414-.155 2.284l.265.562-4.257-4.257a.98.98 0 0 1-.117-.445c0-.267.104-.517.292-.706a1.023 1.023 0 0 1 1.41 0zm8.887 2.06c-.375-.557-.902-.916-1.486-1.011a1.738 1.738 0 0 0-1.342.332c-.376.29-.61.656-.712 1.065a2.1 2.1 0 0 0-1.095-.562 1.776 1.776 0 0 0-.992.128l-2.636-2.636a1.883 1.883 0 0 0-2.658 0 1.862 1.862 0 0 0-.478.847 1.886 1.886 0 0 0-2.671-.012 1.867 1.867 0 0 0-.503.909c-.754-.754-1.992-.754-2.703-.044a1.881 1.881 0 0 0 0 2.658c-.288.12-.605.288-.864.547a1.884 1.884 0 0 0 0 2.659l.624.622a1.879 1.879 0 0 0-.91 3.16l5.019 5.02c1.595 1.594 3.515 2.645 5.408 2.959a7.16 7.16 0 0 0 1.173.098c1.026 0 1.997-.24 2.892-.7.279.04.555.065.828.065 1.53 0 2.969-.628 4.236-1.894 3.338-3.338 3.083-6.928 1.738-9.166l-2.868-5.043z"></path></g></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--clapFilled svgIcon--25px is-flushLeft"><svg class="svgIcon-use" width="25" height="25"><g fill-rule="evenodd"><path d="M11.738 0l.762 2.966L13.262 0z"></path><path d="M16.634 1.224l-1.432-.47-.408 3.022z"></path><path d="M9.79.754l-1.431.47 1.84 2.552z"></path><path d="M22.472 13.307l-3.023-5.32c-.287-.426-.689-.705-1.123-.776a1.16 1.16 0 0 0-.911.221c-.297.231-.474.515-.535.84.017.022.036.04.053.063l2.843 5.001c1.95 3.564 1.328 6.973-1.843 10.144a8.46 8.46 0 0 1-.549.501c1.205-.156 2.328-.737 3.351-1.76 3.268-3.268 3.041-6.749 1.737-8.914"></path><path d="M12.58 9.887c-.156-.83.096-1.569.692-2.142L10.78 5.252c-.5-.504-1.378-.504-1.879 0-.178.18-.273.4-.329.63l4.008 4.005z"></path><path d="M15.812 9.04c-.218-.323-.539-.55-.88-.606a.814.814 0 0 0-.644.153c-.176.137-.713.553-.24 1.566l1.43 3.025a.539.539 0 1 1-.868.612L7.2 6.378a.986.986 0 1 0-1.395 1.395l4.401 4.403a.538.538 0 1 1-.762.762L5.046 8.54 3.802 7.295a.99.99 0 0 0-1.396 0 .981.981 0 0 0 0 1.394L3.647 9.93l4.402 4.403a.537.537 0 0 1 0 .761.535.535 0 0 1-.762 0L2.89 10.696a.992.992 0 0 0-1.399-.003.983.983 0 0 0 0 1.395l1.855 1.854 2.763 2.765a.538.538 0 0 1-.76.761l-2.765-2.764a.982.982 0 0 0-1.395 0 .989.989 0 0 0 0 1.395l5.32 5.32c3.371 3.372 6.64 4.977 10.49 1.126C19.74 19.8 20.271 17 18.62 13.982L15.812 9.04z"></path></g></svg></span></span></button></div><span class="u-relative u-background js-actionMultirecommendCount u-marginLeft5"><button class="button button--chromeless u-baseColor--buttonNormal js-multirecommendCountButton u-disablePointerEvents" data-action="show-recommends" data-action-value="cf4d612af0eb">1</button></span></div></div><div class="buttonSet u-floatRight"><button class="button button--chromeless is-touchIconFadeInPulse u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--bookmark js-bookmarkButton" title="Bookmark this story to read later" aria-label="Bookmark this story to read later" data-action="sign-up-prompt" data-sign-in-action="add-to-bookmarks" data-requires-token="true" data-redirect="https://medium.com/_/bookmark/p/cf4d612af0eb" data-action-source="listing-----cf4d612af0eb---------------------bookmark_preview"><span class="button-defaultState"><span class="svgIcon svgIcon--bookmark svgIcon--25px is-flushRight"><svg class="svgIcon-use" width="25" height="25"><path d="M19 6c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v14.66h.012c.01.103.045.204.12.285a.5.5 0 0 0 .706.03L12.5 16.85l5.662 4.126a.508.508 0 0 0 .708-.03.5.5 0 0 0 .118-.285H19V6zm-6.838 9.97L7 19.636V6c0-.55.45-1 1-1h9c.55 0 1 .45 1 1v13.637l-5.162-3.668a.49.49 0 0 0-.676 0z" fill-rule="evenodd"></path></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--bookmarkFilled svgIcon--25px is-flushRight"><svg class="svgIcon-use" width="25" height="25"><path d="M19 6c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v14.66h.012c.01.103.045.204.12.285a.5.5 0 0 0 .706.03L12.5 16.85l5.662 4.126c.205.183.52.17.708-.03a.5.5 0 0 0 .118-.285H19V6z"></path></svg></span></span></button></div></div></div></div></div><div class="streamItem streamItem--postPreview js-streamItem" data-action-scope="_actionscope_13"><div class="cardChromeless u-marginTop20 u-paddingTop10 u-paddingBottom15 u-paddingLeft20 u-paddingRight20"><div class="postArticle postArticle--short js-postArticle js-trackPostPresentation js-trackPostScrolls" data-post-id="a6c3628fb1d9" data-source="responses---------3-31--------------------" data-action-scope="_actionscope_14" data-scroll="native"><div class="u-marginBottom10"><div class="postMetaInline">Applause from <a class="link link--darken u-accentColor--textDarken u-baseColor--link" href="https://medium.com/@tylerneely" data-action="show-user-card" data-action-value="5145b6327de1" data-action-type="hover" data-user-id="5145b6327de1" dir="auto">Tyler Neely</a> (author)</div></div><div class="u-clearfix u-marginBottom15 u-paddingTop5"><div class="postMetaInline u-floatLeft"><div class="u-flexCenter"><div class="postMetaInline-avatar u-flex0"><a class="link u-baseColor--link avatar" href="https://medium.com/@ben.krug" data-action="show-user-card" data-action-value="2bb92e679e91" data-action-type="hover" data-user-id="2bb92e679e91" dir="auto"><img src="./Fear and Loathing in Lock-Free Programming – Tyler Neely – Medium_files/0_9QMMakrGQ3iryRBV" class="avatar-image u-size36x36 u-xs-size32x32" alt="Go to the profile of Ben Krug"></a></div><div class="postMetaInline postMetaInline-authorLockup ui-captionStrong u-flex1 u-noWrapWithEllipsis"><a class="ds-link ds-link--styleSubtle link link--darken link--accent u-accentColor--textNormal u-accentColor--textDarken" href="https://medium.com/@ben.krug?source=responses---------3-31--------------------" data-action="show-user-card" data-action-source="responses---------3-31--------------------" data-action-value="2bb92e679e91" data-action-type="hover" data-user-id="2bb92e679e91" dir="auto">Ben Krug</a><div class="ui-caption u-fontSize12 u-baseColor--textNormal u-textColorNormal js-postMetaInlineSupplemental"><a class="link link--darken" href="https://medium.com/@ben.krug/nice-post-i-hope-you-write-more-clear-entertaining-and-good-links-included-a6c3628fb1d9?source=responses---------3-31--------------------" data-action="open-post" data-action-value="https://medium.com/@ben.krug/nice-post-i-hope-you-write-more-clear-entertaining-and-good-links-included-a6c3628fb1d9?source=responses---------3-31--------------------" data-action-source="preview-listing"><time datetime="2017-12-30T20:18:44.487Z">Dec 30, 2017</time></a></div></div></div></div></div><div><a class="" href="https://medium.com/@ben.krug/nice-post-i-hope-you-write-more-clear-entertaining-and-good-links-included-a6c3628fb1d9?source=responses---------3-31--------------------" data-action-source="responses---------3-31--------------------"><div class="postArticle-content js-postField"><section class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><p name="dfb9" id="dfb9" class="graf graf--p graf--leading graf--trailing">Nice post — I hope you write more! Clear, entertaining, and good links included!</p></div></div></section></div></a></div><div class="u-clearfix u-paddingTop10"><div class="u-floatLeft"><div class="multirecommend js-actionMultirecommend u-flexCenter" data-post-id="a6c3628fb1d9" data-is-flush-left="true" data-source="listing-----a6c3628fb1d9---------------------clap_preview"><div class="u-relative u-foreground"><button class="button button--primary button--chromeless u-accentColor--buttonNormal button--withIcon button--withSvgIcon clapButton js-actionMultirecommendButton clapButton--darker" data-action="sign-up-prompt" data-sign-in-action="multivote" data-requires-token="true" data-redirect="https://medium.com/_/vote/p/a6c3628fb1d9" data-action-source="listing-----a6c3628fb1d9---------------------clap_preview" aria-label="Clap"><span class="button-defaultState"><span class="svgIcon svgIcon--clap svgIcon--25px is-flushLeft"><svg class="svgIcon-use" width="25" height="25"><g fill-rule="evenodd"><path d="M11.739 0l.761 2.966L13.261 0z"></path><path d="M14.815 3.776l1.84-2.551-1.43-.471z"></path><path d="M8.378 1.224l1.84 2.551L9.81.753z"></path><path d="M20.382 21.622c-1.04 1.04-2.115 1.507-3.166 1.608.168-.14.332-.29.492-.45 2.885-2.886 3.456-5.982 1.69-9.211l-1.101-1.937-.955-2.02c-.315-.676-.235-1.185.245-1.556a.836.836 0 0 1 .66-.16c.342.056.66.28.879.605l2.856 5.023c1.179 1.962 1.379 5.119-1.6 8.098m-13.29-.528l-5.02-5.02a1 1 0 0 1 .707-1.701c.255 0 .512.098.707.292l2.607 2.607a.442.442 0 0 0 .624-.624L4.11 14.04l-1.75-1.75a.998.998 0 1 1 1.41-1.413l4.154 4.156a.44.44 0 0 0 .624 0 .44.44 0 0 0 0-.624l-4.152-4.153-1.172-1.171a.998.998 0 0 1 0-1.41 1.018 1.018 0 0 1 1.41 0l1.172 1.17 4.153 4.152a.437.437 0 0 0 .624 0 .442.442 0 0 0 0-.624L6.43 8.222a.988.988 0 0 1-.291-.705.99.99 0 0 1 .29-.706 1 1 0 0 1 1.412 0l6.992 6.993a.443.443 0 0 0 .71-.501l-1.35-2.856c-.315-.676-.235-1.185.246-1.557a.85.85 0 0 1 .66-.16c.342.056.659.28.879.606L18.628 14c1.573 2.876 1.067 5.545-1.544 8.156-1.396 1.397-3.144 1.966-5.063 1.652-1.713-.286-3.463-1.248-4.928-2.714zM10.99 5.976l2.562 2.562c-.497.607-.563 1.414-.155 2.284l.265.562-4.257-4.257a.98.98 0 0 1-.117-.445c0-.267.104-.517.292-.706a1.023 1.023 0 0 1 1.41 0zm8.887 2.06c-.375-.557-.902-.916-1.486-1.011a1.738 1.738 0 0 0-1.342.332c-.376.29-.61.656-.712 1.065a2.1 2.1 0 0 0-1.095-.562 1.776 1.776 0 0 0-.992.128l-2.636-2.636a1.883 1.883 0 0 0-2.658 0 1.862 1.862 0 0 0-.478.847 1.886 1.886 0 0 0-2.671-.012 1.867 1.867 0 0 0-.503.909c-.754-.754-1.992-.754-2.703-.044a1.881 1.881 0 0 0 0 2.658c-.288.12-.605.288-.864.547a1.884 1.884 0 0 0 0 2.659l.624.622a1.879 1.879 0 0 0-.91 3.16l5.019 5.02c1.595 1.594 3.515 2.645 5.408 2.959a7.16 7.16 0 0 0 1.173.098c1.026 0 1.997-.24 2.892-.7.279.04.555.065.828.065 1.53 0 2.969-.628 4.236-1.894 3.338-3.338 3.083-6.928 1.738-9.166l-2.868-5.043z"></path></g></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--clapFilled svgIcon--25px is-flushLeft"><svg class="svgIcon-use" width="25" height="25"><g fill-rule="evenodd"><path d="M11.738 0l.762 2.966L13.262 0z"></path><path d="M16.634 1.224l-1.432-.47-.408 3.022z"></path><path d="M9.79.754l-1.431.47 1.84 2.552z"></path><path d="M22.472 13.307l-3.023-5.32c-.287-.426-.689-.705-1.123-.776a1.16 1.16 0 0 0-.911.221c-.297.231-.474.515-.535.84.017.022.036.04.053.063l2.843 5.001c1.95 3.564 1.328 6.973-1.843 10.144a8.46 8.46 0 0 1-.549.501c1.205-.156 2.328-.737 3.351-1.76 3.268-3.268 3.041-6.749 1.737-8.914"></path><path d="M12.58 9.887c-.156-.83.096-1.569.692-2.142L10.78 5.252c-.5-.504-1.378-.504-1.879 0-.178.18-.273.4-.329.63l4.008 4.005z"></path><path d="M15.812 9.04c-.218-.323-.539-.55-.88-.606a.814.814 0 0 0-.644.153c-.176.137-.713.553-.24 1.566l1.43 3.025a.539.539 0 1 1-.868.612L7.2 6.378a.986.986 0 1 0-1.395 1.395l4.401 4.403a.538.538 0 1 1-.762.762L5.046 8.54 3.802 7.295a.99.99 0 0 0-1.396 0 .981.981 0 0 0 0 1.394L3.647 9.93l4.402 4.403a.537.537 0 0 1 0 .761.535.535 0 0 1-.762 0L2.89 10.696a.992.992 0 0 0-1.399-.003.983.983 0 0 0 0 1.395l1.855 1.854 2.763 2.765a.538.538 0 0 1-.76.761l-2.765-2.764a.982.982 0 0 0-1.395 0 .989.989 0 0 0 0 1.395l5.32 5.32c3.371 3.372 6.64 4.977 10.49 1.126C19.74 19.8 20.271 17 18.62 13.982L15.812 9.04z"></path></g></svg></span></span></button></div><span class="u-relative u-background js-actionMultirecommendCount u-marginLeft5"><button class="button button--chromeless u-baseColor--buttonNormal js-multirecommendCountButton u-disablePointerEvents" data-action="show-recommends" data-action-value="a6c3628fb1d9">1</button></span></div></div><div class="buttonSet u-floatRight"><button class="button button--chromeless is-touchIconFadeInPulse u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--bookmark js-bookmarkButton" title="Bookmark this story to read later" aria-label="Bookmark this story to read later" data-action="sign-up-prompt" data-sign-in-action="add-to-bookmarks" data-requires-token="true" data-redirect="https://medium.com/_/bookmark/p/a6c3628fb1d9" data-action-source="listing-----a6c3628fb1d9---------------------bookmark_preview"><span class="button-defaultState"><span class="svgIcon svgIcon--bookmark svgIcon--25px is-flushRight"><svg class="svgIcon-use" width="25" height="25"><path d="M19 6c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v14.66h.012c.01.103.045.204.12.285a.5.5 0 0 0 .706.03L12.5 16.85l5.662 4.126a.508.508 0 0 0 .708-.03.5.5 0 0 0 .118-.285H19V6zm-6.838 9.97L7 19.636V6c0-.55.45-1 1-1h9c.55 0 1 .45 1 1v13.637l-5.162-3.668a.49.49 0 0 0-.676 0z" fill-rule="evenodd"></path></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--bookmarkFilled svgIcon--25px is-flushRight"><svg class="svgIcon-use" width="25" height="25"><path d="M19 6c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v14.66h.012c.01.103.045.204.12.285a.5.5 0 0 0 .706.03L12.5 16.85l5.662 4.126c.205.183.52.17.708-.03a.5.5 0 0 0 .118-.285H19V6z"></path></svg></span></span></button></div></div></div></div></div><div class="streamItem streamItem--postPreview js-streamItem" data-action-scope="_actionscope_15"><div class="cardChromeless u-marginTop20 u-paddingTop10 u-paddingBottom15 u-paddingLeft20 u-paddingRight20"><div class="postArticle postArticle--short js-postArticle js-trackPostPresentation js-trackPostScrolls" data-post-id="609439e964d7" data-source="responses---------4-31--------------------" data-action-scope="_actionscope_16" data-scroll="native"><div class="u-marginBottom10"><div class="postMetaInline">Applause from <a class="link link--darken u-accentColor--textDarken u-baseColor--link" href="https://medium.com/@tylerneely" data-action="show-user-card" data-action-value="5145b6327de1" data-action-type="hover" data-user-id="5145b6327de1" dir="auto">Tyler Neely</a> (author)</div></div><div class="u-clearfix u-marginBottom15 u-paddingTop5"><div class="postMetaInline u-floatLeft"><div class="u-flexCenter"><div class="postMetaInline-avatar u-flex0"><a class="link u-baseColor--link avatar" href="https://medium.com/@theSquashSH" data-action="show-user-card" data-action-value="d7fda7e114d7" data-action-type="hover" data-user-id="d7fda7e114d7" dir="auto"><img src="./Fear and Loathing in Lock-Free Programming – Tyler Neely – Medium_files/1_cBOjgqprQbJRCo4m1QGAEA.jpeg" class="avatar-image u-size36x36 u-xs-size32x32" alt="Go to the profile of Nick Sweeting"></a></div><div class="postMetaInline postMetaInline-authorLockup ui-captionStrong u-flex1 u-noWrapWithEllipsis"><a class="ds-link ds-link--styleSubtle link link--darken link--accent u-accentColor--textNormal u-accentColor--textDarken" href="https://medium.com/@theSquashSH?source=responses---------4-31--------------------" data-action="show-user-card" data-action-source="responses---------4-31--------------------" data-action-value="d7fda7e114d7" data-action-type="hover" data-user-id="d7fda7e114d7" dir="auto">Nick Sweeting</a><div class="ui-caption u-fontSize12 u-baseColor--textNormal u-textColorNormal js-postMetaInlineSupplemental"><a class="link link--darken" href="https://medium.com/@theSquashSH/awesome-overview-thoroughly-enjoyed-it-609439e964d7?source=responses---------4-31--------------------" data-action="open-post" data-action-value="https://medium.com/@theSquashSH/awesome-overview-thoroughly-enjoyed-it-609439e964d7?source=responses---------4-31--------------------" data-action-source="preview-listing"><time datetime="2017-10-10T07:00:07.669Z">Oct 10, 2017</time></a></div></div></div></div></div><div><a class="" href="https://medium.com/@theSquashSH/awesome-overview-thoroughly-enjoyed-it-609439e964d7?source=responses---------4-31--------------------" data-action-source="responses---------4-31--------------------"><div class="postArticle-content js-postField"><section class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><p name="b8b2" id="b8b2" class="graf graf--p graf--leading graf--trailing">Awesome overview, thoroughly enjoyed it.</p></div></div></section></div></a></div><div class="u-clearfix u-paddingTop10"><div class="u-floatLeft"><div class="multirecommend js-actionMultirecommend u-flexCenter" data-post-id="609439e964d7" data-is-flush-left="true" data-source="listing-----609439e964d7---------------------clap_preview"><div class="u-relative u-foreground"><button class="button button--primary button--chromeless u-accentColor--buttonNormal button--withIcon button--withSvgIcon clapButton js-actionMultirecommendButton clapButton--darker" data-action="sign-up-prompt" data-sign-in-action="multivote" data-requires-token="true" data-redirect="https://medium.com/_/vote/p/609439e964d7" data-action-source="listing-----609439e964d7---------------------clap_preview" aria-label="Clap"><span class="button-defaultState"><span class="svgIcon svgIcon--clap svgIcon--25px is-flushLeft"><svg class="svgIcon-use" width="25" height="25"><g fill-rule="evenodd"><path d="M11.739 0l.761 2.966L13.261 0z"></path><path d="M14.815 3.776l1.84-2.551-1.43-.471z"></path><path d="M8.378 1.224l1.84 2.551L9.81.753z"></path><path d="M20.382 21.622c-1.04 1.04-2.115 1.507-3.166 1.608.168-.14.332-.29.492-.45 2.885-2.886 3.456-5.982 1.69-9.211l-1.101-1.937-.955-2.02c-.315-.676-.235-1.185.245-1.556a.836.836 0 0 1 .66-.16c.342.056.66.28.879.605l2.856 5.023c1.179 1.962 1.379 5.119-1.6 8.098m-13.29-.528l-5.02-5.02a1 1 0 0 1 .707-1.701c.255 0 .512.098.707.292l2.607 2.607a.442.442 0 0 0 .624-.624L4.11 14.04l-1.75-1.75a.998.998 0 1 1 1.41-1.413l4.154 4.156a.44.44 0 0 0 .624 0 .44.44 0 0 0 0-.624l-4.152-4.153-1.172-1.171a.998.998 0 0 1 0-1.41 1.018 1.018 0 0 1 1.41 0l1.172 1.17 4.153 4.152a.437.437 0 0 0 .624 0 .442.442 0 0 0 0-.624L6.43 8.222a.988.988 0 0 1-.291-.705.99.99 0 0 1 .29-.706 1 1 0 0 1 1.412 0l6.992 6.993a.443.443 0 0 0 .71-.501l-1.35-2.856c-.315-.676-.235-1.185.246-1.557a.85.85 0 0 1 .66-.16c.342.056.659.28.879.606L18.628 14c1.573 2.876 1.067 5.545-1.544 8.156-1.396 1.397-3.144 1.966-5.063 1.652-1.713-.286-3.463-1.248-4.928-2.714zM10.99 5.976l2.562 2.562c-.497.607-.563 1.414-.155 2.284l.265.562-4.257-4.257a.98.98 0 0 1-.117-.445c0-.267.104-.517.292-.706a1.023 1.023 0 0 1 1.41 0zm8.887 2.06c-.375-.557-.902-.916-1.486-1.011a1.738 1.738 0 0 0-1.342.332c-.376.29-.61.656-.712 1.065a2.1 2.1 0 0 0-1.095-.562 1.776 1.776 0 0 0-.992.128l-2.636-2.636a1.883 1.883 0 0 0-2.658 0 1.862 1.862 0 0 0-.478.847 1.886 1.886 0 0 0-2.671-.012 1.867 1.867 0 0 0-.503.909c-.754-.754-1.992-.754-2.703-.044a1.881 1.881 0 0 0 0 2.658c-.288.12-.605.288-.864.547a1.884 1.884 0 0 0 0 2.659l.624.622a1.879 1.879 0 0 0-.91 3.16l5.019 5.02c1.595 1.594 3.515 2.645 5.408 2.959a7.16 7.16 0 0 0 1.173.098c1.026 0 1.997-.24 2.892-.7.279.04.555.065.828.065 1.53 0 2.969-.628 4.236-1.894 3.338-3.338 3.083-6.928 1.738-9.166l-2.868-5.043z"></path></g></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--clapFilled svgIcon--25px is-flushLeft"><svg class="svgIcon-use" width="25" height="25"><g fill-rule="evenodd"><path d="M11.738 0l.762 2.966L13.262 0z"></path><path d="M16.634 1.224l-1.432-.47-.408 3.022z"></path><path d="M9.79.754l-1.431.47 1.84 2.552z"></path><path d="M22.472 13.307l-3.023-5.32c-.287-.426-.689-.705-1.123-.776a1.16 1.16 0 0 0-.911.221c-.297.231-.474.515-.535.84.017.022.036.04.053.063l2.843 5.001c1.95 3.564 1.328 6.973-1.843 10.144a8.46 8.46 0 0 1-.549.501c1.205-.156 2.328-.737 3.351-1.76 3.268-3.268 3.041-6.749 1.737-8.914"></path><path d="M12.58 9.887c-.156-.83.096-1.569.692-2.142L10.78 5.252c-.5-.504-1.378-.504-1.879 0-.178.18-.273.4-.329.63l4.008 4.005z"></path><path d="M15.812 9.04c-.218-.323-.539-.55-.88-.606a.814.814 0 0 0-.644.153c-.176.137-.713.553-.24 1.566l1.43 3.025a.539.539 0 1 1-.868.612L7.2 6.378a.986.986 0 1 0-1.395 1.395l4.401 4.403a.538.538 0 1 1-.762.762L5.046 8.54 3.802 7.295a.99.99 0 0 0-1.396 0 .981.981 0 0 0 0 1.394L3.647 9.93l4.402 4.403a.537.537 0 0 1 0 .761.535.535 0 0 1-.762 0L2.89 10.696a.992.992 0 0 0-1.399-.003.983.983 0 0 0 0 1.395l1.855 1.854 2.763 2.765a.538.538 0 0 1-.76.761l-2.765-2.764a.982.982 0 0 0-1.395 0 .989.989 0 0 0 0 1.395l5.32 5.32c3.371 3.372 6.64 4.977 10.49 1.126C19.74 19.8 20.271 17 18.62 13.982L15.812 9.04z"></path></g></svg></span></span></button></div><span class="u-relative u-background js-actionMultirecommendCount u-marginLeft5"><button class="button button--chromeless u-baseColor--buttonNormal js-multirecommendCountButton u-disablePointerEvents" data-action="show-recommends" data-action-value="609439e964d7">1</button></span></div></div><div class="buttonSet u-floatRight"><button class="button button--chromeless is-touchIconFadeInPulse u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--bookmark js-bookmarkButton" title="Bookmark this story to read later" aria-label="Bookmark this story to read later" data-action="sign-up-prompt" data-sign-in-action="add-to-bookmarks" data-requires-token="true" data-redirect="https://medium.com/_/bookmark/p/609439e964d7" data-action-source="listing-----609439e964d7---------------------bookmark_preview"><span class="button-defaultState"><span class="svgIcon svgIcon--bookmark svgIcon--25px is-flushRight"><svg class="svgIcon-use" width="25" height="25"><path d="M19 6c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v14.66h.012c.01.103.045.204.12.285a.5.5 0 0 0 .706.03L12.5 16.85l5.662 4.126a.508.508 0 0 0 .708-.03.5.5 0 0 0 .118-.285H19V6zm-6.838 9.97L7 19.636V6c0-.55.45-1 1-1h9c.55 0 1 .45 1 1v13.637l-5.162-3.668a.49.49 0 0 0-.676 0z" fill-rule="evenodd"></path></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--bookmarkFilled svgIcon--25px is-flushRight"><svg class="svgIcon-use" width="25" height="25"><path d="M19 6c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v14.66h.012c.01.103.045.204.12.285a.5.5 0 0 0 .706.03L12.5 16.85l5.662 4.126c.205.183.52.17.708-.03a.5.5 0 0 0 .118-.285H19V6z"></path></svg></span></span></button></div></div></div></div></div></div><div class="container js-showOtherResponses"><div class="row"><button class="button button--primary button--withChrome u-accentColor--buttonNormal responsesStream-showOtherResponses cardChromeless u-width100pct u-marginVertical20 u-heightAuto" data-action="show-other-responses">Show all responses</button></div></div><div class="responsesStream js-responsesStreamOther"></div></div></div></div><div class="supplementalPostContent js-heroPromo"></div></footer></article></main><aside class="u-marginAuto u-maxWidth1032 js-postLeftSidebar"><div class="u-foreground u-top0 u-fixed u-sm-hide js-postShareWidget u-transition--fadeIn300" data-scroll="fixed" style="transform: translateY(150px);"><ul><li class="u-marginVertical10"><div class="multirecommend js-actionMultirecommend u-flexCenter" data-post-id="7158b1cdd50c" data-is-icon-29px="true" data-has-recommend-list="true" data-source="post_share_widget-----7158b1cdd50c---------------------clap_sidebar"><div class="u-relative u-foreground"><button class="button button--primary button--large button--chromeless u-accentColor--buttonNormal button--withIcon button--withSvgIcon clapButton js-actionMultirecommendButton clapButton--darker" data-action="sign-up-prompt" data-sign-in-action="multivote" data-requires-token="true" data-redirect="https://medium.com/_/vote/p/7158b1cdd50c" data-action-source="post_share_widget-----7158b1cdd50c---------------------clap_sidebar" aria-label="Clap"><span class="button-defaultState"><span class="svgIcon svgIcon--clap svgIcon--29px"><svg class="svgIcon-use" width="29" height="29"><g fill-rule="evenodd"><path d="M13.739 1l.761 2.966L15.261 1z"></path><path d="M16.815 4.776l1.84-2.551-1.43-.471z"></path><path d="M10.378 2.224l1.84 2.551-.408-3.022z"></path><path d="M22.382 22.622c-1.04 1.04-2.115 1.507-3.166 1.608.168-.14.332-.29.492-.45 2.885-2.886 3.456-5.982 1.69-9.211l-1.101-1.937-.955-2.02c-.315-.676-.235-1.185.245-1.556a.836.836 0 0 1 .66-.16c.342.056.66.28.879.605l2.856 5.023c1.179 1.962 1.379 5.119-1.6 8.098m-13.29-.528l-5.02-5.02a1 1 0 0 1 .707-1.701c.255 0 .512.098.707.292l2.607 2.607a.442.442 0 0 0 .624-.624L6.11 15.04l-1.75-1.75a.998.998 0 1 1 1.41-1.413l4.154 4.156a.44.44 0 0 0 .624 0 .44.44 0 0 0 0-.624l-4.152-4.153-1.172-1.171a.998.998 0 0 1 0-1.41 1.018 1.018 0 0 1 1.41 0l1.172 1.17 4.153 4.152a.437.437 0 0 0 .624 0 .442.442 0 0 0 0-.624L8.43 9.222a.988.988 0 0 1-.291-.705.99.99 0 0 1 .29-.706 1 1 0 0 1 1.412 0l6.992 6.993a.443.443 0 0 0 .71-.501l-1.35-2.856c-.315-.676-.235-1.185.246-1.557a.85.85 0 0 1 .66-.16c.342.056.659.28.879.606L20.628 15c1.573 2.876 1.067 5.545-1.544 8.156-1.396 1.397-3.144 1.966-5.063 1.652-1.713-.286-3.463-1.248-4.928-2.714zM12.99 6.976l2.562 2.562c-.497.607-.563 1.414-.155 2.284l.265.562-4.257-4.257a.98.98 0 0 1-.117-.445c0-.267.104-.517.292-.706a1.023 1.023 0 0 1 1.41 0zm8.887 2.06c-.375-.557-.902-.916-1.486-1.011a1.738 1.738 0 0 0-1.342.332c-.376.29-.61.656-.712 1.065a2.1 2.1 0 0 0-1.095-.562 1.776 1.776 0 0 0-.992.128l-2.636-2.636a1.883 1.883 0 0 0-2.658 0 1.862 1.862 0 0 0-.478.847 1.886 1.886 0 0 0-2.671-.012 1.867 1.867 0 0 0-.503.909c-.754-.754-1.992-.754-2.703-.044a1.881 1.881 0 0 0 0 2.658c-.288.12-.605.288-.864.547a1.884 1.884 0 0 0 0 2.659l.624.622a1.879 1.879 0 0 0-.91 3.16l5.019 5.02c1.595 1.594 3.515 2.645 5.408 2.959a7.16 7.16 0 0 0 1.173.098c1.026 0 1.997-.24 2.892-.7.279.04.555.065.828.065 1.53 0 2.969-.628 4.236-1.894 3.338-3.338 3.083-6.928 1.738-9.166l-2.868-5.043z"></path></g></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--clapFilled svgIcon--29px"><svg class="svgIcon-use" width="29" height="29"><g fill-rule="evenodd"><path d="M13.738 1l.762 2.966L15.262 1z"></path><path d="M18.634 2.224l-1.432-.47-.408 3.022z"></path><path d="M11.79 1.754l-1.431.47 1.84 2.552z"></path><path d="M24.472 14.307l-3.023-5.32c-.287-.426-.689-.705-1.123-.776a1.16 1.16 0 0 0-.911.221c-.297.231-.474.515-.535.84.017.022.036.04.053.063l2.843 5.001c1.95 3.564 1.328 6.973-1.843 10.144a8.46 8.46 0 0 1-.549.501c1.205-.156 2.328-.737 3.351-1.76 3.268-3.268 3.041-6.749 1.737-8.914"></path><path d="M14.58 10.887c-.156-.83.096-1.569.692-2.142L12.78 6.252c-.5-.504-1.378-.504-1.879 0-.178.18-.273.4-.329.63l4.008 4.005z"></path><path d="M17.812 10.04c-.218-.323-.539-.55-.88-.606a.814.814 0 0 0-.644.153c-.176.137-.713.553-.24 1.566l1.43 3.025a.539.539 0 1 1-.868.612L9.2 7.378a.986.986 0 1 0-1.395 1.395l4.401 4.403a.538.538 0 1 1-.762.762L7.046 9.54 5.802 8.295a.99.99 0 0 0-1.396 0 .981.981 0 0 0 0 1.394l1.241 1.241 4.402 4.403a.537.537 0 0 1 0 .761.535.535 0 0 1-.762 0L4.89 11.696a.992.992 0 0 0-1.399-.003.983.983 0 0 0 0 1.395l1.855 1.854 2.763 2.765a.538.538 0 0 1-.76.761l-2.765-2.764a.982.982 0 0 0-1.395 0 .989.989 0 0 0 0 1.395l5.32 5.32c3.371 3.372 6.64 4.977 10.49 1.126C21.74 20.8 22.271 18 20.62 14.982l-2.809-4.942z"></path></g></svg></span></span></button></div><span class="u-relative u-background js-actionMultirecommendCount u-marginLeft5"><button class="button button--chromeless u-baseColor--buttonNormal js-multirecommendCountButton" data-action="show-recommends" data-action-value="7158b1cdd50c">906</button></span></div></li><li class="u-marginVertical10 u-marginLeft3"><button class="button button--large button--dark button--chromeless is-touchIconFadeInPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon button--bookmark js-bookmarkButton" title="Bookmark this story to read later" aria-label="Bookmark this story to read later" data-action="sign-up-prompt" data-sign-in-action="add-to-bookmarks" data-requires-token="true" data-redirect="https://medium.com/_/bookmark/p/7158b1cdd50c" data-action-source="post_share_widget-----7158b1cdd50c---------------------bookmark_sidebar"><span class="button-defaultState"><span class="svgIcon svgIcon--bookmark svgIcon--29px"><svg class="svgIcon-use" width="29" height="29"><path d="M19.385 4h-9.77A2.623 2.623 0 0 0 7 6.615V23.01a1.022 1.022 0 0 0 1.595.847l5.905-4.004 5.905 4.004A1.022 1.022 0 0 0 22 23.011V6.62A2.625 2.625 0 0 0 19.385 4zM21 23l-5.91-3.955-.148-.107a.751.751 0 0 0-.884 0l-.147.107L8 23V6.615C8 5.725 8.725 5 9.615 5h9.77C20.275 5 21 5.725 21 6.615V23z" fill-rule="evenodd"></path></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--bookmarkFilled svgIcon--29px"><svg class="svgIcon-use" width="29" height="29"><path d="M19.385 4h-9.77A2.623 2.623 0 0 0 7 6.615V23.01a1.022 1.022 0 0 0 1.595.847l5.905-4.004 5.905 4.004A1.022 1.022 0 0 0 22 23.011V6.62A2.625 2.625 0 0 0 19.385 4z" fill-rule="evenodd"></path></svg></span></span></button></li><li class="u-marginVertical10 u-marginLeft3"><a class="button button--dark button--chromeless u-baseColor--buttonDark button--withIcon button--withSvgIcon button--dark button--chromeless" href="https://medium.com/p/7158b1cdd50c/share/twitter" title="Share on Twitter" aria-label="Share on Twitter" target="_blank" data-action-source="post_share_widget"><span class="button-defaultState"><span class="svgIcon svgIcon--twitterFilled svgIcon--29px"><svg class="svgIcon-use" width="29" height="29"><path d="M22.053 7.54a4.474 4.474 0 0 0-3.31-1.455 4.526 4.526 0 0 0-4.526 4.524c0 .35.04.7.082 1.05a12.9 12.9 0 0 1-9.3-4.77c-.39.69-.61 1.46-.65 2.26.03 1.6.83 2.99 2.02 3.79-.72-.02-1.41-.22-2.02-.57-.01.02-.01.04 0 .08-.01 2.17 1.55 4 3.63 4.44-.39.08-.79.13-1.21.16-.28-.03-.57-.05-.81-.08.54 1.77 2.21 3.08 4.2 3.15a9.564 9.564 0 0 1-5.66 1.94c-.34-.03-.7-.06-1.05-.08 2 1.27 4.38 2.02 6.94 2.02 8.31 0 12.86-6.9 12.84-12.85.02-.24.01-.43 0-.65.89-.62 1.65-1.42 2.26-2.34-.82.38-1.69.62-2.59.72a4.37 4.37 0 0 0 1.94-2.51c-.84.53-1.81.9-2.83 1.13z"></path></svg></span></span></a></li><li class="u-marginVertical10 u-marginLeft3"><a class="button button--dark button--chromeless u-baseColor--buttonDark button--withIcon button--withSvgIcon button--dark button--chromeless" href="https://medium.com/p/7158b1cdd50c/share/facebook" title="Share on Facebook" aria-label="Share on Facebook" target="_blank" data-action-source="post_share_widget"><span class="button-defaultState"><span class="svgIcon svgIcon--facebookSquare svgIcon--29px"><svg class="svgIcon-use" width="29" height="29"><path d="M23.209 5H5.792A.792.792 0 0 0 5 5.791V23.21c0 .437.354.791.792.791h9.303v-7.125H12.72v-2.968h2.375v-2.375c0-2.455 1.553-3.662 3.741-3.662 1.049 0 1.95.078 2.213.112v2.565h-1.517c-1.192 0-1.469.567-1.469 1.397v1.963h2.969l-.594 2.968h-2.375L18.11 24h5.099a.791.791 0 0 0 .791-.791V5.79a.791.791 0 0 0-.791-.79"></path></svg></span></span></a></li></ul></div></aside><div class="u-fixed u-bottom0 u-width100pct u-backgroundWhite u-boxShadowTop u-borderBox u-paddingTop10 u-paddingBottom10 u-zIndexMetabar u-xs-hide js-stickyFooter"><div class="u-maxWidth700 u-marginAuto u-flexCenter"><div class="u-fontSize16 u-flex1 u-flexCenter"><div class="u-flex0 u-inlineBlock u-paddingRight20"><a class="link u-baseColor--link avatar u-inline" href="https://medium.com/@tylerneely" data-action="show-user-card" data-action-value="5145b6327de1" data-action-type="hover" data-user-id="5145b6327de1" dir="auto"><img src="./Fear and Loathing in Lock-Free Programming – Tyler Neely – Medium_files/1_O4KHGpH9QQ0mYamqf_76yA(3).jpeg" class="avatar-image avatar-image--smaller" alt="Go to the profile of Tyler Neely"></a></div><div class="u-flex1 u-inlineBlock">Never miss a story from<strong> Tyler Neely</strong>, when you sign up for Medium. <a class="link u-baseColor--link link--accent u-accentColor--textNormal u-accentColor--textDarken" href="https://medium.com/@Medium/personalize-your-medium-experience-with-users-publications-tags-26a41ab1ee0c#.hx4zuv3mg" data-action-source="sticky_footer">Learn more</a></div></div><div class="u-marginLeft50"><span class="followState js-followState" data-user-id="5145b6327de1"><button class="button u-noUserSelect button--withChrome u-baseColor--buttonNormal button--withHover button--unblock js-unblockButton u-uiTextSemibold u-textUppercase u-fontSize12" data-action="sign-up-prompt" data-sign-in-action="toggle-block-user" data-requires-token="true" data-redirect="https://medium.com/@tylerneely/fear-and-loathing-in-lock-free-programming-7158b1cdd50c" data-action-source="sticky_footer"><span class="button-label  button-defaultState">Blocked</span><span class="button-label button-hoverState">Unblock</span></button><button class="button button--primary is-active u-noUserSelect button--withChrome u-accentColor--buttonNormal button--follow js-followButton u-uiTextSemibold u-textUppercase u-fontSize12" data-action="sign-up-prompt" data-sign-in-action="toggle-subscribe-user" data-requires-token="true" data-redirect="https://medium.com/_/subscribe/user/5145b6327de1" data-action-source="sticky_footer-5145b6327de1-------------------------follow_metabar"><span class="button-label  button-defaultState js-buttonLabel">Follow</span><span class="button-label button-activeState">Get updates</span></button></span></div></div></div><div class="highlightMenu" data-action-scope="_actionscope_3"><div class="highlightMenu-inner"><div class="buttonSet"><button class="button button--chromeless u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--highlightMenu u-accentColor--highlightStrong js-highlightMenuQuoteButton" data-action="sign-up-prompt" data-sign-in-action="quote" data-requires-token="true" data-skip-onboarding="true" data-redirect-type="quote" data-action-source="quote_menu--------------------------highlight_text"><span class="svgIcon svgIcon--highlighter svgIcon--25px"><svg class="svgIcon-use" width="25" height="25"><path d="M13.7 15.964l5.204-9.387-4.726-2.62-5.204 9.387 4.726 2.62zm-.493.885l-1.313 2.37-1.252.54-.702 1.263-3.796-.865 1.228-2.213-.202-1.35 1.314-2.37 4.722 2.616z" fill-rule="evenodd"></path></svg></span></button><button class="button button--chromeless u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--highlightMenu" data-action="sign-up-prompt" data-sign-in-action="quote-respond" data-redirect="https://medium.com/@tylerneely/fear-and-loathing-in-lock-free-programming-7158b1cdd50c" data-skip-onboarding="true" data-action-source="quote_menu--------------------------respond_text"><span class="svgIcon svgIcon--responseFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25"><path d="M19.074 21.117c-1.244 0-2.432-.37-3.532-1.096a7.792 7.792 0 0 1-.703-.52c-.77.21-1.57.32-2.38.32-4.67 0-8.46-3.5-8.46-7.8C4 7.7 7.79 4.2 12.46 4.2c4.662 0 8.457 3.5 8.457 7.803 0 2.058-.85 3.984-2.403 5.448.023.17.06.35.118.55.192.69.537 1.38 1.026 2.04.15.21.172.48.058.7a.686.686 0 0 1-.613.38h-.03z" fill-rule="evenodd"></path></svg></span></button><a class="button button--chromeless u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--chromeless button--highlightMenu js-highlightMenuTwitterShare" href="https://medium.com/p/7158b1cdd50c/share/twitter" title="Share on Twitter" aria-label="Share on Twitter" target="_blank" data-action="twitter"><span class="button-defaultState"><span class="svgIcon svgIcon--twitterFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25"><path d="M21.725 5.338c-.744.47-1.605.804-2.513 1.006a3.978 3.978 0 0 0-2.942-1.293c-2.22 0-4.02 1.81-4.02 4.02 0 .32.034.63.07.94-3.31-.18-6.27-1.78-8.255-4.23a4.544 4.544 0 0 0-.574 2.01c.04 1.43.74 2.66 1.8 3.38-.63-.01-1.25-.19-1.79-.5v.08c0 1.93 1.38 3.56 3.23 3.95-.34.07-.7.12-1.07.14-.25-.02-.5-.04-.72-.07.49 1.58 1.97 2.74 3.74 2.8a8.49 8.49 0 0 1-5.02 1.72c-.3-.03-.62-.04-.93-.07A11.447 11.447 0 0 0 8.88 21c7.386 0 11.43-6.13 11.414-11.414.015-.21.01-.38 0-.578a7.604 7.604 0 0 0 2.01-2.08 7.27 7.27 0 0 1-2.297.645 3.856 3.856 0 0 0 1.72-2.23"></path></svg></span></span></a><div class="buttonSet-separator"></div><button class="button button--chromeless u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--highlightMenu" data-action="sign-up-prompt" data-sign-in-action="highlight" data-redirect="https://medium.com/@tylerneely/fear-and-loathing-in-lock-free-programming-7158b1cdd50c" data-skip-onboarding="true" data-action-source="quote_menu--------------------------privatenote_text"><span class="svgIcon svgIcon--privatenoteFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25"><g fill-rule="evenodd"><path d="M17.662 4.552H7.346A4.36 4.36 0 0 0 3 8.898v5.685c0 2.168 1.614 3.962 3.697 4.28v2.77c0 .303.35.476.59.29l3.904-2.994h6.48c2.39 0 4.35-1.96 4.35-4.35V8.9c0-2.39-1.95-4.346-4.34-4.346zM16 14.31a.99.99 0 0 1-1.003.99h-4.994C9.45 15.3 9 14.85 9 14.31v-3.02a.99.99 0 0 1 1-.99v-.782a2.5 2.5 0 0 1 2.5-2.51c1.38 0 2.5 1.13 2.5 2.51v.782c.552.002 1 .452 1 .99v3.02z"></path><path d="M14 9.81c0-.832-.674-1.68-1.5-1.68-.833 0-1.5.84-1.5 1.68v.49h3v-.49z"></path></g></svg></span></button></div></div><div class="highlightMenu-arrowClip"><span class="highlightMenu-arrow"></span></div></div></div></div></div><div class="loadingBar"></div><script>// <![CDATA[
window["obvInit"] = function (opt_embedded) {window["obvInit"]["embedded"] = opt_embedded; window["obvInit"]["ready"] = true;}
// ]]></script><script>// <![CDATA[
var GLOBALS = {"audioUrl":"https://d1fcbxp97j4nb2.cloudfront.net","baseUrl":"https://medium.com","buildLabel":"37449-690cd6d","currentUser":{"userId":"lo_gvVNDg0gn33i","isVerified":false,"subscriberEmail":"","hasPastMemberships":false,"isEnrolledInHightower":false,"isEligibleForHightower":false,"hightowerLastLockedAt":0,"isWriterProgramEnrolled":true,"isWriterProgramInvited":false,"isWriterProgramOptedOut":false,"writerProgramVersion":0,"writerProgramEnrolledAt":0,"friendLinkOnboarding":0,"hasAdditionalUnlocks":false,"hasApiAccess":false,"isQuarantined":false,"writerProgramDistributionSettingOptedIn":false},"currentUserHasUnverifiedEmail":false,"isAuthenticated":false,"isCurrentUserVerified":false,"language":"en-us","miroUrl":"https://cdn-images-1.medium.com","moduleUrls":{"base":"https://cdn-static-1.medium.com/_/fp/gen-js/main-base.bundle.6gqBcKeh0YZDyRXg4TP8Yw.js","common-async":"https://cdn-static-1.medium.com/_/fp/gen-js/main-common-async.bundle.rXtnGC3lh3DgPxAbxNEJ9g.js","hightower":"https://cdn-static-1.medium.com/_/fp/gen-js/main-hightower.bundle.sLkuCWNvdZ5xsgqZsmm1Yw.js","home-screens":"https://cdn-static-1.medium.com/_/fp/gen-js/main-home-screens.bundle.zclT9M54WRnl9mJAsUxkMQ.js","misc-screens":"https://cdn-static-1.medium.com/_/fp/gen-js/main-misc-screens.bundle.BuQ-CllN3y60RgKOK14lJQ.js","notes":"https://cdn-static-1.medium.com/_/fp/gen-js/main-notes.bundle.AqavCggV_d_gUgROE7qqTA.js","payments":"https://cdn-static-1.medium.com/_/fp/gen-js/main-payments.bundle.gP-qPsDqTlV0hPkXtlRGFw.js","posters":"https://cdn-static-1.medium.com/_/fp/gen-js/main-posters.bundle.If7jr0T6hTnQ5kURydxZIg.js","power-readers":"https://cdn-static-1.medium.com/_/fp/gen-js/main-power-readers.bundle.z2-CQZxvH1sR6LwUnJeG5Q.js","pubs":"https://cdn-static-1.medium.com/_/fp/gen-js/main-pubs.bundle.ZSC5r2BdxpM99UQZRc0RYA.js","stats":"https://cdn-static-1.medium.com/_/fp/gen-js/main-stats.bundle.AENJ3OH31csXsHTnMobCsg.js"},"previewConfig":{"weightThreshold":1,"weightImageParagraph":0.51,"weightIframeParagraph":0.8,"weightTextParagraph":0.08,"weightEmptyParagraph":0,"weightP":0.003,"weightH":0.005,"weightBq":0.003,"minPTextLength":60,"truncateBoundaryChars":20,"detectTitle":true,"detectTitleLevThreshold":0.15},"productName":"Medium","supportsEdit":true,"termsUrl":"//medium.com/policy/9db0094a1e0f","textshotHost":"textshot.medium.com","transactionId":"1557171313742:6b18fe774ae6","useragent":{"browser":"chrome","family":"chrome","os":"mac","version":73,"supportsDesktopEdit":true,"supportsInteract":true,"supportsView":true,"isMobile":false,"isTablet":false,"isNative":false,"supportsFileAPI":true,"isTier1":true,"clientVersion":"","unknownParagraphsBad":false,"clientChannel":"","supportsRealScrollEvents":true,"supportsVhUnits":true,"ruinsViewportSections":false,"supportsHtml5Video":true,"supportsMagicUnderlines":true,"isWebView":false,"isFacebookWebView":false,"supportsProgressiveMedia":true,"supportsPromotedPosts":true,"isBot":false,"isNativeIphone":false,"supportsCssVariables":true,"supportsVideoSections":true,"emojiSupportLevel":5,"isSearchBot":false,"isSyndicationBot":false,"isNativeAndroid":false,"isNativeIos":false,"supportsScrollableMetabar":true},"variants":{"allow_access":true,"allow_signup":true,"allow_test_auth":"disallow","signin_services":"twitter,facebook,google,email,google-fastidv,google-one-tap","signup_services":"twitter,facebook,google,email,google-fastidv,google-one-tap","google_sign_in_android":true,"reengagement_notification_duration":3,"browsable_stream_config_bucket":"curated-topics","enable_dedicated_series_tab_api_ios":true,"enable_post_import":true,"available_monthly_plan":"60e220181034","available_annual_plan":"2c754bcc2995","disable_ios_resume_reading_toast":true,"is_not_medium_subscriber":true,"glyph_font_set":"m2","enable_branding":true,"enable_branding_fonts":true,"max_premium_content_per_user_under_metering":3,"enable_automated_mission_control_triggers":true,"enable_lite_profile":true,"enable_marketing_emails":true,"enable_topic_lifecycle_email":true,"enable_parsely":true,"enable_branch_io":true,"enable_ios_post_stats":true,"enable_lite_topics":true,"enable_lite_stories":true,"redis_read_write_splitting":true,"enable_tipalti_onboarding":true,"enable_annual_renewal_reminder_email":true,"enable_janky_spam_rules":"users,posts","enable_new_collaborative_filtering_data":true,"android_rating_prompt_stories_read_threshold":2,"stripe_v3":true,"enable_google_one_tap":true,"enable_email_sign_in_captcha":true,"enable_rito_with_viewer_query":true,"enable_rito_with_flag_query":true,"enable_rito_post_handler":true,"enable_rito_sequence_post_recirc_query":true,"enable_rito_post_recirc_query":true,"enable_rito_topic_handler":true,"enable_rito_stats_post_handler":true,"enable_rito_stats_post_chart":true,"enable_rito_lifetime_earnings_tooltip":true,"enable_rito_stats_post_referrers_container":true,"enable_rito_post_feature_mutation":true,"enable_rito_post_unfeature_mutation":true,"enable_rito_quote_delete_mutation":true,"enable_rito_user_block_mutation":true,"enable_rito_user_unblock_mutation":true,"enable_rito_report_user_link":true,"enable_rito_bookmark_post_default":true,"enable_rito_unbookmark_post_default":true,"enable_rito_archive_post_default":true,"enable_rito_unarchive_post_default":true,"enable_rito_clap":true,"enable_rito_subscribe_series":true,"enable_rito_unsubscribe_series":true,"enable_rito_follow_topic":true,"enable_rito_unfollow_topic":true,"enable_rito_follow_user":true,"enable_rito_unfollow_user":true,"enable_rito_your_story_delete_mutation":true,"enable_rito_update_last_read_section":true,"enable_primary_topic_for_mobile":true,"enable_rito_sequence_post_handler":true,"enable_todays_highlights_android":true,"enable_logged_out_homepage_signup":true,"use_new_admin_topic_backend":true,"enable_quarantine_rules":true,"enable_lite_privacy_banner":true,"enable_patronus_on_kubernetes":true,"pub_sidebar":true,"enable_rito_user_profile_overview_handler":true,"enable_rito_user_stream_overview":true,"enable_rito_user_profile_latest_handler":true,"enable_rito_user_stream_latest":true,"enable_rito_user_profile_actions":true,"enable_rito_post_actions":true,"enable_rito_user_profile_highlights_handler":true,"enable_rito_user_stream_highlights":true,"enable_rito_user_profile_series_handler":true,"enable_rito_user_stream_series":true,"enable_rito_user_profile_claps_handler":true,"enable_rito_user_stream_claps":true,"enable_rito_user_profile_responses_handler":true,"enable_rito_user_stream_responses":true,"enable_rito_billing_history_handler":true,"enable_rito_your_stories_handler":true,"enable_rito_sequence_library_handler":true,"enable_rito_series_handler":true,"enable_rito_amppost_handler":true,"enable_rito_follow_collection_mutation":true,"enable_rito_unfollow_collection_mutation":true,"enable_may_meter_email_test":true,"enable_rex_app_highlights":true,"enable_new_user_avatar_dropdown_menu":true},"xsrfToken":"","iosAppId":"828256236","supportEmail":"yourfriends@medium.com","fp":{"/icons/monogram-mask.svg":"https://cdn-static-1.medium.com/_/fp/icons/monogram-mask.KPLCSFEZviQN0jQ7veN2RQ.svg","/icons/favicon-dev-editor.ico":"https://cdn-static-1.medium.com/_/fp/icons/favicon-dev-editor.YKKRxBO8EMvIqhyCwIiJeQ.ico","/icons/favicon-hatch-editor.ico":"https://cdn-static-1.medium.com/_/fp/icons/favicon-hatch-editor.BuEyHIqlyh2s_XEk4Rl32Q.ico","/icons/favicon-medium-editor.ico":"https://cdn-static-1.medium.com/_/fp/icons/favicon-medium-editor.PiakrZWB7Yb80quUVQWM6g.ico"},"authBaseUrl":"https://medium.com","imageUploadSizeMb":25,"isAuthDomainRequest":true,"algoliaApiEndpoint":"https://MQ57UUUQZ2-dsn.algolia.net","algoliaAppId":"MQ57UUUQZ2","algoliaSearchOnlyApiKey":"394474ced050e3911ae2249ecc774921","iosAppStoreUrl":"https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8","iosAppLinkBaseUrl":"medium:","algoliaIndexPrefix":"medium_","androidPlayStoreUrl":"https://play.google.com/store/apps/details?id=com.medium.reader","googleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","androidPackage":"com.medium.reader","androidPlayStoreMarketScheme":"market://details?id=com.medium.reader","googleAuthUri":"https://accounts.google.com/o/oauth2/auth","androidScheme":"medium","layoutData":{"useDynamicScripts":false,"googleAnalyticsTrackingCode":"UA-24232453-2","jsShivUrl":"https://cdn-static-1.medium.com/_/fp/js/shiv.RI2ePTZ5gFmMgLzG5bEVAA.js","useDynamicCss":false,"faviconUrl":"https://cdn-static-1.medium.com/_/fp/icons/favicon-rebrand-medium.3Y6xpZ-0FSdWDnPM3hSBIA.ico","faviconImageId":"1*8I-HPL0bfoIzGied-dzOvA.png","fontSets":[{"id":8,"url":"https://glyph.medium.com/css/e/sr/latin/e/ssr/latin/e/ssb/latin/m2.css"},{"id":11,"url":"https://glyph.medium.com/css/m2.css"},{"id":9,"url":"https://glyph.medium.com/css/mkt.css"}],"editorFaviconUrl":"https://cdn-static-1.medium.com/_/fp/icons/favicon-rebrand-medium-editor.3Y6xpZ-0FSdWDnPM3hSBIA.ico","glyphUrl":"https://glyph.medium.com"},"authBaseUrlRev":"moc.muidem//:sptth","isDnt":false,"stripePublishableKey":"pk_live_7FReX44VnNIInZwrIIx6ghjl","archiveUploadSizeMb":100,"paymentData":{"currencies":{"1":{"label":"US Dollar","external":"usd"}},"countries":{"1":{"label":"United States of America","external":"US"}},"accountTypes":{"1":{"label":"Individual","external":"individual"},"2":{"label":"Company","external":"company"}}},"previewConfig2":{"weightThreshold":1,"weightImageParagraph":0.05,"raiseImage":true,"enforceHeaderHierarchy":true,"isImageInsetRight":true},"isAmp":false,"iosScheme":"medium","isSwBoot":false,"lightstep":{"accessToken":"ce5be895bef60919541332990ac9fef2","carrier":"{\"ot-tracer-spanid\":\"768e84184ecbadd5\",\"ot-tracer-traceid\":\"50b0d14d0f23eb04\",\"ot-tracer-sampled\":\"true\"}","host":"collector-medium.lightstep.com"},"facebook":{"key":"542599432471018","namespace":"medium-com","scope":{"default":["public_profile","email"],"connect":["public_profile","email"],"login":["public_profile","email"],"share":["public_profile","email"]}},"editorsPicksTopicId":"3985d2a191c5","popularOnMediumTopicId":"9d34e48ecf94","memberContentTopicId":"13d7efd82fb2","audioContentTopicId":"3792abbd134","brandedSequenceId":"7d337ddf1941","isDoNotAuth":false,"buggle":{"url":"https://buggle.medium.com","videoUrl":"https://cdn-videos-1.medium.com","audioUrl":"https://cdn-audio-1.medium.com"},"referrerType":2,"isMeteredOut":false,"meterConfig":{"maxUnlockCount":3,"windowLength":"MONTHLY"},"partnerProgramEmail":"partnerprogram@medium.com","userResearchPrompts":[{"promptId":"lo_post_page_4","type":0,"url":"www.calendly.com"},{"promptId":"lo_home_page","type":1,"url":"www.calendly.com"},{"promptId":"lo_profile_page","type":2,"url":"www.calendly.com"}],"recaptchaKey":"6LdAokEUAAAAAC7seICd4vtC8chDb3jIXDQulyUJ","signinWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"countryCode":"US","bypassMeter":false,"branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm","paypal":{"clientMode":"production","oneYearGift":{"name":"Medium Membership (1 Year, Digital Gift Code)","description":"Unlimited access to the best and brightest stories on Medium. Gift codes can be redeemed at medium.com/redeem.","price":"50.00","currency":"USD","sku":"membership-gift-1-yr"}},"collectionConfig":{"mediumOwnedAndOperatedCollectionIds":["544c7006046e // Human Parts","bcc38c8f6edf // Matter","444d13b52878 // OneZero","8d6b8a439e32 // Elemental","92d2092dc598 // Gay Mag","1285ba81cada // Heated"]}}
// ]]></script><script charset="UTF-8" src="./Fear and Loathing in Lock-Free Programming – Tyler Neely – Medium_files/main-base.bundle.6gqBcKeh0YZDyRXg4TP8Yw.js" async=""></script><script>// <![CDATA[
window["obvInit"]({"value":{"id":"7158b1cdd50c","versionId":"ca13f283f847","creatorId":"5145b6327de1","creator":{"userId":"5145b6327de1","name":"Tyler Neely","username":"tylerneely","createdAt":1479810155900,"imageId":"1*O4KHGpH9QQ0mYamqf_76yA.jpeg","backgroundImageId":"","bio":"webmaster http://tylerneely.com","twitterScreenName":"sadisticsystems","socialStats":{"userId":"5145b6327de1","usersFollowedCount":155,"usersFollowedByCount":248,"type":"SocialStats"},"social":{"userId":"lo_gvVNDg0gn33i","targetUserId":"5145b6327de1","type":"Social"},"facebookAccountId":"","allowNotes":1,"mediumMemberAt":0,"isNsfw":false,"isWriterProgramEnrolled":true,"isQuarantined":false,"type":"User"},"homeCollectionId":"","title":"Fear and Loathing in Lock-Free Programming","detectedLanguage":"en","latestVersion":"ca13f283f847","latestPublishedVersion":"ca13f283f847","hasUnpublishedEdits":false,"latestRev":2253,"createdAt":1506516744644,"updatedAt":1524131572078,"acceptedAt":0,"firstPublishedAt":1507552809305,"latestPublishedAt":1507726518442,"vote":false,"experimentalCss":"","displayAuthor":"","content":{"subtitle":"What follows is a whirlwind tour of an area of programming usually only whispered of and seldom explored, perhaps for good reason…","bodyModel":{"paragraphs":[{"name":"0191","type":3,"text":"Fear and Loathing in Lock-Free Programming","markups":[]},{"name":"7eb4","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"1*ImXIA0dmgvgTRjiSisY-HQ.jpeg","originalWidth":800,"originalHeight":600}},{"name":"d2ac","type":1,"text":"What follows is a whirlwind tour of an area of programming usually only whispered of and seldom explored, perhaps for good reason. Lock-free techniques allow multiple threads to work together in a non-blocking way, often achieving incredible performance. As the name suggests, locks are not used. If the idea of a multithreaded program without mutexes makes you uncomfortable, you are quite sane.","markups":[]},{"name":"0cce","type":1,"text":"Yet lock-free systems are pervasive. Some memory allocators rely on a lock-free radix tree at their core, such as jemalloc. If you have used a queue or channel to communicate between threads, there’s an excellent chance the underlying structure was lock-free. If you have used a language with atomic reference counters, there are lock-free techniques employed throughout the lifetime of objects that use them. Even high-performance databases that avoid the overhead of concurrent structures in their data path still usually rely on a lock-free queue of some sort to communicate across threads.","markups":[{"type":3,"start":415,"end":441,"href":"http://www.seastar-project.org/","title":"","rel":"","anchorType":0},{"type":3,"start":510,"end":562,"href":"https://github.com/scylladb/seastar/blob/c62bbf9ca7b8a09941586e40645177fcf1bffd72/core/reactor.hh#L295","title":"","rel":"","anchorType":0}]},{"name":"fd8c","type":1,"text":"Most respectable engineers know to avoid lock-free techniques at all costs. Just like threading, distributed systems or any of the myriad human productivity sinks that are better sidestepped with a refactor or more powerful hardware. If you can use one thread, you should.","markups":[]},{"name":"7312","type":1,"text":"Single-threaded systems are infinitely easier to reason about, will have fewer bugs, and usually have better per-thread performance anyway due to not needing to block on a mutex or disrupt CPU progress with memory barriers. When you must use concurrency, you can sometimes get comparable or better performance than lock-free techniques by using fine-grained mutexes.","markups":[]},{"name":"cf43","type":1,"text":"As someone who finds bugs in systems for fun and profit (occasionally successfully!) let me be clear:","markups":[{"type":1,"start":85,"end":100}]},{"name":"d4ca","type":4,"text":"Say no to lock-free algorithms! Say yes to pizza!","markups":[],"layout":1,"metadata":{"id":"1*MbItv9J5KMGqnpMlUmgQZA.jpeg","originalWidth":1000,"originalHeight":1500}},{"name":"86f2","type":1,"text":"Artisanal lock-free algorithms are symptomatic of a long chain of bad decisions. They are almost impossible to correctly write. As far as I can tell, there are only two people who actually know how to write them. These algorithms are extremely difficult to reason about, and you will be forever haunted by the real possibility that you missed some critical assumption.","markups":[{"type":3,"start":165,"end":168,"href":"http://www.1024cores.net/","title":"","rel":"noopener","anchorType":0},{"type":3,"start":169,"end":175,"href":"https://www.youtube.com/watch?v=c1gO9aB9nbs","title":"","rel":"noopener","anchorType":0}],"hasDropCap":true},{"name":"b5dc","type":1,"text":"Lock-free algorithms often require knowledge of obscure tooling to verify, and usually violate the single-writer principle. If you’re lucky enough to have found a bug you created, it could be quite challenging to reproduce it. Sometimes in mailing lists you see stuff like “I ran it for 38 hours on a test cluster and it didn’t blow up, but I just thought of this theoretical edge case I haven’t been able to reproduce yet and I think may be possible.” (I’ll cover the issues of exhaustive and deterministic testing in a future post featuring using ptrace and some tricks I found in a shady exploit crafter’s toolbox to tease out bugs!)","markups":[{"type":3,"start":48,"end":63,"href":"https://www.learntla.com/introduction/example/","title":"","rel":"","anchorType":0},{"type":3,"start":95,"end":122,"href":"https://mechanical-sympathy.blogspot.de/2011/09/single-writer-principle.html","title":"","rel":"","anchorType":0}]},{"name":"5c34","type":1,"text":"So, without further ado, let’s ignore our better judgement and light ourselves on fire!","markups":[]},{"name":"dfb2","type":3,"text":"Lock-Free 101","markups":[]},{"name":"c0ac","type":1,"text":"In lock-free programming, we don’t use mutexes. Too safe, they say. Too luxurious an abstraction for the bleeding edge. Some folks go so far as to intentionally trigger race conditions or dangling pointers just to get high on performance. The depravity in this world runs deep…","markups":[{"type":3,"start":169,"end":184,"href":"https://www.youtube.com/watch?v=3LcNHxBJw2Q","title":"","rel":"noopener","anchorType":0},{"type":3,"start":188,"end":205,"href":"http://www.artima.com/lejava/articles/azul_pauseless_gc.html","title":"","rel":"noopener","anchorType":0},{"type":1,"start":147,"end":160}]},{"name":"8145","type":13,"text":"Roadmap","markups":[]},{"name":"faab","type":1,"text":"Atomic operations will be our gateway drug. We will advance through spinlocks, stacks and transactions. A typical tale of overindulgence before crashing hard, being dealt a harsh lesson in the ABA problem and finally ending up in a 8-step responsible implementation program.","markups":[]},{"name":"7fee","type":1,"text":"Please note that some of my examples come from the world of distributed systems, which I am more familiar with, although the (utterly depraved) mindset is generally similar.","markups":[]},{"name":"47d0","type":13,"text":"Atomic Operations","markups":[]},{"name":"1ddf","type":1,"text":"Atomicity, for the purposes of this article, can be interpreted to mean indivisible, uninterruptible, and either 100% successful or 100% unsuccessful. It is impossible to witness a half-complete atomic operation. Examples of things that are atomic are database transactions (but not always as you expect), the mv command found on most unix-like systems, breaking a glass window (it’s either broken or not, never something in-between), etc…","markups":[{"type":10,"start":310,"end":312},{"type":3,"start":275,"end":303,"href":"https://github.com/ept/hermitage","title":"","rel":"","anchorType":0},{"type":3,"start":306,"end":320,"href":"https://rcrowley.org/2010/01/06/things-unix-can-do-atomically.html","title":"","rel":"","anchorType":0}]},{"name":"8f86","type":1,"text":"Several of the most popular CPU architectures have instructions that let you atomically set memory to a new value conditionally if you know the current value. This is called “test and set” (TAS), “compare and swap”, or “compare and set” (CAS). The hardware makes sure that only one thread “wins” if several threads attempt a CAS at the same time. All others are unsuccessful. The return value varies across implementations, but a good implementation clearly indicates success or failure.","markups":[]},{"name":"64a5","type":1,"text":"CAS(variable, old, new) is the shorthand I will use. If variable is set to 0 then CAS(variable, 0, 1) would succeed, as long as another thread didn’t change the value while we weren’t looking. Then CAS(variable, 1, 0) would set it back. But CAS(variable, \"hot garbage\", 0) would not work unless one of our thread friends has given variablea surprise hot-garbage makeover ;) If several threads try to do CAS(variable, 0, 1) at the same time when the value was set to 0, only one of them will succeed.","markups":[{"type":10,"start":0,"end":23},{"type":10,"start":56,"end":65},{"type":10,"start":75,"end":76},{"type":10,"start":82,"end":101},{"type":10,"start":198,"end":217},{"type":10,"start":241,"end":272},{"type":10,"start":331,"end":339},{"type":10,"start":403,"end":422},{"type":10,"start":466,"end":467}]},{"name":"6a96","type":1,"text":"The amount of data that CAS can operate on is usually limited to the “word size” of the system it’s running on, which is usually the same as the length of a memory address. F̶o̶r̶ ̶x̶8̶6̶_̶6̶4̶,̶ ̶y̶o̶u̶’̶r̶e̶ ̶s̶t̶u̶c̶k̶ ̶w̶i̶t̶h̶ ̶a̶t̶ ̶m̶o̶s̶t̶ ̶6̶4̶ ̶b̶i̶t̶s̶ ̶o̶f̶ ̶c̶o̶m̶p̶a̶r̶a̶t̶i̶v̶e̶ ̶p̶o̶w̶e̶r̶. (edit: x86_64 actually has a 128-bit CAS, although it’s not available from languages like Go, Java, or Rust. Thanks robgssp!) 32-bit architectures often have a double-word “DCAS” that can work on 64 bits. But one word is usually sufficient for use with pointers, counters, bit-packed headers, and all kinds of interesting stuff.","markups":[{"type":3,"start":330,"end":347,"href":"http://www.felixcloutier.com/x86/CMPXCHG8B:CMPXCHG16B.html","title":"","rel":"noopener","anchorType":0},{"type":3,"start":423,"end":430,"href":"https://lobste.rs/u/robgssp","title":"","rel":"noopener","anchorType":0}]},{"name":"8264","type":1,"text":"One sees some really creative uses of space in the lock-free world, it reminds me of the clever tricks people do in the Demoscene to squeeze every last drop of functionality out of a single bit. But this often imposes limits on portability. I’ll touch on some creative ways to use the few bits CAS can compare in the Mitigating ABA section below.","markups":[{"type":3,"start":120,"end":129,"href":"https://en.wikipedia.org/wiki/Demoscene","title":"","rel":"","anchorType":0},{"type":3,"start":317,"end":331,"href":"#808e","title":"","rel":"","anchorType":0}]},{"name":"6fa8","type":1,"text":"And yet, CAS is an extremely powerful primitive! More than enough rope to hang ourselves with! Let’s build a teetering tower of abstractions that could collapse at any second with the slightest misplaced assumption!","markups":[]},{"name":"9681","type":13,"text":"A Simple Spinlock","markups":[]},{"name":"34d9","type":1,"text":"We can gaze into our past lives of locked leisure by implementing a spinlock in just a few lines. This is not a lock-free algorithm because threads will block until the lock is acquired, but it will illustrate the idea of threads coordinating by using atomic operations. We will spin in a loop until we can successfully change a lock variable from unlocked to locked. Only one thread will be granted exclusive access at a time! Assuming we didn’t accidentally create a spy…","markups":[{"type":2,"start":428,"end":473}]},{"name":"c117","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"858189f7e7eefc1a3a87d3ea69eecd07","thumbnailUrl":"https://i.embed.ly/1/image?url=https%3A%2F%2Favatars0.githubusercontent.com%2Fu%2F1505488%3Fv%3D4%26s%3D400&key=a19fcc184b9711e1b4764040d3dc5c07"}},{"name":"179e","type":1,"text":"Even though a spinlock is burning power in a tight loop until it succeeds, it actually is sometimes preferred over a traditional mutex. Traditional mutexes put a thread to sleep when they block, increasing the minimum latency for acquiring them from another thread. Modern mutexes are often a hybrid approach between a spinlock and a traditional mutex. Hybrid mutexes will attempt to acquire the lock quickly in userspace using atomic operations, without giving away their kernel-scheduled appointment on the CPU core. If the gambit didn’t pan out, the hybrid mutex will put the thread to sleep with a blocking syscall.","markups":[{"type":3,"start":291,"end":308,"href":"http://man7.org/linux/man-pages/man7/futex.7.html","title":"","rel":"","anchorType":0}]},{"name":"8168","type":1,"text":"Many real-world implementations of spinlocks for x86 will issue a PAUSE instruction while spinning, which improves their efficiency dramatically. In addition to spinlocks avoiding the kernel scheduling overhead of going to sleep and waking up again, we also avoid CPU frequency scaling slowdowns that can happen while blocked on a mutex, so when we enter our critical section we don’t need to pay a start-up tax.","markups":[{"type":10,"start":66,"end":71},{"type":3,"start":53,"end":97,"href":"https://geidav.wordpress.com/2016/03/23/test-and-set-spinlocks/","title":"","rel":"","anchorType":0}]},{"name":"c9c2","type":1,"text":"There are still some cases when you would prefer a straight-up spinlock, like if you know the expected time to acquire the lock is less expensive to you than the overhead of a modern hybrid mutex, or if you want a piece of code to be extremely responsive at the cost of some other system resource like power. But as the expected time to acquire the lock goes up, the balance shifts in favor of the mutex (mutexes in most popular threaded languages use the hybrid approach today).","markups":[]},{"name":"c752","type":13,"text":"A Treiber Stack","markups":[]},{"name":"1895","type":1,"text":"A Treiber stack will be our first true lock-free structure! It looks a lot like a linked list, with a head that points to the tip and nodes that point to the next node. We can push things into a lock-free stack like this:","markups":[]},{"name":"9948","type":10,"text":"Create a node (effectively the same as a linked-list node)","markups":[]},{"name":"c5da","type":10,"text":"Read the current stack.head and set our node.next to it.","markups":[{"type":10,"start":17,"end":27},{"type":10,"start":40,"end":49}]},{"name":"2069","type":10,"text":"CAS the stack’s head from the head to our new node. If it worked, we’re done! If not, GOTO 2.","markups":[]},{"name":"49d6","type":1,"text":"Popping the stack is similar:","markups":[]},{"name":"b13a","type":10,"text":"Read the current stack.head. If it’s not set, either retry or return nothing depending on if you have blocking or non-blocking semantics. The example below is non-blocking, and returns nothing.","markups":[{"type":10,"start":17,"end":27}]},{"name":"ae44","type":10,"text":"If head is set, we try to pop it. Try to CAS the stack’s headto its head.nextvalue. If it worked, return the now-severed head! Otherwise GOTO 1.","markups":[{"type":10,"start":57,"end":61},{"type":10,"start":68,"end":77}]},{"name":"6fb5","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"48ed7f1625d6ba77b21c13b43991c2e2","thumbnailUrl":"https://i.embed.ly/1/image?url=https%3A%2F%2Favatars0.githubusercontent.com%2Fu%2F1505488%3Fv%3D4%26s%3D400&key=a19fcc184b9711e1b4764040d3dc5c07"}},{"name":"9aae","type":13,"text":"Spin Spin Spin","markups":[]},{"name":"fd40","type":1,"text":"If another thread either pushed or popped a node after we read the head value but before we performed our CAS, then our CAS will fail because the current value is no longer what we read before. We’ve been had! But we can just spin until we succeed or crash from the bug we accidentally wrote.","markups":[]},{"name":"d0e0","type":4,"text":"Similar to an aircraft holding pattern before landing, lock-free algorithms can spin in a loop until they are able to complete.","markups":[],"layout":1,"metadata":{"id":"1*LY2ohYsNa9nOV1Clko3zJA.png","originalWidth":2000,"originalHeight":1000}},{"name":"35db","type":1,"text":"This is a common theme in lock-free algorithms: spin until successful. This means that if a system has high contention (threads competing for the same resource), or spends lots of time doing things that look like spinlocks, a lock-free algorithm could be far less efficient with CPU resources than a mutex that puts blocked threads to sleep. If lots of threads are looping and throwing away work that they do, another approach may work better.","markups":[]},{"name":"8dda","type":1,"text":"Maybe this is a good place to stop. Let’s give up and return to our cozy mutex-protected hometown, more experienced, and appreciative of its simple beauty.","markups":[]},{"name":"cc6d","type":13,"text":"No More Waiting","markups":[]},{"name":"00eb","type":1,"text":"But our life has only recently taken a turn for the worst, and it would be a shame not to see this one through to rock bottom. Wait-free algorithms, a subset of lock-free algorithms, guarantee bounded time execution. If your algorithm involves atomic variables and a bounded number of steps, you‘ve got a wait-free algorithm on your hands!","markups":[{"type":1,"start":127,"end":147},{"type":2,"start":193,"end":215}]},{"name":"80cc","type":1,"text":"A simple one is incrementing and decrementing an atomic reference counter. This is what Python, Swift, and sometimes Rust use for keeping track of objects shared by multiple threads that need to be destroyed exactly once when all threads are done. This is a simple form of garbage collection!","markups":[{"type":3,"start":49,"end":73,"href":"http://www.1024cores.net/home/lock-free-algorithms/introduction","title":"","rel":"noopener","anchorType":0}]},{"name":"5fe9","type":1,"text":"The use of a constant number of instructions (1 in the case of incrementing or decrementing an atomic reference counter) is actually an example of a particularly strong type of wait-freedom known as “wait-free population oblivious” where the number of steps we take in our code is not dependent on the number of threads participating. Other wait-free algorithms sometimes work by trying to complete the work of a bounded number of other threads, and that bound could grow or shrink as the number of participating threads changes.","markups":[]},{"name":"d034","type":13,"text":"The Value of Reliable Latency","markups":[]},{"name":"f41f","type":1,"text":"More complex wait-free algorithms are often a bit slower than lock-free counterparts when there’s no contention, but under high load they can weather the storm with predictable latency, making them an ideal choice for use in real-time systems.","markups":[]},{"name":"c0c7","type":1,"text":"Reliable latency is particularly important for building high-performance systems, even when it means higher average latency. If there is a rare, super slow event, it can cause backpressure to whiplash through large swaths of the system and in practice you’ll get blasts of failures, like connection errors as the TCP backlog quickly fills up. People who have managed redis at high scales are often too familiar with the devastating effects of a single very slow command on their overall system’s reliability, because it stops all other commands from being handled until the slow one is complete. With concurrent algorithms, it’s often a similar story.","markups":[]},{"name":"5651","type":1,"text":"In the last few years, folks have found a nice balance between usually-fast lock-free and reliable wait-free algorithms by attempting the lock-free version at first, and falling back to the wait-free version if it doesn’t pan out. This reminds me of the compromise found in modern hybrid mutexes to improve the flexibility of the implementation.","markups":[{"type":3,"start":123,"end":229,"href":"http://www.cs.technion.ac.il/~erez/Papers/wf-methodology-ppopp12.pdf","title":"","rel":"noopener","anchorType":0}]},{"name":"8dfa","type":13,"text":"Lock-Free Transactions on Multiple Items in a Tree","markups":[]},{"name":"e932","type":1,"text":"A technique sometimes used in databases and filesystems is shadow paging. Sometimes we want to atomically update multiple items stored in a tree structure. The basic idea is:","markups":[{"type":3,"start":59,"end":72,"href":"https://en.wikipedia.org/wiki/Shadow_paging","title":"","rel":"noopener","anchorType":0},{"type":1,"start":59,"end":72}]},{"name":"6a5e","type":10,"text":"read the pointer to the root","markups":[]},{"name":"ff18","type":10,"text":"copy the things we want to change into new tree nodes, then go up the tree creating new (copied) nodes that reference the previous copied and changed level, going up the tree until we reach the root. All of this is done without changing the original tree.","markups":[]},{"name":"1569","type":10,"text":"Finally, we CAS the root to point to our changed pages.","markups":[]},{"name":"3f26","type":10,"text":"if the CAS worked, our multi-item transaction was successful. if not, we either retry or propagate an error to the next higher level of our system.","markups":[]},{"name":"189c","type":1,"text":"This copy-on-write technique is quite useful in some lock-free systems, but it can involve excessive copying. It’s fairly rare that this technique is a better choice than using fine-grained reader-writer locks on multiple items in a tree. Still, a good trick to have in our spellbook for transactions on a small number of shared items.","markups":[{"type":3,"start":190,"end":209,"href":"https://en.wikipedia.org/wiki/Readers%E2%80%93writer_lock","title":"","rel":"","anchorType":0}]},{"name":"700d","type":1,"text":"There are a number of interesting lock-free transaction techniques that work on larger datasets, but they are a little more complicated. If you’re curious I suggest starting with this one. Note that these are actually algorithms from the distributed systems world, which is similar to lock-free in many ways, differing mostly in terms of latency and reliability. If it works in a distributed system, it will work on a single system, but may totally be overkill.","markups":[{"type":3,"start":12,"end":18,"href":"https://github.com/awslabs/dynamodb-transactions/blob/master/DESIGN.md","title":"","rel":"","anchorType":0},{"type":3,"start":80,"end":95,"href":"https://static.googleusercontent.com/media/research.google.com/en//pubs/archive/36726.pdf","title":"","rel":"","anchorType":0},{"type":3,"start":179,"end":187,"href":"http://rystsov.info/2012/09/01/cas.html","title":"","rel":"","anchorType":0}]},{"name":"9fb7","type":3,"text":"Common Problems in Lock-Free Programs","markups":[]},{"name":"6269","type":13,"text":"The ABA Problem","markups":[]},{"name":"8dae","type":1,"text":"5 == 5 — 1 + 1","markups":[{"type":10,"start":0,"end":14}]},{"name":"0f4e","type":1,"text":"One may assume “if our CAS succeeded, nothing has happened since we read the old value”. This is only true for monotonic values like a counter that you only increment. But if you can increment AND decrement the counter, all hell breaks loose. If a non-monotonic value was 17 one minute ago and it’s 17 now, there may have been a bunch of random increments and decrements in the interlude. Or maybe a single operation that caused the value to wrap.","markups":[{"type":3,"start":111,"end":120,"href":"https://en.wikipedia.org/wiki/Monotonic_function","title":"","rel":"noopener","anchorType":0},{"type":1,"start":111,"end":120}]},{"name":"2b5b","type":1,"text":"If you’re using a 64 bit counter, and you’re incrementing it once every second for every human on earth, in less than 100 years your counter will reach the maximum 64 bit number and wrap back to 0 when the next addition occurs. If you’re using a 32 bit number, you have less than one second of sanity. Don’t spend it all in one place!","markups":[]},{"name":"5b2f","type":1,"text":"This is problematic to the extent that we conflate equality with a lack of change. In the next section I’ll show you a gnarly scar I got from making this mistake.","markups":[{"type":2,"start":42,"end":81}]},{"name":"07df","type":13,"text":"ABA and Pointers","markups":[]},{"name":"414e","type":1,"text":"Very often, we use CAS operations on pointers. If we can rely on a strong GC system, we don’t need to worry about dangling pointers, and it can be simpler to build more complicated lock-free structures in Java or Go compared to C++ or Rust because of this.","markups":[]},{"name":"5108","type":1,"text":"Pointers are not monotonic!!! Our memory allocators often will put a new memory family in the same memory house when the old one moves away to memory heaven (or memory hell if they were bad and spent their lives writing lock-free algorithms).","markups":[]},{"name":"0d6d","type":1,"text":"This really happened to me:","markups":[]},{"name":"88fd","type":10,"text":"I put a 48 byte structure into a lock-free stack that represented the history of a shared piece of state","markups":[]},{"name":"eb01","type":10,"text":"A thread read the stack.head for the “history stack”","markups":[{"type":10,"start":18,"end":28},{"type":1,"start":9,"end":13}]},{"name":"fb3d","type":10,"text":"I deleted the structure and set the history stack’s stack.head to null. I freed all of the objects that were in history, including the object from step #1","markups":[{"type":10,"start":52,"end":62},{"type":1,"start":74,"end":79}]},{"name":"0628","type":10,"text":"I created a new history stack for the object, and allocated a new 48 byte structure. The memory allocator chose the same offset as the original object in step #1, because it was a good fit.","markups":[{"type":1,"start":12,"end":23}]},{"name":"19cf","type":10,"text":"the thread from #2 looked at the old history stack and decided it should attempt to augment that history","markups":[]},{"name":"7308","type":10,"text":"the thread from #2 created a new update whose correctness was dependent on the history being unchanged","markups":[]},{"name":"e285","type":10,"text":"the thread from #2 did a CAS operation on the new stack, which represented significant changes. The CAS worked because the address was the same as when the read occurred in step #2. My tests did not catch this bug.","markups":[{"type":1,"start":96,"end":111}]},{"name":"6e8c","type":10,"text":"I went to memory hell for a long time until I understood the nature of my memory sins. It was messed up.","markups":[{"type":1,"start":10,"end":21}]},{"name":"9267","type":1,"text":"This was actually two bugs: ABA and a dangling pointer that was left referring to invalid state. I assumed my CAS protected me from caring about it as long as I never dereferenced it, but I was dead wrong. If you’re curious, I was trying to implement a similar system to the one shown on slide 11 from this presentation on Bw-Trees.","markups":[{"type":3,"start":241,"end":250,"href":"https://github.com/spacejam/sled","title":"","rel":"","anchorType":0},{"type":3,"start":288,"end":296,"href":"http://cs.brown.edu/courses/cs227/archives/2015/slides/week2/2-sam-BWTree.pdf","title":"","rel":"","anchorType":0}]},{"name":"dd22","type":3,"text":"Common Safeguards","markups":[]},{"name":"808e","type":13,"text":"Mitigating ABA","markups":[]},{"name":"0613","type":1,"text":"There are a number of techniques for avoiding ABA!","markups":[]},{"name":"342e","type":10,"text":"Don’t write lock-free algorithms. It’s really a no-brainer. Don’t do it.","markups":[]},{"name":"68c5","type":10,"text":"Add some extra stuff to the data that we put in atomic variables. Use 16-bits to store a quasi-monotonic counter that you bump by 1 each time you modify the shared state. How many bits of state do you really need? 64-bit linux actually uses 48 bits for addresses (256 TB of address space, but this is reconfigurable if you are baller AF), so you have 16 bits free with pointers anyway. If a structure takes up 2⁵ bytes each, and it’s allocated at aligned addresses, then you have 5 bits of free state in the “low-bits” to use for even more tag data. Just don’t forget to zero those bits out before you dereference the actual pointer!","markups":[{"type":1,"start":327,"end":336}]},{"name":"0092","type":13,"text":"Mitigating Dangling Pointers and Use After Free","markups":[]},{"name":"fe05","type":1,"text":"In addition to ABA, we have new challenges in managing our memory, now that multiple threads may be reading and mutating our shared state concurrently.","markups":[]},{"name":"0d7e","type":1,"text":"When we remove an item from a lock-free stack, for example, there may be threads that read the node just before we detached it! Those threads may still be operating on the now-unreachable state. So after we remove the node from the stack, we must wait until we know that all threads are done reading it before using the memory for something else.","markups":[]},{"name":"e277","type":1,"text":"This is a tricky problem, but luckily there are some good ways to reduce the bleeding.","markups":[]},{"name":"d38f","type":10,"text":"Use a language with GC. This eliminates these bugs by design. Plenty of good choices out there. Specialization is for insects! Go learn Java, you C++ hipsters! Rust’s guaranteed object destruction without GC doesn’t cover your ass in the lock-free world (but check out the first links in #2 or #3 for nice solutions).","markups":[{"type":3,"start":96,"end":125,"href":"http://www.elise.com/quotes/heinlein_-_specialization_is_for_insects","title":"","rel":"","anchorType":0}]},{"name":"1347","type":10,"text":"Epoch Reclamation has threads check-in to an “epoch” before they access shared state. When they stop working on shared state, they check-out of that epoch. When state is made unreachable, and you want to delete it, you have to wait until any thread that COULD have seen it has moved on. For each object we want to free, we add it to the current epoch’s garbage bag (this could be a later epoch than the one we initially checked into). Only after all threads have checked out of epochs before or equal to the one for a particular garbage bag can we actually free the data. This is how I fixed the bug I hit in the ABA and Pointers section. This is used extensively in the linux kernel’s RCU system.","markups":[{"type":3,"start":0,"end":17,"href":"https://aturon.github.io/blog/2015/08/27/epoch/","title":"","rel":"noopener","anchorType":0},{"type":3,"start":613,"end":629,"href":"#0d6d","title":"","rel":"","anchorType":0},{"type":3,"start":671,"end":696,"href":"https://lwn.net/Articles/262464/","title":"","rel":"","anchorType":0},{"type":2,"start":337,"end":344}]},{"name":"3f91","type":10,"text":"Hazard Pointers are similar to epoch reclamation but they operate on a more fine-grained level. This can be good for keeping latency per reclamation lower, but it will drop the throughput of the system.","markups":[{"type":3,"start":0,"end":15,"href":"http://ticki.github.io/blog/fearless-concurrency-with-hazard-pointers/","title":"","rel":"noopener","anchorType":0}]},{"name":"6c93","type":3,"text":"Making a Lock-Free System For Real","markups":[]},{"name":"1dd6","type":1,"text":"So, you want to use this stuff in production. The reliability consultant in me delights. Go forth. Build a bonfire. But seriously, this takes a real investment. Like distributed algorithms, there are tons of subtleties here that are easy to miss, even by experts. Here is a responsible path to take if you choose to do so:","markups":[]},{"name":"1866","type":10,"text":"Use a popular, well-tested existing library for as much as possible. Ideally one known to be running at very high scales at one of the infrastructure / financial giants in correctness-critical paths, not just some low-risk internal subsystem.","markups":[]},{"name":"8ef4","type":10,"text":"If you must implement something on your own, scour the literature for known solutions. Opt for the ones that are a little older with high citation counts. New algorithms described in papers in this field are sometimes found to contain subtle bugs.","markups":[]},{"name":"5c56","type":10,"text":"Understand by modeling before implementing. Write an Iris, SPIN, TLA+, etc… model describing the algorithm to make sure you really understand what’s going on. You will usually save a lot of time by modeling it before jumping into implementation. Check out this guide for getting started with TLA+! It’s weird and fun.","markups":[{"type":3,"start":53,"end":57,"href":"http://iris-project.org/","title":"","rel":"","anchorType":0},{"type":3,"start":256,"end":266,"href":"https://www.learntla.com/introduction/example/","title":"","rel":"noopener","anchorType":0}]},{"name":"5b8f","type":10,"text":"Follow the cleanroom methodology while implementing it.","markups":[{"type":3,"start":11,"end":32,"href":"http://wiki.c2.com/?CleanroomSoftwareEngineering","title":"","rel":"","anchorType":0}]},{"name":"fbe0","type":10,"text":"Find a way to deterministically and exhaustively evaluate all interesting thread interleavings of your implementation. Lots of bugs will jump out if you can do this! Just running a test workload for a few weeks on a small test cluster is not representative of what will happen on diverse hardware running diverse workloads and causing threads to be scheduled in diverse ways. This is the holy grail! Start your implementation from the beginning with this goal in mind, and build things into it that make testing in this way easier. (and stay tuned for a future post on this subject)","markups":[]},{"name":"5554","type":10,"text":"Use the LLVM sanitizers extensively while exercising interleavings in the code, if your programming language supports them or similar tooling. They will slow down your program a little bit, but will detect all sorts of bugs that may not break your tests. They can find race conditions, memory leaks, use-after-free bugs, buffer overflows, all sorts of juicy stuff. When Hanno compiled a standard linux system to run the sanitizers on his entire system, he found and fixed an astounding number of bugs in several programs you may rely on every day.","markups":[{"type":3,"start":8,"end":23,"href":"https://github.com/google/sanitizers/wiki","title":"","rel":"","anchorType":0},{"type":3,"start":453,"end":500,"href":"https://www.youtube.com/watch?v=npWY4hMTBhI","title":"","rel":"","anchorType":0}]},{"name":"3981","type":10,"text":"Remember that by learning about specific bug classes, you may actually become MORE vulnerable to falling victim to them! We have a tendency to be overconfident about our ability to deal with problems we’ve learned about.","markups":[{"type":3,"start":54,"end":119,"href":"http://lesswrong.com/lw/he/knowing_about_biases_can_hurt_people/","title":"","rel":"","anchorType":0}]},{"name":"16c5","type":10,"text":"Don’t write lock-free algorithms. You will die.","markups":[]},{"name":"5ab7","type":1,"text":"Thanks for reading! This is my first blog post, and I’d appreciate any feedback that would improve the experience for future articles! I’d like to give special thanks to those who defended readers against some of my egregious and irresponsible use of language, in (possibly buggy) alphabetical order: Alex Laties, Casey C, daiyi, Gabe Conradi, Matthias Nehlsen, Peter Kolloch, Philipp Muens, Sargun Dhillon, Sassan F, and Steve Salevan, thank you so much!","markups":[{"type":3,"start":323,"end":328,"href":"https://twitter.com/daiyitastic","title":"","rel":"","anchorType":0}]}],"sections":[{"name":"f7fe","startIndex":0}]},"postDisplay":{"coverless":true}},"virtuals":{"allowNotes":true,"previewImage":{"imageId":"1*ImXIA0dmgvgTRjiSisY-HQ.jpeg","filter":"","backgroundSize":"","originalWidth":800,"originalHeight":600,"strategy":"resample","height":0,"width":0},"wordCount":3931,"imageCount":3,"readingTime":15.383962264150943,"subtitle":"What follows is a whirlwind tour of an area of programming usually only whispered of and seldom explored, perhaps for good reason…","usersBySocialRecommends":[],"noIndex":false,"recommends":180,"socialRecommends":[],"isBookmarked":false,"tags":[{"slug":"programming","name":"Programming","postCount":96807,"metadata":{"postCount":96807,"coverImage":{"id":"1*YwvHjyM-BLFizN_TkTvrLw.png","originalWidth":1920,"originalHeight":1080,"isFeatured":true}},"type":"Tag"},{"slug":"lock-free","name":"Lock Free","postCount":2,"metadata":{"postCount":2,"coverImage":{"id":"1*ImXIA0dmgvgTRjiSisY-HQ.jpeg","originalWidth":800,"originalHeight":600}},"type":"Tag"},{"slug":"concurrency","name":"Concurrency","postCount":687,"metadata":{"postCount":687,"coverImage":{"id":"1*aWsObdIOAB0mYjdjkhhbOQ.jpeg","originalWidth":800,"originalHeight":444,"isFeatured":true}},"type":"Tag"},{"slug":"performance","name":"Performance","postCount":8956,"metadata":{"postCount":8956,"coverImage":{"id":"0*ocoqFx9Oa-2XarbN","originalWidth":6000,"originalHeight":4000,"isFeatured":true,"unsplashPhotoId":"13UugSL9q7A"}},"type":"Tag"}],"socialRecommendsCount":0,"responsesCreatedCount":11,"links":{"entries":[{"url":"#0d6d","alts":[],"httpStatus":0},{"url":"#808e","alts":[],"httpStatus":0},{"url":"https://en.wikipedia.org/wiki/Shadow_paging","alts":[],"httpStatus":200},{"url":"https://en.wikipedia.org/wiki/Readers%E2%80%93writer_lock","alts":[],"httpStatus":200},{"url":"https://en.wikipedia.org/wiki/Monotonic_function","alts":[],"httpStatus":200},{"url":"https://en.wikipedia.org/wiki/Demoscene","alts":[],"httpStatus":200},{"url":"http://ticki.github.io/blog/fearless-concurrency-with-hazard-pointers/","alts":[],"httpStatus":200},{"url":"https://aturon.github.io/blog/2015/08/27/epoch/","alts":[],"httpStatus":200},{"url":"https://www.learntla.com/introduction/example/","alts":[],"httpStatus":200},{"url":"https://rcrowley.org/2010/01/06/things-unix-can-do-atomically.html","alts":[],"httpStatus":200},{"url":"http://rystsov.info/2012/09/01/cas.html","alts":[],"httpStatus":200},{"url":"http://wiki.c2.com/?CleanroomSoftwareEngineering","alts":[],"httpStatus":200},{"url":"http://www.seastar-project.org/","alts":[],"httpStatus":200},{"url":"https://static.googleusercontent.com/media/research.google.com/en//pubs/archive/36726.pdf","alts":[],"httpStatus":200},{"url":"http://www.artima.com/lejava/articles/azul_pauseless_gc.html","alts":[],"httpStatus":200},{"url":"https://mechanical-sympathy.blogspot.de/2011/09/single-writer-principle.html","alts":[],"httpStatus":200},{"url":"http://iris-project.org/","alts":[],"httpStatus":200},{"url":"https://github.com/awslabs/dynamodb-transactions/blob/master/DESIGN.md","alts":[],"httpStatus":200},{"url":"https://geidav.wordpress.com/2016/03/23/test-and-set-spinlocks/","alts":[{"type":1,"url":"https://cdn.ampproject.org/c/s/geidav.wordpress.com/2016/03/23/test-and-set-spinlocks/amp/"}],"httpStatus":200},{"url":"https://lwn.net/Articles/262464/","alts":[],"httpStatus":200},{"url":"https://github.com/google/sanitizers/wiki","alts":[],"httpStatus":200},{"url":"http://www.elise.com/quotes/heinlein_-_specialization_is_for_insects","alts":[],"httpStatus":200},{"url":"http://cs.brown.edu/courses/cs227/archives/2015/slides/week2/2-sam-BWTree.pdf","alts":[],"httpStatus":200},{"url":"https://github.com/ept/hermitage","alts":[],"httpStatus":200},{"url":"https://github.com/scylladb/seastar/blob/c62bbf9ca7b8a09941586e40645177fcf1bffd72/core/reactor.hh#L295","alts":[],"httpStatus":200},{"url":"http://man7.org/linux/man-pages/man7/futex.7.html","alts":[],"httpStatus":200},{"url":"https://lobste.rs/u/robgssp","alts":[],"httpStatus":200},{"url":"http://www.felixcloutier.com/x86/CMPXCHG8B:CMPXCHG16B.html","alts":[],"httpStatus":200},{"url":"https://github.com/spacejam/sled","alts":[],"httpStatus":200},{"url":"https://twitter.com/daiyitastic","alts":[],"httpStatus":200},{"url":"https://www.youtube.com/watch?v=npWY4hMTBhI","alts":[{"type":2,"url":"vnd.youtube://www.youtube.com/watch?v=npWY4hMTBhI&feature=applinks"},{"type":3,"url":"vnd.youtube://www.youtube.com/watch?v=npWY4hMTBhI&feature=applinks"}],"httpStatus":200},{"url":"https://www.youtube.com/watch?v=c1gO9aB9nbs","alts":[{"type":2,"url":"vnd.youtube://www.youtube.com/watch?v=c1gO9aB9nbs&feature=applinks"},{"type":3,"url":"vnd.youtube://www.youtube.com/watch?v=c1gO9aB9nbs&feature=applinks"}],"httpStatus":200},{"url":"https://www.youtube.com/watch?v=3LcNHxBJw2Q","alts":[{"type":2,"url":"vnd.youtube://www.youtube.com/watch?v=3LcNHxBJw2Q&feature=applinks"},{"type":3,"url":"vnd.youtube://www.youtube.com/watch?v=3LcNHxBJw2Q&feature=applinks"}],"httpStatus":200},{"url":"http://www.1024cores.net/","alts":[],"httpStatus":200},{"url":"http://www.1024cores.net/home/lock-free-algorithms/introduction","alts":[],"httpStatus":200},{"url":"http://lesswrong.com/lw/he/knowing_about_biases_can_hurt_people/","alts":[],"httpStatus":200},{"url":"http://www.cs.technion.ac.il/~erez/Papers/wf-methodology-ppopp12.pdf","alts":[],"httpStatus":200}],"version":"0.3","generatedAt":1507726522196},"isLockedPreviewOnly":false,"metaDescription":"","totalClapCount":906,"sectionCount":1,"readingList":0,"topics":[{"topicId":"decb52b64abf","slug":"programming","createdAt":1493934116328,"deletedAt":0,"image":{"id":"1*iPa136b1cGEO7lvoXg6uHQ@2x.jpeg","originalWidth":6016,"originalHeight":4016},"name":"Programming","description":"The good, the bad, the buggy.","relatedTopics":[],"visibility":1,"relatedTags":[],"type":"Topic"}]},"coverless":true,"slug":"fear-and-loathing-in-lock-free-programming","translationSourcePostId":"","translationSourceCreatorId":"","isApprovedTranslation":false,"inResponseToPostId":"","inResponseToRemovedAt":0,"isTitleSynthesized":true,"allowResponses":true,"importedUrl":"","importedPublishedAt":0,"visibility":0,"uniqueSlug":"fear-and-loathing-in-lock-free-programming-7158b1cdd50c","previewContent":{"bodyModel":{"paragraphs":[{"name":"0191","type":3,"text":"Fear and Loathing in Lock-Free Programming","markups":[],"alignment":1},{"name":"7eb4","type":4,"text":"","markups":[],"layout":9,"metadata":{"id":"1*ImXIA0dmgvgTRjiSisY-HQ.jpeg","originalWidth":800,"originalHeight":600}},{"name":"d2ac","type":1,"text":"What follows is a whirlwind tour of an area of programming usually only whispered of…","markups":[],"alignment":1}],"sections":[{"startIndex":0}]},"isFullContent":false,"subtitle":"What follows is a whirlwind tour of an area of programming usually only whispered of and seldom explored, perhaps for good reason…"},"license":0,"inResponseToMediaResourceId":"","canonicalUrl":"https://medium.com/@tylerneely/fear-and-loathing-in-lock-free-programming-7158b1cdd50c","approvedHomeCollectionId":"","newsletterId":"","webCanonicalUrl":"https://medium.com/@tylerneely/fear-and-loathing-in-lock-free-programming-7158b1cdd50c","mediumUrl":"https://medium.com/@tylerneely/fear-and-loathing-in-lock-free-programming-7158b1cdd50c","migrationId":"","notifyFollowers":true,"notifyTwitter":true,"notifyFacebook":false,"responseHiddenOnParentPostAt":0,"isSeries":false,"isSubscriptionLocked":false,"seriesLastAppendedAt":0,"audioVersionDurationSec":0,"sequenceId":"","isNsfw":false,"isEligibleForRevenue":false,"isBlockedFromHightower":false,"deletedAt":0,"lockedPostSource":0,"hightowerMinimumGuaranteeStartsAt":0,"hightowerMinimumGuaranteeEndsAt":0,"featureLockRequestAcceptedAt":0,"mongerRequestType":1,"layerCake":0,"socialTitle":"","socialDek":"","editorialPreviewTitle":"","editorialPreviewDek":"","curationEligibleAt":0,"type":"Post"},"mentionedUsers":[],"collaborators":[{"user":{"userId":"f602b6172157","name":"Sargun Dhillon","username":"sargun","createdAt":1369984712902,"imageId":"0*XPCZ7Eqp71ne0Qu6.jpeg","backgroundImageId":"","bio":"","twitterScreenName":"sargun","facebookAccountId":"10203381580234137","allowNotes":1,"mediumMemberAt":0,"isNsfw":false,"isWriterProgramEnrolled":true,"isQuarantined":false,"type":"User"},"state":"visible"},{"user":{"userId":"95ce17501c5e","name":"˙Ↄ ʎǝsɐↃ","username":"squeed","createdAt":1494453525991,"imageId":"0*gHijMR2Arq585mKD.jpg","backgroundImageId":"","bio":"I’m always online, and I’m nice on there.","twitterScreenName":"squeed","facebookAccountId":"","allowNotes":1,"mediumMemberAt":0,"isNsfw":false,"isWriterProgramEnrolled":true,"isQuarantined":false,"type":"User"},"state":"visible"}],"hideMeter":false,"collectionUserRelations":[],"mode":null,"references":{"User":{"5145b6327de1":{"userId":"5145b6327de1","name":"Tyler Neely","username":"tylerneely","createdAt":1479810155900,"imageId":"1*O4KHGpH9QQ0mYamqf_76yA.jpeg","backgroundImageId":"","bio":"webmaster http://tylerneely.com","twitterScreenName":"sadisticsystems","socialStats":{"userId":"5145b6327de1","usersFollowedCount":155,"usersFollowedByCount":248,"type":"SocialStats"},"social":{"userId":"lo_gvVNDg0gn33i","targetUserId":"5145b6327de1","type":"Social"},"facebookAccountId":"","allowNotes":1,"mediumMemberAt":0,"isNsfw":false,"isWriterProgramEnrolled":true,"isQuarantined":false,"type":"User"}},"Social":{"5145b6327de1":{"userId":"lo_gvVNDg0gn33i","targetUserId":"5145b6327de1","type":"Social"}},"SocialStats":{"5145b6327de1":{"userId":"5145b6327de1","usersFollowedCount":155,"usersFollowedByCount":248,"type":"SocialStats"}}}})
// ]]></script><script id="parsely-cfg" src="./Fear and Loathing in Lock-Free Programming – Tyler Neely – Medium_files/p.js"></script><script type="text/javascript">(function(b,r,a,n,c,h,_,s,d,k){if(!b[n]||!b[n]._q){for(;s<_.length;)c(h,_[s++]);d=r.createElement(a);d.async=1;d.src="https://cdn.branch.io/branch-latest.min.js";k=r.getElementsByTagName(a)[0];k.parentNode.insertBefore(d,k);b[n]=h}})(window,document,"script","branch",function(b,r){b[r]=function(){b._q.push([r,arguments])}},{_q:[],_v:1},"addListener applyCode autoAppIndex banner closeBanner closeJourney creditHistory credits data deepview deepviewCta first getCode init link logout redeem referrals removeListener sendSMS setBranchViewData setIdentity track validateCode trackCommerceEvent logEvent".split(" "), 0); branch.init('key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm', {'no_journeys': true, 'disable_exit_animation': true, 'disable_entry_animation': true, 'tracking_disabled':  false }, function(err, data) {});</script><div class="surface-scrollOverlay"></div><script charset="UTF-8" src="./Fear and Loathing in Lock-Free Programming – Tyler Neely – Medium_files/main-common-async.bundle.rXtnGC3lh3DgPxAbxNEJ9g.js"></script><script charset="UTF-8" src="./Fear and Loathing in Lock-Free Programming – Tyler Neely – Medium_files/main-notes.bundle.AqavCggV_d_gUgROE7qqTA.js"></script><iframe src="./Fear and Loathing in Lock-Free Programming – Tyler Neely – Medium_files/request.html" style="border: none; position: fixed; z-index: 9999; display: none;" hidden=""></iframe></body></html>